<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="MUSST – A modern Fortran MUltiScale Simulation Tribology solver">
    
    <meta name="author" content="Noël Brunetière - Arthur Francisco" >
    <link rel="icon" href="../favicon.png">

    <title>mod_vtk.f90 &ndash; MUSST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    
    <link href="../css/user.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">MUSST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>mod_vtk.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Stefano Zaghi</li>
     
     
     
     
    <li><i class="fa fa-barcode"></i> 1.0</li>
    
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="16.8% of total for source files.">1593 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/mod_vtk.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">mod_vtk.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/vtk.html">VTK</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/mod_vtk.f90.html#src">mod_vtk.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~mod_vtk.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemod_vtkf90EfferentGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~mod_vtk.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~mod_vtk.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- sourcefile~mod_vtk.f90 -->
<g id="sourcefile~~mod_vtk.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~mod_vtk.f90</title>
<polygon fill="none" stroke="#000000" points="188,-24 118,-24 118,0 188,0 188,-24"/>
<text text-anchor="middle" x="153" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">mod_vtk.f90</text>
</g>
<!-- sourcefile~mod_ir_vtk.f90 -->
<g id="sourcefile~~mod_vtk.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~mod_ir_vtk.f90</title>
<g id="a_sourcefile~~mod_vtk.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/mod_ir_vtk.f90.html" xlink:title="mod_ir_vtk.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="82,-24 0,-24 0,0 82,0 82,-24"/>
<text text-anchor="middle" x="41" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_ir_vtk.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_vtk.f90&#45;&gt;sourcefile~mod_ir_vtk.f90 -->
<g id="sourcefile~~mod_vtk.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~mod_vtk.f90&#45;&gt;sourcefile~mod_ir_vtk.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M117.8698,-12C109.7545,-12 100.9569,-12 92.3096,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="92.2772,-8.5001 82.2772,-12 92.2771,-15.5001 92.2772,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65,-24 0,-24 0,0 65,0 65,-24"/>
<text text-anchor="middle" x="32.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 83,-24 83,0 180,0 180,-24"/>
<text text-anchor="middle" x="131.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~mod_vtk.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemod_vtkf90AfferentGraph" width="449pt" height="32pt"
 viewBox="0.00 0.00 449.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~mod_vtk.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 445,-28 445,4 -4,4"/>
<!-- sourcefile~mod_vtk.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~mod_vtk.f90</title>
<polygon fill="none" stroke="#000000" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">mod_vtk.f90</text>
</g>
<!-- sourcefile~mod_inout_files.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~mod_inout_files.f90</title>
<g id="a_sourcefile~~mod_vtk.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/mod_inout_files.f90.html" xlink:title="mod_inout_files.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="209,-24 106,-24 106,0 209,0 209,-24"/>
<text text-anchor="middle" x="157.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_inout_files.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_vtk.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_vtk.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M105.904,-12C97.4445,-12 88.733,-12 80.4369,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.2011,-8.5001 70.201,-12 80.201,-15.5001 80.2011,-8.5001"/>
</g>
<!-- sourcefile~mod_test_musst.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~mod_test_musst.f90</title>
<g id="a_sourcefile~~mod_vtk.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/mod_test_musst.f90.html" xlink:title="mod_test_musst.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="351,-24 245,-24 245,0 351,0 351,-24"/>
<text text-anchor="middle" x="298" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_test_musst.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_inout_files.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_inout_files.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.883,-12C236.596,-12 227.9703,-12 219.5064,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="219.2964,-8.5001 209.2963,-12 219.2963,-15.5001 219.2964,-8.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~mod_vtk.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="441,-24 387,-24 387,0 441,0 441,-24"/>
<text text-anchor="middle" x="414" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~mod_test_musst.f90 -->
<g id="sourcefile~~mod_vtk.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~mod_test_musst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M386.8032,-12C379.0185,-12 370.1908,-12 361.1952,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="361.0141,-8.5001 351.014,-12 361.014,-15.5001 361.0141,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65,-24 0,-24 0,0 65,0 65,-24"/>
<text text-anchor="middle" x="32.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 83,-24 83,0 180,0 180,-24"/>
<text text-anchor="middle" x="131.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/vtk.html">VTK</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/mod_vtk.f90.html#src">mod_vtk.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!------------------------------------------------------------------------------------------</span>
<a name="ln-2"></a><span class="c">!! file: Lib_VTK_IO.f03</span>
<a name="ln-3"></a><span class="c">!! author: Stefano Zaghi</span>
<a name="ln-4"></a><span class="c">!! version: 1.0</span>
<a name="ln-5"></a><span class="c">!! brief: LIBVTKIO is a library of functions for Input and Output pure fortran data (both ascii and binary) in VTK format.</span>
<a name="ln-6"></a><span class="c">!------------------------------------------------------------------------------------------</span>
<a name="ln-7"></a>
<a name="ln-8"></a><span class="k">module </span><span class="n">VTK</span>
<a name="ln-9"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-10"></a><span class="c">!!LIBVTKIO is a library of functions for Input and Output pure fortran data (both ascii and binary) in VTK format.</span>
<a name="ln-11"></a><span class="c">!!</span>
<a name="ln-12"></a><span class="c">!!The VTK standard can be separated into two main catagories: the \MaiuscolettoBS{VTK Legacy Standard} and the</span>
<a name="ln-13"></a><span class="c">!!\MaiuscolettoBS{VTK XML Standard}. The latter is more powerful and will has a stronger support from VTk comunity than legacy</span>
<a name="ln-14"></a><span class="c">!!standard; XML file format would to be preferred despite the legacy one.</span>
<a name="ln-15"></a><span class="c">!</span>
<a name="ln-16"></a><span class="c">!At the present only a few functions of the final library have been implemented. The InPut functions are totaly absent, but the</span>
<a name="ln-17"></a><span class="c">!OutPut functions are almost complete (the \virgo{polydata} functions are the only missing).</span>
<a name="ln-18"></a><span class="c">!</span>
<a name="ln-19"></a><span class="c">!The functions actually present are:</span>
<a name="ln-20"></a><span class="c">!</span>
<a name="ln-21"></a><span class="c">!\begin{boxred}{Functions for Legacy VTK file format}</span>
<a name="ln-22"></a><span class="c">!\begin{enumerate1Red}</span>
<a name="ln-23"></a><span class="c">! \item \MaiuscolettoS{VTK\_INI}</span>
<a name="ln-24"></a><span class="c">! \item \MaiuscolettoS{VTK\_GEO}</span>
<a name="ln-25"></a><span class="c">! \item \MaiuscolettoS{VTK\_CON}</span>
<a name="ln-26"></a><span class="c">! \item \MaiuscolettoS{VTK\_DAT}</span>
<a name="ln-27"></a><span class="c">! \item \MaiuscolettoS{VTK\_VAR}</span>
<a name="ln-28"></a><span class="c">! \item \MaiuscolettoS{VTK\_END}</span>
<a name="ln-29"></a><span class="c">!\end{enumerate1Red}</span>
<a name="ln-30"></a><span class="c">!\end{boxred}</span>
<a name="ln-31"></a><span class="c">!</span>
<a name="ln-32"></a><span class="c">!\begin{boxred}{Functions for XML VTK file format}</span>
<a name="ln-33"></a><span class="c">!\begin{enumerate1Red}</span>
<a name="ln-34"></a><span class="c">! \item \MaiuscolettoS{VTK\_INI\_XML}</span>
<a name="ln-35"></a><span class="c">! \item \MaiuscolettoS{VTK\_GEO\_XML}</span>
<a name="ln-36"></a><span class="c">! \item \MaiuscolettoS{VTK\_CON\_XML}</span>
<a name="ln-37"></a><span class="c">! \item \MaiuscolettoS{VTK\_DAT\_XML}</span>
<a name="ln-38"></a><span class="c">! \item \MaiuscolettoS{VTK\_VAR\_XML}</span>
<a name="ln-39"></a><span class="c">! \item \MaiuscolettoS{VTK\_END\_XML}</span>
<a name="ln-40"></a><span class="c">!\end{enumerate1Red}</span>
<a name="ln-41"></a><span class="c">!\end{boxred}</span>
<a name="ln-42"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-43"></a>
<a name="ln-44"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-45"></a><span class="k">USE </span><span class="n">IR_VTK</span> <span class="c">! Real and integer portable multi-precision kind definition.</span>
<a name="ln-46"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-47"></a>
<a name="ln-48"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-49"></a><span class="k">implicit none</span>
<a name="ln-50"></a><span class="k">private</span>
<a name="ln-51"></a><span class="k">save</span>
<a name="ln-52"></a><span class="c">! functions for VTK LEGACY</span>
<a name="ln-53"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_INI</span>
<a name="ln-54"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_GEO</span>
<a name="ln-55"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_CON</span>
<a name="ln-56"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_DAT</span>
<a name="ln-57"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_VAR</span>
<a name="ln-58"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_END</span>
<a name="ln-59"></a><span class="c">! functions for VTK XML</span>
<a name="ln-60"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_INI_XML</span>
<a name="ln-61"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_GEO_XML</span>
<a name="ln-62"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_CON_XML</span>
<a name="ln-63"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_DAT_XML</span>
<a name="ln-64"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_VAR_XML</span>
<a name="ln-65"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTK_END_XML</span>
<a name="ln-66"></a><span class="c">! functions for VTM XML</span>
<a name="ln-67"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTM_INI_XML</span>
<a name="ln-68"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTM_BLK_XML</span>
<a name="ln-69"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTM_WRF_XML</span>
<a name="ln-70"></a><span class="k">public</span><span class="kd">::</span> <span class="n">VTM_END_XML</span>
<a name="ln-71"></a><span class="c">! portable kind-precision</span>
<a name="ln-72"></a><span class="c">!public:: R16P, FR16P</span>
<a name="ln-73"></a><span class="k">public</span><span class="kd">::</span> <span class="n">R8P</span><span class="p">,</span>  <span class="n">FR8P</span>
<a name="ln-74"></a><span class="k">public</span><span class="kd">::</span> <span class="n">R4P</span><span class="p">,</span>  <span class="n">FR4P</span>
<a name="ln-75"></a><span class="k">public</span><span class="kd">::</span> <span class="n">R_P</span><span class="p">,</span>  <span class="n">FR_P</span>
<a name="ln-76"></a><span class="k">public</span><span class="kd">::</span> <span class="n">I8P</span><span class="p">,</span>  <span class="n">FI8P</span>
<a name="ln-77"></a><span class="k">public</span><span class="kd">::</span> <span class="n">I4P</span><span class="p">,</span>  <span class="n">FI4P</span>
<a name="ln-78"></a><span class="k">public</span><span class="kd">::</span> <span class="n">I2P</span><span class="p">,</span>  <span class="n">FI2P</span>
<a name="ln-79"></a><span class="k">public</span><span class="kd">::</span> <span class="n">I1P</span><span class="p">,</span>  <span class="n">FI1P</span>
<a name="ln-80"></a><span class="k">public</span><span class="kd">::</span> <span class="n">I_P</span><span class="p">,</span>  <span class="n">FI_P</span>
<a name="ln-81"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-84"></a><span class="c">! overloading of VTK_GEO</span>
<a name="ln-85"></a><span class="k">interface </span><span class="n">VTK_GEO</span>
<a name="ln-86"></a>  <span class="k">module procedure </span><span class="n">VTK_GEO_UNST_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) UNSTRUCTURED\_GRID</span>
<a name="ln-87"></a>                   <span class="n">VTK_GEO_UNST_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P) UNSTRUCTURED\_GRID</span>
<a name="ln-88"></a>                   <span class="n">VTK_GEO_STRP_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) STRUCTURED\_POINTS</span>
<a name="ln-89"></a>                   <span class="n">VTK_GEO_STRP_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P) STRUCTURED\_POINTS</span>
<a name="ln-90"></a>                   <span class="n">VTK_GEO_STRG_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) STRUCTURED\_GRID</span>
<a name="ln-91"></a>                   <span class="n">VTK_GEO_STRG_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P) STRUCTURED\_GRID</span>
<a name="ln-92"></a>                   <span class="n">VTK_GEO_RECT_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) RECTILINEAR\_GRID</span>
<a name="ln-93"></a>                   <span class="n">VTK_GEO_RECT_R4</span>    <span class="c">! real(R4P) RECTILINEAR\_GRID</span>
<a name="ln-94"></a><span class="n">endinterface</span>
<a name="ln-95"></a><span class="c">! overloading of VTK_VAR</span>
<a name="ln-96"></a><span class="k">interface </span><span class="n">VTK_VAR</span>
<a name="ln-97"></a>  <span class="k">module procedure </span><span class="n">VTK_VAR_SCAL_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P)    scalar</span>
<a name="ln-98"></a>                   <span class="n">VTK_VAR_SCAL_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P)    scalar</span>
<a name="ln-99"></a>                   <span class="n">VTK_VAR_SCAL_I4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) scalar</span>
<a name="ln-100"></a>                   <span class="n">VTK_VAR_VECT_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P)    vectorial</span>
<a name="ln-101"></a>                   <span class="n">VTK_VAR_VECT_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P)    vectorial</span>
<a name="ln-102"></a>                   <span class="n">VTK_VAR_VECT_I4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) vectorial</span>
<a name="ln-103"></a>                   <span class="n">VTK_VAR_TEXT_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P)    vectorial (texture)</span>
<a name="ln-104"></a>                   <span class="n">VTK_VAR_TEXT_R4</span>    <span class="c">! real(R4P)    vectorial (texture)</span>
<a name="ln-105"></a><span class="n">endinterface</span>
<a name="ln-106"></a><span class="c">! overloading of VTK_GEO_XML</span>
<a name="ln-107"></a><span class="k">interface </span><span class="n">VTK_GEO_XML</span>
<a name="ln-108"></a>  <span class="k">module procedure </span><span class="n">VTK_GEO_XML_STRG_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P) StructuredGrid</span>
<a name="ln-109"></a>                   <span class="n">VTK_GEO_XML_STRG_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) StructuredGrid</span>
<a name="ln-110"></a>                   <span class="n">VTK_GEO_XML_RECT_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) RectilinearGrid</span>
<a name="ln-111"></a>                   <span class="n">VTK_GEO_XML_RECT_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P) RectilinearGrid</span>
<a name="ln-112"></a>                   <span class="n">VTK_GEO_XML_UNST_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P) UnstructuredGrid</span>
<a name="ln-113"></a>                   <span class="n">VTK_GEO_XML_UNST_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P) UnstructuredGrid</span>
<a name="ln-114"></a>                   <span class="n">VTK_GEO_XML_CLOSEP</span>     <span class="c">! closing tag &quot;Piece&quot; function</span>
<a name="ln-115"></a><span class="n">endinterface</span>
<a name="ln-116"></a><span class="c">! overloading of VTK_VAR_XML</span>
<a name="ln-117"></a><span class="k">interface </span><span class="n">VTK_VAR_XML</span>
<a name="ln-118"></a>  <span class="k">module procedure </span><span class="n">VTK_VAR_XML_SCAL_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P)    scalar</span>
<a name="ln-119"></a>                   <span class="n">VTK_VAR_XML_SCAL_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P)    scalar</span>
<a name="ln-120"></a>                   <span class="n">VTK_VAR_XML_SCAL_I8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I8P) scalar</span>
<a name="ln-121"></a>                   <span class="n">VTK_VAR_XML_SCAL_I4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) scalar</span>
<a name="ln-122"></a>                   <span class="n">VTK_VAR_XML_SCAL_I2</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I2P) scalar</span>
<a name="ln-123"></a>                   <span class="n">VTK_VAR_XML_SCAL_I1</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I1P) scalar</span>
<a name="ln-124"></a>                   <span class="n">VTK_VAR_XML_VECT_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P)    vectorial</span>
<a name="ln-125"></a>                   <span class="n">VTK_VAR_XML_VECT_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P)    vectorial</span>
<a name="ln-126"></a>                   <span class="n">VTK_VAR_XML_VECT_I8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) vectorial</span>
<a name="ln-127"></a>                   <span class="n">VTK_VAR_XML_VECT_I4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) vectorial</span>
<a name="ln-128"></a>                   <span class="n">VTK_VAR_XML_VECT_I2</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) vectorial</span>
<a name="ln-129"></a>                   <span class="n">VTK_VAR_XML_VECT_I1</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) vectorial</span>
<a name="ln-130"></a>                   <span class="n">VTK_VAR_XML_LIST_R8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R8P)    list</span>
<a name="ln-131"></a>                   <span class="n">VTK_VAR_XML_LIST_R4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! real(R4P)    list</span>
<a name="ln-132"></a>                   <span class="n">VTK_VAR_XML_LIST_I8</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) list</span>
<a name="ln-133"></a>                   <span class="n">VTK_VAR_XML_LIST_I4</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I4P) list</span>
<a name="ln-134"></a>                   <span class="n">VTK_VAR_XML_LIST_I2</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! integer(I2P) list</span>
<a name="ln-135"></a>                   <span class="n">VTK_VAR_XML_LIST_I1</span>    <span class="c">! integer(I1P) list</span>
<a name="ln-136"></a><span class="n">endinterface</span>
<a name="ln-137"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-138"></a>
<a name="ln-139"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-140"></a><span class="c">!\LIBVTKIO uses a small set of internal variables that are private (not accessible from the outside). The following are</span>
<a name="ln-141"></a><span class="c">! private variables:</span>
<a name="ln-142"></a><span class="c">!</span>
<a name="ln-143"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">maxlen</span>       <span class="o">=</span> <span class="mi">500</span>         <span class="c">! max number of characters of static string</span>
<a name="ln-144"></a><span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">end_rec</span>      <span class="o">=</span> <span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>    <span class="c">! end-character for binary-record finalize</span>
<a name="ln-145"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">f_out_ascii</span>  <span class="o">=</span> <span class="mi">0</span>           <span class="c">! ascii-output-format parameter identifier</span>
<a name="ln-146"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">f_out_binary</span> <span class="o">=</span> <span class="mi">1</span>           <span class="c">! binary-output-format parameter identifier</span>
<a name="ln-147"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">f_out</span>        <span class="o">=</span> <span class="n">f_out_ascii</span> <span class="c">! current output-format (initialized to ascii format)</span>
<a name="ln-148"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>   <span class="n">topology</span>                   <span class="c">! mesh topology</span>
<a name="ln-149"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Unit_VTK</span>                   <span class="c">! internal logical unit</span>
<a name="ln-150"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Unit_VTK_Append</span>            <span class="c">! internal logical unit for raw binary XML append file</span>
<a name="ln-151"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">N_Byte</span>                     <span class="c">! number of byte to be written/read</span>
<a name="ln-152"></a><span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span><span class="kd">::</span>               <span class="n">Tipo_R8</span> <span class="o">=</span> <span class="mf">1._R8P</span>           <span class="c">! prototype of R8P real</span>
<a name="ln-153"></a><span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">)</span><span class="kd">::</span>               <span class="n">Tipo_R4</span> <span class="o">=</span> <span class="mf">1._R4P</span>           <span class="c">! prototype of R4P real</span>
<a name="ln-154"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Tipo_I8</span> <span class="o">=</span> <span class="mi">1_I8P</span>            <span class="c">! prototype of I8P integer</span>
<a name="ln-155"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Tipo_I4</span> <span class="o">=</span> <span class="mi">1_I4P</span>            <span class="c">! prototype of I4P integer</span>
<a name="ln-156"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Tipo_I2</span> <span class="o">=</span> <span class="mi">1_I2P</span>            <span class="c">! prototype of I2P integer</span>
<a name="ln-157"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Tipo_I1</span> <span class="o">=</span> <span class="mi">1_I1P</span>            <span class="c">! prototype of I1P integer</span>
<a name="ln-158"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">ioffset</span>                    <span class="c">! offset pointer</span>
<a name="ln-159"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">indent</span>                     <span class="c">! indent pointer</span>
<a name="ln-160"></a><span class="c">! VTM specific variables</span>
<a name="ln-161"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">Unit_VTM</span>                   <span class="c">! internal logical unit</span>
<a name="ln-162"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">blk</span>                        <span class="c">! block index</span>
<a name="ln-163"></a><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>            <span class="n">vtm_indent</span>                 <span class="c">! indent pointer</span>
<a name="ln-164"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-165"></a>
<a name="ln-166"></a><span class="c">!In the following chapters there is the API reference of all functions of \LIBVTKIO.</span>
<a name="ln-167"></a><span class="k">contains</span>
<a name="ln-168"></a>  <span class="c">!\chapter{Auxiliary functions}</span>
<a name="ln-169"></a>  <span class="c">!\minitoc</span>
<a name="ln-170"></a>  <span class="c">!\vspace*{8mm}</span>
<a name="ln-171"></a>  <span class="c">!</span>
<a name="ln-172"></a>  <span class="c">!\LIBVTKIO uses two auxiliary functions that are not connected with the VTK standard. These functions are private and so they</span>
<a name="ln-173"></a>  <span class="c">!cannot be called outside the library.</span>
<a name="ln-174"></a>  <span class="k">function </span><span class="n">GetUnit</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">Free_Unit</span><span class="p">)</span>
<a name="ln-175"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-176"></a>  <span class="c">!!The GetUnit function is used for getting a free logic unit. The users of \LIBVTKIO does not know which is</span>
<a name="ln-177"></a>  <span class="c">!!the logical unit: \LIBVTKIO handels this information without boring the users. The logical unit used is safe-free: if the</span>
<a name="ln-178"></a>  <span class="c">!!program calling \LIBVTKIO has others logical units used \LIBVTKIO will never use these units, but will choice one that is free.</span>
<a name="ln-179"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-180"></a>
<a name="ln-181"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-182"></a>  <span class="k">implicit none</span>
<a name="ln-183"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span> <span class="n">Free_Unit</span> <span class="c">! free logic unit</span>
<a name="ln-184"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span> <span class="n">n1</span>        <span class="c">! counter</span>
<a name="ln-185"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span> <span class="n">ios</span>       <span class="c">! inquiring flag</span>
<a name="ln-186"></a>  <span class="kt">logical</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="kd">::</span>   <span class="n">lopen</span>     <span class="c">! inquiring flag</span>
<a name="ln-187"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-188"></a>
<a name="ln-189"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-190"></a>  <span class="c">!!The following is the code snippet of GetUnit function: the units 0, 5, 6, 9 and all non-free units are discarded.</span>
<a name="ln-191"></a>  <span class="c">!!</span>
<a name="ln-192"></a>  <span class="c">!(\doc)codesnippet</span>
<a name="ln-193"></a>  <span class="n">Free_Unit</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1_I4P</span>                                      <span class="c">! initializing free logic unit</span>
<a name="ln-194"></a>  <span class="n">n1</span><span class="o">=</span><span class="mi">1_I4P</span>                                                <span class="c">! initializing counter</span>
<a name="ln-195"></a>  <span class="k">do</span>
<a name="ln-196"></a><span class="k">    if</span> <span class="p">((</span><span class="n">n1</span><span class="o">/=</span><span class="mi">5_I4P</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">n1</span><span class="o">/=</span><span class="mi">6_I4P</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">n1</span><span class="o">/=</span><span class="mi">9_I4P</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-197"></a><span class="k">      inquire</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">n1</span><span class="p">,</span><span class="n">opened</span><span class="o">=</span><span class="n">lopen</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span>           <span class="c">! verify logic units</span>
<a name="ln-198"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">ios</span><span class="o">==</span><span class="mi">0_I4P</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-199"></a><span class="k">        if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lopen</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-200"></a><span class="k">          </span><span class="n">Free_Unit</span> <span class="o">=</span> <span class="n">n1</span>                                  <span class="c">! assignment of free logic</span>
<a name="ln-201"></a>          <span class="k">return</span>
<a name="ln-202"></a><span class="k">        </span><span class="n">endif</span>
<a name="ln-203"></a>      <span class="n">endif</span>
<a name="ln-204"></a>    <span class="n">endif</span>
<a name="ln-205"></a>    <span class="n">n1</span><span class="o">=</span><span class="n">n1</span><span class="o">+</span><span class="mi">1_I4P</span>                                           <span class="c">! updating counter</span>
<a name="ln-206"></a>  <span class="n">enddo</span>
<a name="ln-207"></a>  <span class="k">return</span>
<a name="ln-208"></a>  <span class="c">!(doc/)codesnippet</span>
<a name="ln-209"></a>  <span class="c">!!GetUnit function is private and cannot be called outside \LIBVTKIO. If you are interested to use it change its scope to public.</span>
<a name="ln-210"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-211"></a>  <span class="n">endfunction</span> <span class="n">GetUnit</span>
<a name="ln-212"></a>
<a name="ln-213"></a>  <span class="k">function </span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-214"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-215"></a>  <span class="c">!!The Upper\_Case function converts the lower case characters of a string to upper case one. \LIBVTKIO uses this function in</span>
<a name="ln-216"></a>  <span class="c">!!order to achieve case-insensitive: all character variables used within \LIBVTKIO functions are pre-processed by</span>
<a name="ln-217"></a>  <span class="c">!!Uppper\_Case function before these variables are used. So the users can call \LIBVTKIO functions whitout pay attention of the</span>
<a name="ln-218"></a>  <span class="c">!!case of the kwywords passed to the functions: calling the function VTK\_INI with the string \code{E_IO = VTK_INI(&#39;Ascii&#39;,...)}</span>
<a name="ln-219"></a>  <span class="c">!!or with the string  \code{E_IO = VTK_INI(&#39;AscII&#39;,...)} is equivalent.</span>
<a name="ln-220"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-221"></a>
<a name="ln-222"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-223"></a>  <span class="k">implicit none</span>
<a name="ln-224"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">string</span>     <span class="c">! string to be converted</span>
<a name="ln-225"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">))</span><span class="kd">::</span>   <span class="n">Upper_Case</span> <span class="c">! converted string</span>
<a name="ln-226"></a>  <span class="kt">integer</span><span class="kd">::</span>                      <span class="n">n1</span>         <span class="c">! characters counter</span>
<a name="ln-227"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-228"></a>
<a name="ln-229"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-230"></a>  <span class="c">!!The following is the code snippet of Upper\_Case function.</span>
<a name="ln-231"></a>  <span class="c">!!</span>
<a name="ln-232"></a>  <span class="c">!(\doc)codesnippet</span>
<a name="ln-233"></a>  <span class="n">Upper_Case</span> <span class="o">=</span> <span class="n">string</span>
<a name="ln-234"></a>  <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-235"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">ichar</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)))</span>
<a name="ln-236"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">97</span><span class="p">:</span><span class="mi">122</span><span class="p">)</span>
<a name="ln-237"></a>      <span class="n">Upper_Case</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">)</span><span class="o">=</span><span class="nb">char</span><span class="p">(</span><span class="nb">ichar</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n1</span><span class="p">))</span><span class="o">-</span><span class="mi">32</span><span class="p">)</span> <span class="c">! Upper case conversion</span>
<a name="ln-238"></a>    <span class="n">endselect</span>
<a name="ln-239"></a>  <span class="n">enddo</span>
<a name="ln-240"></a>  <span class="k">return</span>
<a name="ln-241"></a>  <span class="c">!(doc/)codesnippet</span>
<a name="ln-242"></a>  <span class="c">!!Upper\_Case function is private and cannot be called outside \LIBVTKIO. If you are interested to use it change its scope</span>
<a name="ln-243"></a>  <span class="c">!!to public.</span>
<a name="ln-244"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-245"></a>  <span class="n">endfunction</span> <span class="n">Upper_Case</span>
<a name="ln-246"></a>
<a name="ln-247"></a>  <span class="c">!\chapter{VTK LEGACY functions}</span>
<a name="ln-248"></a>  <span class="c">!\minitoc</span>
<a name="ln-249"></a>  <span class="c">!\vspace*{8mm}</span>
<a name="ln-250"></a>  <span class="c">!</span>
<a name="ln-251"></a>  <span class="k">function </span><span class="n">VTK_INI</span><span class="p">(</span><span class="n">output_format</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">mesh_topology</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-252"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-253"></a>  <span class="c">!!The VTK\_INI function is used for initializing file. This function must be the first to be called.</span>
<a name="ln-254"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-255"></a>
<a name="ln-256"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-257"></a>  <span class="k">implicit none</span>
<a name="ln-258"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">output_format</span> <span class="c">! output format: ASCII or BINARY</span>
<a name="ln-259"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">filename</span>      <span class="c">! name of file</span>
<a name="ln-260"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">title</span>         <span class="c">! title</span>
<a name="ln-261"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">mesh_topology</span> <span class="c">! mesh topology</span>
<a name="ln-262"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-263"></a>  <span class="c">!!The VTK\_INI variables have the following meaning:</span>
<a name="ln-264"></a>  <span class="c">!!</span>
<a name="ln-265"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-266"></a>  <span class="c">!! \item[{\color{RoyalBlue}output\_format}] indicates the \virgo{format} of output file. It can assume the following values:</span>
<a name="ln-267"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-268"></a>  <span class="c">!!  \item \emph{ascii} (it is case insensitive) $\rightarrow$ creating an ascii output file.</span>
<a name="ln-269"></a>  <span class="c">!!  \item \emph{binary} (it is case insensitive) $\rightarrow$ creating a binary (big\_endian encoding) output file.</span>
<a name="ln-270"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-271"></a>  <span class="c">!! \item[{\color{RoyalBlue}filename}] contains the name (with its path) of the output file.</span>
<a name="ln-272"></a>  <span class="c">!! \item[{\color{RoyalBlue}title}] contains the title of the VTK dataset.</span>
<a name="ln-273"></a>  <span class="c">!! \item[{\color{RoyalBlue}topology}] indicates the topology of the mesh and can assume the following values:</span>
<a name="ln-274"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-275"></a>  <span class="c">!!  \item \emph{STRUCTURED\_POINTS}.</span>
<a name="ln-276"></a>  <span class="c">!!  \item \emph{STRUCTURED\_GRID}.</span>
<a name="ln-277"></a>  <span class="c">!!  \item \emph{UNSTRUCTURED\_GRID}.</span>
<a name="ln-278"></a>  <span class="c">!!  \item \emph{RECTILINEAR\_GRID}.</span>
<a name="ln-279"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-280"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-281"></a>  <span class="c">!!\end{description}</span>
<a name="ln-282"></a>  <span class="c">!!</span>
<a name="ln-283"></a>  <span class="c">!!The following is an example of VTK\_INI calling:</span>
<a name="ln-284"></a>  <span class="c">!!</span>
<a name="ln-285"></a>  <span class="c">!!\begin{boxred}{VTK\_INI Calling}</span>
<a name="ln-286"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-287"></a>  <span class="c">!!...</span>
<a name="ln-288"></a>  <span class="c">!!E_IO = VTK_INI(&#39;Binary&#39;,&#39;example.vtk&#39;,&#39;VTK legacy file&#39;,&#39;UNSTRUCTURED_GRID&#39;)</span>
<a name="ln-289"></a>  <span class="c">!!...</span>
<a name="ln-290"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-291"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-292"></a>  <span class="c">!!\noindent Note that the \virgo{.vtk} extension is necessary in the file name.</span>
<a name="ln-293"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-294"></a>
<a name="ln-295"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-296"></a>  <span class="n">topology</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">mesh_topology</span><span class="p">)</span>
<a name="ln-297"></a>  <span class="n">Unit_VTK</span><span class="o">=</span><span class="n">GetUnit</span><span class="p">()</span>
<a name="ln-298"></a>  <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">output_format</span><span class="p">)))</span>
<a name="ln-299"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ASCII&#39;</span><span class="p">)</span>
<a name="ln-300"></a>    <span class="n">f_out</span> <span class="o">=</span> <span class="n">f_out_ascii</span>
<a name="ln-301"></a>    <span class="k">open</span><span class="p">(</span><span class="n">unit</span>     <span class="o">=</span> <span class="n">Unit_VTK</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-302"></a>         <span class="k">file</span>     <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-303"></a>         <span class="n">form</span>     <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-304"></a>         <span class="nb">access</span>   <span class="o">=</span> <span class="s1">&#39;SEQUENTIAL&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-305"></a>         <span class="n">action</span>   <span class="o">=</span> <span class="s1">&#39;WRITE&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-306"></a>         <span class="n">iostat</span>   <span class="o">=</span> <span class="n">E_IO</span><span class="p">)</span>
<a name="ln-307"></a>    <span class="c">! writing header of file</span>
<a name="ln-308"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;# vtk DataFile Version 3.0&#39;</span>
<a name="ln-309"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<a name="ln-310"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">output_format</span><span class="p">))</span>
<a name="ln-311"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DATASET &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span>
<a name="ln-312"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;BINARY&#39;</span><span class="p">)</span>
<a name="ln-313"></a>    <span class="n">f_out</span> <span class="o">=</span> <span class="n">f_out_binary</span>
<a name="ln-314"></a>    <span class="k">open</span><span class="p">(</span><span class="n">unit</span>       <span class="o">=</span> <span class="n">Unit_VTK</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-315"></a>         <span class="k">file</span>       <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-316"></a>         <span class="n">form</span>       <span class="o">=</span> <span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-317"></a>         <span class="nb">access</span>     <span class="o">=</span> <span class="s1">&#39;STREAM&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-318"></a>         <span class="n">action</span>     <span class="o">=</span> <span class="s1">&#39;WRITE&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-319"></a>         <span class="n">convert</span>    <span class="o">=</span> <span class="s1">&#39;BIG_ENDIAN&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-320"></a>         <span class="n">iostat</span>     <span class="o">=</span> <span class="n">E_IO</span><span class="p">)</span>
<a name="ln-321"></a>    <span class="c">! writing header of file</span>
<a name="ln-322"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;# vtk DataFile Version 3.0&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-323"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-324"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">output_format</span><span class="p">))</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-325"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DATASET &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-326"></a>  <span class="n">endselect</span>
<a name="ln-327"></a>  <span class="k">return</span>
<a name="ln-328"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-329"></a>  <span class="n">endfunction</span> <span class="n">VTK_INI</span>
<a name="ln-330"></a>
<a name="ln-331"></a>  <span class="c">!(doc)INCLUDE{/home/szaghi/VTK_IO/LIB_VTK_IO/source/DOC_VTK_GEO.doc}</span>
<a name="ln-332"></a>  <span class="c">!(\doc)skippedblock</span>
<a name="ln-333"></a>  <span class="k">function </span><span class="n">VTK_GEO_STRP_R8</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span><span class="p">,</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dz</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-334"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-335"></a>  <span class="c">!! Function for saving mesh; topology = STRUCTURED\_POINTS (R8P).</span>
<a name="ln-336"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-337"></a>
<a name="ln-338"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-339"></a>  <span class="k">implicit none</span>
<a name="ln-340"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nx</span>        <span class="c">! number of nodes in x direction</span>
<a name="ln-341"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Ny</span>        <span class="c">! number of nodes in y direction</span>
<a name="ln-342"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nz</span>        <span class="c">! number of nodes in z direction</span>
<a name="ln-343"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X0</span>        <span class="c">! x coordinate of origin</span>
<a name="ln-344"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y0</span>        <span class="c">! y coordinate of origin</span>
<a name="ln-345"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z0</span>        <span class="c">! z coordinate of origin</span>
<a name="ln-346"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dx</span>        <span class="c">! space step in x direction</span>
<a name="ln-347"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dy</span>        <span class="c">! space step in y direction</span>
<a name="ln-348"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dz</span>        <span class="c">! space step in z direction</span>
<a name="ln-349"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-350"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>  <span class="c">! buffer string</span>
<a name="ln-351"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-352"></a>
<a name="ln-353"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-354"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-355"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-356"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-357"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;ORIGIN &#39;</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span>
<a name="ln-358"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SPACING &#39;</span><span class="p">,</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dz</span>
<a name="ln-359"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-360"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-361"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-362"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;ORIGIN &#39;</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span>
<a name="ln-363"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-364"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SPACING &#39;</span><span class="p">,</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dz</span>
<a name="ln-365"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-366"></a>  <span class="n">endselect</span>
<a name="ln-367"></a>  <span class="k">return</span>
<a name="ln-368"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-369"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_STRP_R8</span>
<a name="ln-370"></a>
<a name="ln-371"></a>  <span class="k">function </span><span class="n">VTK_GEO_STRP_R4</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span><span class="p">,</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dz</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-372"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-373"></a>  <span class="c">!! Function for saving mesh; topology = STRUCTURED\_POINTS (R4P).</span>
<a name="ln-374"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-375"></a>
<a name="ln-376"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-377"></a>  <span class="k">implicit none</span>
<a name="ln-378"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nx</span>        <span class="c">! number of nodes in x direction</span>
<a name="ln-379"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Ny</span>        <span class="c">! number of nodes in y direction</span>
<a name="ln-380"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nz</span>        <span class="c">! number of nodes in z direction</span>
<a name="ln-381"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X0</span>        <span class="c">! x coordinate of origin</span>
<a name="ln-382"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y0</span>        <span class="c">! y coordinate of origin</span>
<a name="ln-383"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z0</span>        <span class="c">! z coordinate of origin</span>
<a name="ln-384"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dx</span>        <span class="c">! space step in x direction</span>
<a name="ln-385"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dy</span>        <span class="c">! space step in y direction</span>
<a name="ln-386"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Dz</span>        <span class="c">! space step in z direction</span>
<a name="ln-387"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-388"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>  <span class="c">! buffer string</span>
<a name="ln-389"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-390"></a>
<a name="ln-391"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-392"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-393"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-394"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-395"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;ORIGIN &#39;</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span>
<a name="ln-396"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SPACING &#39;</span><span class="p">,</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dz</span>
<a name="ln-397"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-398"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-399"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-400"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;ORIGIN &#39;</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span>
<a name="ln-401"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-402"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SPACING &#39;</span><span class="p">,</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dz</span>
<a name="ln-403"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-404"></a>  <span class="n">endselect</span>
<a name="ln-405"></a>  <span class="k">return</span>
<a name="ln-406"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-407"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_STRP_R4</span>
<a name="ln-408"></a>
<a name="ln-409"></a>  <span class="k">function </span><span class="n">VTK_GEO_STRG_R8</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-410"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-411"></a>  <span class="c">!! Function for saving mesh; topology = STRUCTURED\_GRID (R8P).</span>
<a name="ln-412"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-413"></a>
<a name="ln-414"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-415"></a>  <span class="k">implicit none</span>
<a name="ln-416"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nx</span>       <span class="c">! number of nodes in x direction</span>
<a name="ln-417"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Ny</span>       <span class="c">! number of nodes in y direction</span>
<a name="ln-418"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nz</span>       <span class="c">! number of nodes in z direction</span>
<a name="ln-419"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>       <span class="c">! number of all nodes</span>
<a name="ln-420"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! x coordinates</span>
<a name="ln-421"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! y coordinates</span>
<a name="ln-422"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! z coordinates</span>
<a name="ln-423"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-424"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span> <span class="c">! buffer string</span>
<a name="ln-425"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>       <span class="c">! counter</span>
<a name="ln-426"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-427"></a>
<a name="ln-428"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-429"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-430"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-431"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-432"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-433"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>   <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-434"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-435"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-436"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-437"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-438"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-439"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-440"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-441"></a>  <span class="n">endselect</span>
<a name="ln-442"></a>  <span class="k">return</span>
<a name="ln-443"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-444"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_STRG_R8</span>
<a name="ln-445"></a>
<a name="ln-446"></a>  <span class="k">function </span><span class="n">VTK_GEO_STRG_R4</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-447"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-448"></a>  <span class="c">!! Function for saving mesh; topology = STRUCTURED\_GRID (R4P).</span>
<a name="ln-449"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-450"></a>
<a name="ln-451"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-452"></a>  <span class="k">implicit none</span>
<a name="ln-453"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nx</span>       <span class="c">! number of nodes in x direction</span>
<a name="ln-454"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Ny</span>       <span class="c">! number of nodes in y direction</span>
<a name="ln-455"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nz</span>       <span class="c">! number of nodes in z direction</span>
<a name="ln-456"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>       <span class="c">! number of all nodes</span>
<a name="ln-457"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! x coordinates</span>
<a name="ln-458"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! y coordinates</span>
<a name="ln-459"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! z coordinates</span>
<a name="ln-460"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-461"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span> <span class="c">! buffer string</span>
<a name="ln-462"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>       <span class="c">! counter</span>
<a name="ln-463"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-464"></a>
<a name="ln-465"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-466"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-467"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-468"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-469"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-470"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>   <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-471"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-472"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-473"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-474"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-475"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-476"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-477"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-478"></a>  <span class="n">endselect</span>
<a name="ln-479"></a>  <span class="k">return</span>
<a name="ln-480"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-481"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_STRG_R4</span>
<a name="ln-482"></a>
<a name="ln-483"></a>  <span class="k">function </span><span class="n">VTK_GEO_RECT_R8</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-484"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-485"></a>  <span class="c">!! Function for saving mesh; topology = RECTILINEAR\_GRID (R8P).</span>
<a name="ln-486"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-487"></a>
<a name="ln-488"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-489"></a>  <span class="k">implicit none</span>
<a name="ln-490"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nx</span>        <span class="c">! number of nodes in x direction</span>
<a name="ln-491"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Ny</span>        <span class="c">! number of nodes in y direction</span>
<a name="ln-492"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nz</span>        <span class="c">! number of nodes in z direction</span>
<a name="ln-493"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="p">)</span>   <span class="c">! x coordinates</span>
<a name="ln-494"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ny</span><span class="p">)</span>   <span class="c">! y coordinates</span>
<a name="ln-495"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nz</span><span class="p">)</span>   <span class="c">! z coordinates</span>
<a name="ln-496"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-497"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>  <span class="c">! buffer string</span>
<a name="ln-498"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>        <span class="c">! counter</span>
<a name="ln-499"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-500"></a>
<a name="ln-501"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-502"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-503"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-504"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-505"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;X_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-506"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span>              <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nx</span><span class="p">)</span>
<a name="ln-507"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Y_COORDINATES &#39;</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-508"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span>              <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ny</span><span class="p">)</span>
<a name="ln-509"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Z_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-510"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span>              <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nz</span><span class="p">)</span>
<a name="ln-511"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-512"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-513"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-514"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;X_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-515"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-516"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nx</span><span class="p">)</span>
<a name="ln-517"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-518"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Y_COORDINATES &#39;</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-519"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-520"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ny</span><span class="p">)</span>
<a name="ln-521"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-522"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Z_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-523"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-524"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nz</span><span class="p">)</span>
<a name="ln-525"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-526"></a>  <span class="n">endselect</span>
<a name="ln-527"></a>  <span class="k">return</span>
<a name="ln-528"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-529"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_RECT_R8</span>
<a name="ln-530"></a>
<a name="ln-531"></a>  <span class="k">function </span><span class="n">VTK_GEO_RECT_R4</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-532"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-533"></a>  <span class="c">!! Function for saving mesh; topology = RECTILINEAR\_GRID (R4P).</span>
<a name="ln-534"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-535"></a>
<a name="ln-536"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-537"></a>  <span class="k">implicit none</span>
<a name="ln-538"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nx</span>        <span class="c">! number of nodes in x direction</span>
<a name="ln-539"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Ny</span>        <span class="c">! number of nodes in y direction</span>
<a name="ln-540"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Nz</span>        <span class="c">! number of nodes in z direction</span>
<a name="ln-541"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="p">)</span>   <span class="c">! x coordinates</span>
<a name="ln-542"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ny</span><span class="p">)</span>   <span class="c">! y coordinates</span>
<a name="ln-543"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nz</span><span class="p">)</span>   <span class="c">! z coordinates</span>
<a name="ln-544"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-545"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>  <span class="c">! buffer string</span>
<a name="ln-546"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>        <span class="c">! counter</span>
<a name="ln-547"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-548"></a>
<a name="ln-549"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-550"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-551"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-552"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-553"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;X_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-554"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span>              <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nx</span><span class="p">)</span>
<a name="ln-555"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Y_COORDINATES &#39;</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-556"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span>              <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ny</span><span class="p">)</span>
<a name="ln-557"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Z_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-558"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span>              <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nz</span><span class="p">)</span>
<a name="ln-559"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-560"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;DIMENSIONS &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nz</span>
<a name="ln-561"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-562"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;X_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-563"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-564"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nx</span><span class="p">)</span>
<a name="ln-565"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-566"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Y_COORDINATES &#39;</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-567"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-568"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ny</span><span class="p">)</span>
<a name="ln-569"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-570"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;Z_COORDINATES &#39;</span><span class="p">,</span><span class="n">Nz</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-571"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-572"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Nz</span><span class="p">)</span>
<a name="ln-573"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-574"></a>  <span class="n">endselect</span>
<a name="ln-575"></a>  <span class="k">return</span>
<a name="ln-576"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-577"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_RECT_R4</span>
<a name="ln-578"></a>
<a name="ln-579"></a>  <span class="k">function </span><span class="n">VTK_GEO_UNST_R8</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-580"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-581"></a>  <span class="c">!! Function for saving mesh; topology = UNSTRUCTURED\_GRID (R8P).</span>
<a name="ln-582"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-583"></a>
<a name="ln-584"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-585"></a>  <span class="k">implicit none</span>
<a name="ln-586"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>        <span class="c">! number of nodes</span>
<a name="ln-587"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>   <span class="c">! x coordinates of all nodes</span>
<a name="ln-588"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>   <span class="c">! y coordinates of all nodes</span>
<a name="ln-589"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>   <span class="c">! z coordinates of all nodes</span>
<a name="ln-590"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-591"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>  <span class="c">! buffer string</span>
<a name="ln-592"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>        <span class="c">! counter</span>
<a name="ln-593"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-594"></a>
<a name="ln-595"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-596"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-597"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-598"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-599"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>   <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-600"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-601"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-602"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-603"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-604"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-605"></a>  <span class="n">endselect</span>
<a name="ln-606"></a>  <span class="k">return</span>
<a name="ln-607"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-608"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_UNST_R8</span>
<a name="ln-609"></a>
<a name="ln-610"></a>  <span class="k">function </span><span class="n">VTK_GEO_UNST_R4</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-611"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-612"></a>  <span class="c">!! Function for saving mesh; topology = UNSTRUCTURED\_GRID (R4P).</span>
<a name="ln-613"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-614"></a>
<a name="ln-615"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-616"></a>  <span class="k">implicit none</span>
<a name="ln-617"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>        <span class="c">! number of nodes</span>
<a name="ln-618"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>   <span class="c">! x coordinates of all nodes</span>
<a name="ln-619"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>   <span class="c">! y coordinates of all nodes</span>
<a name="ln-620"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>   <span class="c">! z coordinates of all nodes</span>
<a name="ln-621"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-622"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>  <span class="c">! buffer string</span>
<a name="ln-623"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>        <span class="c">! counter</span>
<a name="ln-624"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-625"></a>
<a name="ln-626"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-627"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-628"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-629"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-630"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>   <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-631"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-632"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINTS &#39;</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-633"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-634"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-635"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-636"></a>  <span class="n">endselect</span>
<a name="ln-637"></a>  <span class="k">return</span>
<a name="ln-638"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-639"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_UNST_R4</span>
<a name="ln-640"></a>  <span class="c">!(doc/)skippedblock</span>
<a name="ln-641"></a>
<a name="ln-642"></a>  <span class="k">function </span><span class="n">VTK_CON</span><span class="p">(</span><span class="n">NC</span><span class="p">,</span><span class="n">connect</span><span class="p">,</span><span class="n">cell_type</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-643"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-644"></a>  <span class="c">!!This function \MaiuscolettoBS{must} be used when unstructured grid is used. It saves the connectivity of the unstructured</span>
<a name="ln-645"></a>  <span class="c">!!mesh.</span>
<a name="ln-646"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-647"></a>
<a name="ln-648"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-649"></a>  <span class="k">implicit none</span>
<a name="ln-650"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC</span>              <span class="c">! number of cells</span>
<a name="ln-651"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">connect</span><span class="p">(:)</span>      <span class="c">! mesh connectivity</span>
<a name="ln-652"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">cell_type</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC</span><span class="p">)</span> <span class="c">! VTK cell type</span>
<a name="ln-653"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>            <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-654"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>        <span class="c">! buffer string</span>
<a name="ln-655"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">ncon</span>            <span class="c">! dimension of connectivity vector </span>
<a name="ln-656"></a>  <span class="c">!!The VTK\_CON variables have the following meaning:</span>
<a name="ln-657"></a>  <span class="c">!!</span>
<a name="ln-658"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-659"></a>  <span class="c">!! \item[{\color{RoyalBlue}NC}] indicates the number of all cells.</span>
<a name="ln-660"></a>  <span class="c">!! \item[{\color{RoyalBlue}connect}] contains the connectivity of the mesh. It is a vector.</span>
<a name="ln-661"></a>  <span class="c">!! \item[{\color{RoyalBlue}cell\_type}] contains the type of every cells. It is a vector of $[1:NC]$.</span>
<a name="ln-662"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-663"></a>  <span class="c">!!\end{description}</span>
<a name="ln-664"></a>  <span class="c">!!</span>
<a name="ln-665"></a>  <span class="c">!!The vector \MaiuscolettoBS{connect} must follow the VTK legacy standard. It is passed as \MaiuscolettoBS{assumed-shape} array</span>
<a name="ln-666"></a>  <span class="c">!!because its dimensions is related to the mesh dimensions in a complex way. Its dimensions can be calculated by the following</span>
<a name="ln-667"></a>  <span class="c">!!equation:</span>
<a name="ln-668"></a>  <span class="c">!!</span>
<a name="ln-669"></a>  <span class="c">!!\begin{equation}</span>
<a name="ln-670"></a>  <span class="c">!!dc = NC + \sum\limits_{i = 1}^{NC} {nvertex_i }</span>
<a name="ln-671"></a>  <span class="c">!!\label{eq:connectivity dimensions}</span>
<a name="ln-672"></a>  <span class="c">!!\end{equation}</span>
<a name="ln-673"></a>  <span class="c">!!</span>
<a name="ln-674"></a>  <span class="c">!!\noindent where $dc$ is connectivity vector dimension and $nvertex_i$ is the number of vertices of $i^{th}$ cell. The VTK</span>
<a name="ln-675"></a>  <span class="c">!!legacy standard for the mesh connectivity is quite obscure at least at first sight. It is more simple analizing an example.</span>
<a name="ln-676"></a>  <span class="c">!!Suppose we have a mesh composed by 2 cells, one hexahedron (8 vertices) and one pyramid with square basis (5 vertices); suppose</span>
<a name="ln-677"></a>  <span class="c">!!that the basis of pyramid is constitute by a face of the hexahedron and so the two cells share 4 vertices. The equation</span>
<a name="ln-678"></a>  <span class="c">!!\ref{eq:connectivity dimensions} gives $dc=2+8+5=15$; the connectivity vector for this mesh can be:</span>
<a name="ln-679"></a>  <span class="c">!!</span>
<a name="ln-680"></a>  <span class="c">!!\begin{boxred}{Connectivity vector example for VTK legacy standard}</span>
<a name="ln-681"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-682"></a>  <span class="c">!!! first cell</span>
<a name="ln-683"></a>  <span class="c">!!connect(1)  = 8  =&gt; number of vertices of 1° cell</span>
<a name="ln-684"></a>  <span class="c">!!connect(2)  = 0  =&gt; identification flag of 1° vertex of 1° cell</span>
<a name="ln-685"></a>  <span class="c">!!connect(3)  = 1  =&gt; identification flag of 2° vertex of 1° cell</span>
<a name="ln-686"></a>  <span class="c">!!connect(4)  = 2  =&gt; identification flag of 3° vertex of 1° cell</span>
<a name="ln-687"></a>  <span class="c">!!connect(5)  = 3  =&gt; identification flag of 4° vertex of 1° cell</span>
<a name="ln-688"></a>  <span class="c">!!connect(6)  = 4  =&gt; identification flag of 5° vertex of 1° cell</span>
<a name="ln-689"></a>  <span class="c">!!connect(7)  = 5  =&gt; identification flag of 6° vertex of 1° cell</span>
<a name="ln-690"></a>  <span class="c">!!connect(8)  = 6  =&gt; identification flag of 7° vertex of 1° cell</span>
<a name="ln-691"></a>  <span class="c">!!connect(9)  = 7  =&gt; identification flag of 8° vertex of 1° cell</span>
<a name="ln-692"></a>  <span class="c">!!! second cell</span>
<a name="ln-693"></a>  <span class="c">!!connect(10) = 5  =&gt; number of vertices of 2° cell</span>
<a name="ln-694"></a>  <span class="c">!!connect(11) = 0  =&gt; identification flag of 1° vertex of 2° cell</span>
<a name="ln-695"></a>  <span class="c">!!connect(12) = 1  =&gt; identification flag of 2° vertex of 2° cell</span>
<a name="ln-696"></a>  <span class="c">!!connect(13) = 2  =&gt; identification flag of 3° vertex of 2° cell</span>
<a name="ln-697"></a>  <span class="c">!!connect(14) = 3  =&gt; identification flag of 4° vertex of 2° cell</span>
<a name="ln-698"></a>  <span class="c">!!connect(15) = 8  =&gt; identification flag of 5° vertex of 2° cell</span>
<a name="ln-699"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-700"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-701"></a>  <span class="c">!!</span>
<a name="ln-702"></a>  <span class="c">!!\noindent Note that the first 4 identification flags of pyramid vertices as the same of the first 4 identification flags of</span>
<a name="ln-703"></a>  <span class="c">!!the hexahedron because the two cells share this face. It is also important to note that the identification flags start</span>
<a name="ln-704"></a>  <span class="c">!!form $0$ value: this is impose to the VTK standard. The function VTK\_CON does not calculate the connectivity vector: it</span>
<a name="ln-705"></a>  <span class="c">!!writes the connectivity vector conforming the VTK standard, but does not calculate it. In the future release of \LIBVTKIO will</span>
<a name="ln-706"></a>  <span class="c">!!be included a function to calculate the connectivity vector.</span>
<a name="ln-707"></a>  <span class="c">!!</span>
<a name="ln-708"></a>  <span class="c">!!The vector variable \MaiuscolettoBS{tipo} must conform the VTK standard \footnote{See the file VTK-Standard at the Kitware</span>
<a name="ln-709"></a>  <span class="c">!!homepage.}. It contains the \emph{type} of each cells. For the above example this vector is:</span>
<a name="ln-710"></a>  <span class="c">!!</span>
<a name="ln-711"></a>  <span class="c">!!\begin{boxred}{Cell-Type vector example for VTK legacy standard}</span>
<a name="ln-712"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-713"></a>  <span class="c">!!tipo(1) = 12  =&gt; VTK hexahedron type of 1° cell</span>
<a name="ln-714"></a>  <span class="c">!!tipo(2) = 14  =&gt; VTK pyramid type of 2° cell</span>
<a name="ln-715"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-716"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-717"></a>  <span class="c">!!</span>
<a name="ln-718"></a>  <span class="c">!!The following is an example of VTK\_CON calling:</span>
<a name="ln-719"></a>  <span class="c">!!</span>
<a name="ln-720"></a>  <span class="c">!!\begin{boxred}{VTK\_CON Calling}</span>
<a name="ln-721"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-722"></a>  <span class="c">!!...</span>
<a name="ln-723"></a>  <span class="c">!!integer(4), parameter:: NC=2</span>
<a name="ln-724"></a>  <span class="c">!!integer(4), parameter:: Nvertex1=8</span>
<a name="ln-725"></a>  <span class="c">!!integer(4), parameter:: Nvertex2=5</span>
<a name="ln-726"></a>  <span class="c">!!integer(4), parameter:: dc=NC+Nvertex1+Nvertex2</span>
<a name="ln-727"></a>  <span class="c">!!integer(4)::            connect(1:dc)</span>
<a name="ln-728"></a>  <span class="c">!!integer(4)::            cell_type(1:NC)</span>
<a name="ln-729"></a>  <span class="c">!!...</span>
<a name="ln-730"></a>  <span class="c">!!E_IO = VTK_CON(NC,connect,cell_type)</span>
<a name="ln-731"></a>  <span class="c">!!...</span>
<a name="ln-732"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-733"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-734"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-735"></a>
<a name="ln-736"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-737"></a>  <span class="n">ncon</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">connect</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-738"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-739"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-740"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,2&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;CELLS &#39;</span><span class="p">,</span><span class="n">NC</span><span class="p">,</span><span class="n">ncon</span>
<a name="ln-741"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI4P</span><span class="p">,</span>             <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">connect</span>
<a name="ln-742"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;CELL_TYPES &#39;</span><span class="p">,</span><span class="n">NC</span>
<a name="ln-743"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI4P</span><span class="p">,</span>             <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">cell_type</span>
<a name="ln-744"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-745"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,2&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;CELLS &#39;</span><span class="p">,</span><span class="n">NC</span><span class="p">,</span><span class="n">ncon</span>
<a name="ln-746"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                      <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-747"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                      <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">connect</span>
<a name="ln-748"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                      <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-749"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span>     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;CELL_TYPES &#39;</span><span class="p">,</span><span class="n">NC</span>
<a name="ln-750"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                      <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-751"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                      <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">cell_type</span>
<a name="ln-752"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>                      <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-753"></a>  <span class="n">endselect</span>
<a name="ln-754"></a>  <span class="k">return</span>
<a name="ln-755"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-756"></a>  <span class="n">endfunction</span> <span class="n">VTK_CON</span>
<a name="ln-757"></a>
<a name="ln-758"></a>  <span class="k">function </span><span class="n">VTK_DAT</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">var_location</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-759"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-760"></a>  <span class="c">!!This function \MaiuscolettoBS{must} be called before saving the data related to geometric mesh. This function initializes the</span>
<a name="ln-761"></a>  <span class="c">!!saving of data variables indicating the \emph{type} of variables that will be saved.</span>
<a name="ln-762"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-763"></a>
<a name="ln-764"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-765"></a>  <span class="k">implicit none</span>
<a name="ln-766"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes of field</span>
<a name="ln-767"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var_location</span> <span class="c">! location of saving variables: cell for cell-centered, node for node-centered</span>
<a name="ln-768"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-769"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>     <span class="c">! buffer string</span>
<a name="ln-770"></a>  <span class="c">!!The VTK\_DAT variables have the following meaning:</span>
<a name="ln-771"></a>  <span class="c">!!</span>
<a name="ln-772"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-773"></a>  <span class="c">!! \item[{\color{RoyalBlue}NC\_NN}] indicates the number of all cells or all nodes according to the value of</span>
<a name="ln-774"></a>  <span class="c">!!                                  {\color{RoyalBlue}tipo}.</span>
<a name="ln-775"></a>  <span class="c">!! \item[{\color{RoyalBlue}var\_location}] contains the location-type of variables that will be saved after VTK\_DAT. It is</span>
<a name="ln-776"></a>  <span class="c">!!                                         a scalar and cab assume the following values:</span>
<a name="ln-777"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-778"></a>  <span class="c">!!  \item \emph{cell} (it is case insensitive) $\rightarrow$ variables will be cell-centered.</span>
<a name="ln-779"></a>  <span class="c">!!  \item \emph{node} (it is case insensitive) $\rightarrow$ variables will be node-centered.</span>
<a name="ln-780"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-781"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-782"></a>  <span class="c">!!\end{description}</span>
<a name="ln-783"></a>  <span class="c">!!</span>
<a name="ln-784"></a>  <span class="c">!!Of course a single file can contain both cell and node centered variables; in this case the VTK\_DAT function must be</span>
<a name="ln-785"></a>  <span class="c">!!called two times, before saving cell-centered variables and before saving node-centered variables.</span>
<a name="ln-786"></a>  <span class="c">!!</span>
<a name="ln-787"></a>  <span class="c">!!The following is an example of VTK\_DAT calling:</span>
<a name="ln-788"></a>  <span class="c">!!</span>
<a name="ln-789"></a>  <span class="c">!!\begin{boxred}{VTK\_DAT Calling}</span>
<a name="ln-790"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-791"></a>  <span class="c">!!...</span>
<a name="ln-792"></a>  <span class="c">!!E_IO = VTK_DAT(50,&#39;node&#39;)</span>
<a name="ln-793"></a>  <span class="c">!!...</span>
<a name="ln-794"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-795"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-796"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-797"></a>
<a name="ln-798"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-799"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-800"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-801"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_location</span><span class="p">)))</span>
<a name="ln-802"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CELL&#39;</span><span class="p">)</span>
<a name="ln-803"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;CELL_DATA &#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-804"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;NODE&#39;</span><span class="p">)</span>
<a name="ln-805"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINT_DATA &#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-806"></a>    <span class="n">endselect</span>
<a name="ln-807"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-808"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_location</span><span class="p">)))</span>
<a name="ln-809"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CELL&#39;</span><span class="p">)</span>
<a name="ln-810"></a>      <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;CELL_DATA &#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-811"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-812"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;NODE&#39;</span><span class="p">)</span>
<a name="ln-813"></a>      <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;POINT_DATA &#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-814"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-815"></a>    <span class="n">endselect</span>
<a name="ln-816"></a>  <span class="n">endselect</span>
<a name="ln-817"></a>  <span class="k">return</span>
<a name="ln-818"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-819"></a>  <span class="n">endfunction</span> <span class="n">VTK_DAT</span>
<a name="ln-820"></a>
<a name="ln-821"></a>  <span class="c">!(doc)INCLUDE{/home/szaghi/VTK_IO/LIB_VTK_IO/source/DOC_VTK_VAR.doc}</span>
<a name="ln-822"></a>  <span class="c">!(\doc)skippedblock</span>
<a name="ln-823"></a>  <span class="k">function </span><span class="n">VTK_VAR_SCAL_R8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-824"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-825"></a>  <span class="c">!! Function for saving field of scalar variable (R8P).</span>
<a name="ln-826"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-827"></a>
<a name="ln-828"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-829"></a>  <span class="k">implicit none</span>
<a name="ln-830"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of nodes or cells</span>
<a name="ln-831"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-832"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-833"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-834"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-835"></a>
<a name="ln-836"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-837"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-838"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-839"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SCALARS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; double 1&#39;</span>
<a name="ln-840"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;LOOKUP_TABLE default&#39;</span>
<a name="ln-841"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-842"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-843"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SCALARS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; double 1&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-844"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;LOOKUP_TABLE default&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-845"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-846"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-847"></a>  <span class="n">endselect</span>
<a name="ln-848"></a>  <span class="k">return</span>
<a name="ln-849"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-850"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_SCAL_R8</span>
<a name="ln-851"></a>
<a name="ln-852"></a>  <span class="k">function </span><span class="n">VTK_VAR_SCAL_R4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-853"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-854"></a>  <span class="c">!! Function for saving field of scalar variable (R4P).</span>
<a name="ln-855"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-856"></a>
<a name="ln-857"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-858"></a>  <span class="k">implicit none</span>
<a name="ln-859"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of nodes or cells</span>
<a name="ln-860"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-861"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-862"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-863"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-864"></a>
<a name="ln-865"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-866"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-867"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-868"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SCALARS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; float 1&#39;</span>
<a name="ln-869"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;LOOKUP_TABLE default&#39;</span>
<a name="ln-870"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-871"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-872"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SCALARS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; float 1&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-873"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;LOOKUP_TABLE default&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-874"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-875"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-876"></a>  <span class="n">endselect</span>
<a name="ln-877"></a>  <span class="k">return</span>
<a name="ln-878"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-879"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_SCAL_R4</span>
<a name="ln-880"></a>
<a name="ln-881"></a>  <span class="k">function </span><span class="n">VTK_VAR_SCAL_I4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-882"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-883"></a>  <span class="c">!! Function for saving field of scalar variable (I4P).</span>
<a name="ln-884"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-885"></a>
<a name="ln-886"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-887"></a>  <span class="k">implicit none</span>
<a name="ln-888"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of nodes or cells</span>
<a name="ln-889"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-890"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-891"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-892"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-893"></a>
<a name="ln-894"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-895"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-896"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-897"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SCALARS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; int 1&#39;</span>
<a name="ln-898"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;LOOKUP_TABLE default&#39;</span>
<a name="ln-899"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-900"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-901"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;SCALARS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; int 1&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-902"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;LOOKUP_TABLE default&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-903"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-904"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-905"></a>  <span class="n">endselect</span>
<a name="ln-906"></a>  <span class="k">return</span>
<a name="ln-907"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-908"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_SCAL_I4</span>
<a name="ln-909"></a>
<a name="ln-910"></a>  <span class="k">function </span><span class="n">VTK_VAR_VECT_R8</span><span class="p">(</span><span class="n">vec_type</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-911"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-912"></a>  <span class="c">!! Function for saving field of vectorial variable (R8P).</span>
<a name="ln-913"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-914"></a>
<a name="ln-915"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-916"></a>  <span class="k">implicit none</span>
<a name="ln-917"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">vec_type</span>      <span class="c">! vector type: vect = generic vector , norm = normal vector</span>
<a name="ln-918"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of nodes or cells</span>
<a name="ln-919"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-920"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component of vector</span>
<a name="ln-921"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component of vector</span>
<a name="ln-922"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component of vector</span>
<a name="ln-923"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-924"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-925"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-926"></a>
<a name="ln-927"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-928"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-929"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-930"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">vec_type</span><span class="p">)))</span>
<a name="ln-931"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;VECT&#39;</span><span class="p">)</span>
<a name="ln-932"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span>          <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;VECTORS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; double&#39;</span>
<a name="ln-933"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;NORM&#39;</span><span class="p">)</span>
<a name="ln-934"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span>          <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;NORMALS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; double&#39;</span>
<a name="ln-935"></a>    <span class="n">endselect</span>
<a name="ln-936"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-937"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-938"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">vec_type</span><span class="p">)))</span>
<a name="ln-939"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;VECT&#39;</span><span class="p">)</span>
<a name="ln-940"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;VECTORS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; double&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-941"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;NORM&#39;</span><span class="p">)</span>
<a name="ln-942"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;NORMALS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; double&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-943"></a>    <span class="n">endselect</span>
<a name="ln-944"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-945"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-946"></a>  <span class="n">endselect</span>
<a name="ln-947"></a>  <span class="k">return</span>
<a name="ln-948"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-949"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_VECT_R8</span>
<a name="ln-950"></a>
<a name="ln-951"></a>  <span class="k">function </span><span class="n">VTK_VAR_VECT_R4</span><span class="p">(</span><span class="n">vec_type</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-952"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-953"></a>  <span class="c">!! Function for saving field of vectorial variable (R4P).</span>
<a name="ln-954"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-955"></a>
<a name="ln-956"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-957"></a>  <span class="k">implicit none</span>
<a name="ln-958"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">vec_type</span>      <span class="c">! vector type: vect = generic vector , norm = normal vector</span>
<a name="ln-959"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of nodes or cells</span>
<a name="ln-960"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-961"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component of vector</span>
<a name="ln-962"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component of vector</span>
<a name="ln-963"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component of vector</span>
<a name="ln-964"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-965"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-966"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-967"></a>
<a name="ln-968"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-969"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-970"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-971"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">vec_type</span><span class="p">)))</span>
<a name="ln-972"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">)</span>
<a name="ln-973"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span>          <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;VECTORS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; float&#39;</span>
<a name="ln-974"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span>
<a name="ln-975"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span>          <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;NORMALS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; float&#39;</span>
<a name="ln-976"></a>    <span class="n">endselect</span>
<a name="ln-977"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-978"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-979"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">vec_type</span><span class="p">)))</span>
<a name="ln-980"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">)</span>
<a name="ln-981"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;VECTORS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; float&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-982"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span>
<a name="ln-983"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;NORMALS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; float&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-984"></a>    <span class="n">endselect</span>
<a name="ln-985"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-986"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-987"></a>  <span class="n">endselect</span>
<a name="ln-988"></a>  <span class="k">return</span>
<a name="ln-989"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-990"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_VECT_R4</span>
<a name="ln-991"></a>
<a name="ln-992"></a>  <span class="k">function </span><span class="n">VTK_VAR_VECT_I4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-993"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-994"></a>  <span class="c">!! Function for saving field of vectorial variable (I4P).</span>
<a name="ln-995"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-996"></a>
<a name="ln-997"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-998"></a>  <span class="k">implicit none</span>
<a name="ln-999"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of nodes or cells</span>
<a name="ln-1000"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-1001"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component of vector</span>
<a name="ln-1002"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component of vector</span>
<a name="ln-1003"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component of vector</span>
<a name="ln-1004"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1005"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-1006"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1007"></a>
<a name="ln-1008"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1009"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1010"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1011"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;VECTORS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; int&#39;</span>
<a name="ln-1012"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1013"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1014"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;VECTORS &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; int&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1015"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1016"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-1017"></a>  <span class="n">endselect</span>
<a name="ln-1018"></a>  <span class="k">return</span>
<a name="ln-1019"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1020"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_VECT_I4</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a>  <span class="k">function </span><span class="n">VTK_VAR_TEXT_R8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">dimm</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">textCoo</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1023"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1024"></a>  <span class="c">!! Function for saving texture variable (R8P).</span>
<a name="ln-1025"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1026"></a>
<a name="ln-1027"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1028"></a>  <span class="k">implicit none</span>
<a name="ln-1029"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                   <span class="c">! number of nodes or cells</span>
<a name="ln-1030"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">dimm</span>                    <span class="c">! texture dimensions</span>
<a name="ln-1031"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>                 <span class="c">! variable name</span>
<a name="ln-1032"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">textCoo</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dimm</span><span class="p">)</span> <span class="c">! texture</span>
<a name="ln-1033"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                    <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1034"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>                <span class="c">! buffer string</span>
<a name="ln-1035"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                   <span class="c">! counters</span>
<a name="ln-1036"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1037"></a>
<a name="ln-1038"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1039"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1040"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1041"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,1X,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,1X,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;TEXTURE_COORDINATES &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">),</span><span class="n">dimm</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-1042"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(I1)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">dimm</span>
<a name="ln-1043"></a>    <span class="n">s_buffer</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span>
<a name="ln-1044"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">),</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)((</span><span class="n">textCoo</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dimm</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1045"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1046"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,1X,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,1X,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;TEXTURE_COORDINATES &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">),</span><span class="n">dimm</span><span class="p">,</span><span class="s1">&#39; double&#39;</span>
<a name="ln-1047"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1048"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)((</span><span class="n">textCoo</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dimm</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1049"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-1050"></a>  <span class="n">endselect</span>
<a name="ln-1051"></a>  <span class="k">return</span>
<a name="ln-1052"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1053"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_TEXT_R8</span>
<a name="ln-1054"></a>
<a name="ln-1055"></a>  <span class="k">function </span><span class="n">VTK_VAR_TEXT_R4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">dimm</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">textCoo</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1056"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1057"></a>  <span class="c">!! Function for saving texture variable (R4P).</span>
<a name="ln-1058"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1061"></a>  <span class="k">implicit none</span>
<a name="ln-1062"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                   <span class="c">! number of nodes or cells</span>
<a name="ln-1063"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">dimm</span>                    <span class="c">! texture dimensions</span>
<a name="ln-1064"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>                 <span class="c">! variable name</span>
<a name="ln-1065"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">textCoo</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dimm</span><span class="p">)</span> <span class="c">! texture</span>
<a name="ln-1066"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                    <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1067"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>                <span class="c">! buffer string</span>
<a name="ln-1068"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                   <span class="c">! counters</span>
<a name="ln-1069"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1072"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1073"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1074"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,1X,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,1X,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;TEXTURE_COORDINATES &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">),</span><span class="n">dimm</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-1075"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(I1)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">dimm</span>
<a name="ln-1076"></a>    <span class="n">s_buffer</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span>
<a name="ln-1077"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">),</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)((</span><span class="n">textCoo</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dimm</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1078"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1079"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,1X,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,1X,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;TEXTURE_COORDINATES &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">),</span><span class="n">dimm</span><span class="p">,</span><span class="s1">&#39; float&#39;</span>
<a name="ln-1080"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1081"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)((</span><span class="n">textCoo</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dimm</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1082"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-1083"></a>  <span class="n">endselect</span>
<a name="ln-1084"></a>  <span class="k">return</span>
<a name="ln-1085"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1086"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_TEXT_R4</span>
<a name="ln-1087"></a>  <span class="c">!(doc/)skippedblock</span>
<a name="ln-1088"></a>
<a name="ln-1089"></a>  <span class="k">function </span><span class="n">VTK_END</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1090"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1091"></a>  <span class="c">!!This function is used to finalize the file opened and it has not inputs. The \LIBVTKIO manages the file unit without the</span>
<a name="ln-1092"></a>  <span class="c">!!user&#39;s action.</span>
<a name="ln-1093"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1096"></a>  <span class="k">implicit none</span>
<a name="ln-1097"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span> <span class="n">E_IO</span> <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1098"></a>  <span class="c">!!The VTK\_END variables have the following meaning:</span>
<a name="ln-1099"></a>  <span class="c">!!</span>
<a name="ln-1100"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-1101"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-1102"></a>  <span class="c">!!\end{description}</span>
<a name="ln-1103"></a>  <span class="c">!!</span>
<a name="ln-1104"></a>  <span class="c">!!The following is an example of VTK\_END calling:</span>
<a name="ln-1105"></a>  <span class="c">!!</span>
<a name="ln-1106"></a>  <span class="c">!!\begin{boxred}{VTK\_END Calling}</span>
<a name="ln-1107"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1108"></a>  <span class="c">!!...</span>
<a name="ln-1109"></a>  <span class="c">!!E_IO = VTK_END()</span>
<a name="ln-1110"></a>  <span class="c">!!...</span>
<a name="ln-1111"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1112"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1113"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1114"></a>
<a name="ln-1115"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1116"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1117"></a>  <span class="k">return</span>
<a name="ln-1118"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1119"></a>  <span class="n">endfunction</span> <span class="n">VTK_END</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>  <span class="c">!\chapter{VTK XML functions}</span>
<a name="ln-1122"></a>  <span class="c">!\minitoc</span>
<a name="ln-1123"></a>  <span class="c">!\vspace*{8mm}</span>
<a name="ln-1124"></a>  <span class="c">!</span>
<a name="ln-1125"></a>  <span class="c">!\lettrine[lines=2,loversize=-.1,lraise=0.2]{{\bf T}}{he} XML standard is more powerful than legacy one. It is more flexible</span>
<a name="ln-1126"></a>  <span class="c">!and free but on the other hand is more (but not so more using a library like \LIBVTKIO...) complex than legacy standard. The</span>
<a name="ln-1127"></a>  <span class="c">!output of XML functions is a well-formated XML file at least for the ascii format (in the binary format \LIBVTKIO use</span>
<a name="ln-1128"></a>  <span class="c">!raw-data format that does not produce a well formated XML file).</span>
<a name="ln-1129"></a>  <span class="c">!</span>
<a name="ln-1130"></a>  <span class="c">!The XML functions follow the same calling-convention of the legacy functions; all the \LIBVTKIO XML functions are</span>
<a name="ln-1131"></a>  <span class="c">!\MaiuscolettoBS{4-byte integer function}: the output of these functions is an integer that is $0$ if the function calling</span>
<a name="ln-1132"></a>  <span class="c">!has been done right while it is $&gt; 0$  if some errors occur. The functions calling is the same as legacy functions:</span>
<a name="ln-1133"></a>  <span class="c">!</span>
<a name="ln-1134"></a>  <span class="c">!\begin{boxred}{Functions Calling}</span>
<a name="ln-1135"></a>  <span class="c">!\begin{verbatim}</span>
<a name="ln-1136"></a>  <span class="c">!...</span>
<a name="ln-1137"></a>  <span class="c">!integer(4):: E_IO</span>
<a name="ln-1138"></a>  <span class="c">!...</span>
<a name="ln-1139"></a>  <span class="c">!E_IO = VTK_INI_XML(....</span>
<a name="ln-1140"></a>  <span class="c">!...</span>
<a name="ln-1141"></a>  <span class="c">!\end{verbatim}</span>
<a name="ln-1142"></a>  <span class="c">!\end{boxred}</span>
<a name="ln-1143"></a>  <span class="c">!</span>
<a name="ln-1144"></a>  <span class="c">!\noindent Note that the XML functions have the same name of legacy functions with the suffix \virgo{\_XML}.</span>
<a name="ln-1145"></a>  <span class="c">!</span>
<a name="ln-1146"></a>  <span class="k">function </span><span class="n">VTK_INI_XML</span><span class="p">(</span><span class="n">output_format</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">mesh_topology</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1147"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1148"></a>  <span class="c">!!The VTK\_INI\_XML function is used for initializing file. This function must be the first to be called.</span>
<a name="ln-1149"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1150"></a>
<a name="ln-1151"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1152"></a>  <span class="k">implicit none</span>
<a name="ln-1153"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>           <span class="n">output_format</span> <span class="c">! output format: ASCII or BINARY</span>
<a name="ln-1154"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>           <span class="n">filename</span>      <span class="c">! file name</span>
<a name="ln-1155"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>           <span class="n">mesh_topology</span> <span class="c">! mesh topology</span>
<a name="ln-1156"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span><span class="kd">::</span> <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span>       <span class="c">! initial and final nodes of x axis</span>
<a name="ln-1157"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span><span class="kd">::</span> <span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span>       <span class="c">! initial and final nodes of y axis</span>
<a name="ln-1158"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span><span class="kd">::</span> <span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span>       <span class="c">! initial and final nodes of z axis</span>
<a name="ln-1159"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>                       <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1160"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>              <span class="n">s_buffer</span>      <span class="c">! buffer string</span>
<a name="ln-1161"></a>  <span class="c">!!The VTK\_INI\_XML variables have the following meaning:</span>
<a name="ln-1162"></a>  <span class="c">!!</span>
<a name="ln-1163"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-1164"></a>  <span class="c">!!\item[{\color{RoyalBlue}output\_format}] indicates the \virgo{format} of output file. It can assume the following values:</span>
<a name="ln-1165"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-1166"></a>  <span class="c">!!  \item \emph{ascii} (it is case insensitive) $\rightarrow$ creating an ascii output file.</span>
<a name="ln-1167"></a>  <span class="c">!!  \item \emph{binary} (it is case insensitive) $\rightarrow$ creating a binary (big\_endian encoding) output file.</span>
<a name="ln-1168"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-1169"></a>  <span class="c">!! \item[{\color{RoyalBlue}filename}] contains the name (with its path) of the output file.</span>
<a name="ln-1170"></a>  <span class="c">!! \item[{\color{RoyalBlue}topology}] indicates the topology of the mesh and can assume the following values:</span>
<a name="ln-1171"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-1172"></a>  <span class="c">!!  \item \emph{StructuredGrid}.</span>
<a name="ln-1173"></a>  <span class="c">!!  \item \emph{RectilinearGrid}.</span>
<a name="ln-1174"></a>  <span class="c">!!  \item \emph{UnstructuredGrid}.</span>
<a name="ln-1175"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-1176"></a>  <span class="c">!! \item[{\color{RoyalBlue}nx1,nx2}] contains the extent of X axis; $nx1$ is the initial node and $nx2$ is the final.</span>
<a name="ln-1177"></a>  <span class="c">!! \item[{\color{RoyalBlue}ny1,ny2}] contains the extent of Y axis; $ny1$ is the initial node and $ny2$ is the final.</span>
<a name="ln-1178"></a>  <span class="c">!! \item[{\color{RoyalBlue}nz1,nz2}] contains the extent of Z axis; $nz1$ is the initial node and $nz2$ is the final.</span>
<a name="ln-1179"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-1180"></a>  <span class="c">!!\end{description}</span>
<a name="ln-1181"></a>  <span class="c">!!</span>
<a name="ln-1182"></a>  <span class="c">!!This function is quite more complex than the rispective legacy function; it needs more inputs: the XML standard needs more</span>
<a name="ln-1183"></a>  <span class="c">!!informations to initialize the file.</span>
<a name="ln-1184"></a>  <span class="c">!!</span>
<a name="ln-1185"></a>  <span class="c">!!The following is an example of VTK\_INI\_XML calling:</span>
<a name="ln-1186"></a>  <span class="c">!!</span>
<a name="ln-1187"></a>  <span class="c">!!\begin{boxred}{VTK\_INI\_XML Calling}</span>
<a name="ln-1188"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1189"></a>  <span class="c">!!...</span>
<a name="ln-1190"></a>  <span class="c">!!...</span>
<a name="ln-1191"></a>  <span class="c">!!E_IO = VTK_INI_XML(&#39;BINARY&#39;,&#39;XML_RECT_BINARY.vtr&#39;, &amp;</span>
<a name="ln-1192"></a>  <span class="c">!!                   &#39;RectilinearGrid&#39;,              &amp;</span>
<a name="ln-1193"></a>  <span class="c">!!                   nx1=nx1,nx2=nx2,                &amp;</span>
<a name="ln-1194"></a>  <span class="c">!!                   ny1=ny1,ny2=ny2,                &amp;</span>
<a name="ln-1195"></a>  <span class="c">!!                   nz1=nz1,nz2=nz2)</span>
<a name="ln-1196"></a>  <span class="c">!!...</span>
<a name="ln-1197"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1198"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1199"></a>  <span class="c">!!</span>
<a name="ln-1200"></a>  <span class="c">!!\noindent Note that the file extension is necessary in the file name. The XML standard has different extensions for each</span>
<a name="ln-1201"></a>  <span class="c">!!different topologies (i.e. \MaiuscolettoBS{.vtr} for rectilinear topology). See the VTK-standard file for more information.</span>
<a name="ln-1202"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1203"></a>
<a name="ln-1204"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1205"></a>  <span class="n">topology</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">mesh_topology</span><span class="p">)</span>
<a name="ln-1206"></a>  <span class="n">Unit_VTK</span><span class="o">=</span><span class="n">GetUnit</span><span class="p">()</span>
<a name="ln-1207"></a>  <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">output_format</span><span class="p">)))</span>
<a name="ln-1208"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ASCII&#39;</span><span class="p">)</span>
<a name="ln-1209"></a>    <span class="n">f_out</span> <span class="o">=</span> <span class="n">f_out_ascii</span>
<a name="ln-1210"></a>    <span class="k">open</span><span class="p">(</span><span class="n">unit</span>   <span class="o">=</span> <span class="n">Unit_VTK</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1211"></a>         <span class="k">file</span>   <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1212"></a>         <span class="n">form</span>   <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1213"></a>         <span class="nb">access</span> <span class="o">=</span> <span class="s1">&#39;SEQUENTIAL&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1214"></a>         <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;WRITE&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1215"></a>         <span class="n">iostat</span> <span class="o">=</span> <span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1216"></a>    <span class="c">! writing header of file</span>
<a name="ln-1217"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&#39;</span>
<a name="ln-1218"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;VTKFile type=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; version=&quot;0.1&quot; byte_order=&quot;BigEndian&quot;&gt;&#39;</span>
<a name="ln-1219"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1220"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">))</span>
<a name="ln-1221"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;RectilinearGrid&#39;</span><span class="p">,</span><span class="s1">&#39;StructuredGrid&#39;</span><span class="p">)</span>
<a name="ln-1222"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>     <span class="p">&amp;</span>
<a name="ln-1223"></a>                                                              <span class="s1">&#39;&lt;&#39;</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-1224"></a>                                                              <span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-1225"></a>                                                              <span class="s1">&#39; WholeExtent=&quot;&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1226"></a>                                                              <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1227"></a>                                                              <span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1228"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UnstructuredGrid&#39;</span><span class="p">)</span>
<a name="ln-1229"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&gt;&#39;</span>
<a name="ln-1230"></a>    <span class="n">endselect</span>
<a name="ln-1231"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1232"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;BINARY&#39;</span><span class="p">)</span>
<a name="ln-1233"></a>    <span class="n">f_out</span> <span class="o">=</span> <span class="n">f_out_binary</span>
<a name="ln-1234"></a>    <span class="k">open</span><span class="p">(</span><span class="n">unit</span>       <span class="o">=</span> <span class="n">Unit_VTK</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1235"></a>         <span class="k">file</span>       <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1236"></a>         <span class="n">form</span>       <span class="o">=</span> <span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1237"></a>         <span class="nb">access</span>     <span class="o">=</span> <span class="s1">&#39;STREAM&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1238"></a>         <span class="n">action</span>     <span class="o">=</span> <span class="s1">&#39;WRITE&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1239"></a>         <span class="n">convert</span>    <span class="o">=</span> <span class="s1">&#39;BIG_ENDIAN&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1240"></a>         <span class="n">iostat</span>     <span class="o">=</span> <span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1241"></a>    <span class="c">! writing header of file</span>
<a name="ln-1242"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1243"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;VTKFile type=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; version=&quot;0.1&quot; byte_order=&quot;BigEndian&quot;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1244"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1245"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">))</span>
<a name="ln-1246"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;RectilinearGrid&#39;</span><span class="p">,</span><span class="s1">&#39;StructuredGrid&#39;</span><span class="p">)</span>
<a name="ln-1247"></a>      <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>     <span class="p">&amp;</span>
<a name="ln-1248"></a>                                                         <span class="s1">&#39;&lt;&#39;</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-1249"></a>                                                         <span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-1250"></a>                                                         <span class="s1">&#39; WholeExtent=&quot;&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1251"></a>                                                         <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1252"></a>                                                         <span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1253"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;UnstructuredGrid&#39;</span><span class="p">)</span>
<a name="ln-1254"></a>      <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&gt;&#39;</span>
<a name="ln-1255"></a>    <span class="n">endselect</span>
<a name="ln-1256"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1257"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1258"></a>    <span class="n">Unit_VTK_Append</span><span class="o">=</span><span class="n">GetUnit</span><span class="p">()</span>
<a name="ln-1259"></a>    <span class="c">! opening the SCRATCH file used for appending raw binary data</span>
<a name="ln-1260"></a>    <span class="k">open</span><span class="p">(</span><span class="n">unit</span>       <span class="o">=</span> <span class="n">Unit_VTK_Append</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1261"></a>         <span class="n">form</span>       <span class="o">=</span> <span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1262"></a>         <span class="nb">access</span>     <span class="o">=</span> <span class="s1">&#39;STREAM&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1263"></a>         <span class="n">action</span>     <span class="o">=</span> <span class="s1">&#39;READWRITE&#39;</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1264"></a>         <span class="n">convert</span>    <span class="o">=</span> <span class="s1">&#39;BIG_ENDIAN&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1265"></a>         <span class="n">status</span>     <span class="o">=</span> <span class="s1">&#39;SCRATCH&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1266"></a>         <span class="n">iostat</span>     <span class="o">=</span> <span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1267"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! initializing offset puntator</span>
<a name="ln-1268"></a>  <span class="n">endselect</span>
<a name="ln-1269"></a>  <span class="k">return</span>
<a name="ln-1270"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1271"></a>  <span class="n">endfunction</span> <span class="n">VTK_INI_XML</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>  <span class="c">!(doc)INCLUDE{/home/szaghi/VTK_IO/LIB_VTK_IO/source/DOC_VTK_GEO_XML.doc}</span>
<a name="ln-1274"></a>  <span class="c">!(\doc)skippedblock</span>
<a name="ln-1275"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_STRG_R8</span><span class="p">(</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1276"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1277"></a>  <span class="c">!! Function for saving mesh; topology = StructuredGrid (R8P).</span>
<a name="ln-1278"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1281"></a>  <span class="k">implicit none</span>
<a name="ln-1282"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span>  <span class="c">! initial and final nodes of x axis</span>
<a name="ln-1283"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span>  <span class="c">! initial and final nodes of y axis</span>
<a name="ln-1284"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span>  <span class="c">! initial and final nodes of z axis</span>
<a name="ln-1285"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>       <span class="c">! number of all nodes</span>
<a name="ln-1286"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! x coordinates</span>
<a name="ln-1287"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! y coordinates</span>
<a name="ln-1288"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! z coordinates</span>
<a name="ln-1289"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1290"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span> <span class="c">! buffer string</span>
<a name="ln-1291"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>       <span class="c">! counter</span>
<a name="ln-1292"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1295"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1296"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1297"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1298"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1299"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span>
<a name="ln-1300"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1301"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1302"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1303"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1304"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1305"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1306"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span>
<a name="ln-1307"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1308"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1309"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1310"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1311"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1312"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1313"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                                                        <span class="p">&amp;</span>
<a name="ln-1314"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1315"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                                                  <span class="p">&amp;</span>
<a name="ln-1316"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                                                      <span class="p">&amp;</span>
<a name="ln-1317"></a>                                    <span class="n">end_rec</span>
<a name="ln-1318"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-1319"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1320"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NN</span>
<a name="ln-1321"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1322"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1323"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1324"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1325"></a>  <span class="n">endselect</span>
<a name="ln-1326"></a>  <span class="k">return</span>
<a name="ln-1327"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1328"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_STRG_R8</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_STRG_R4</span><span class="p">(</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1331"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1332"></a>  <span class="c">!! Function for saving mesh; topology = StructuredGrid (R4P).</span>
<a name="ln-1333"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1334"></a>
<a name="ln-1335"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1336"></a>  <span class="k">implicit none</span>
<a name="ln-1337"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span>  <span class="c">! initial and final nodes of x axis</span>
<a name="ln-1338"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span>  <span class="c">! initial and final nodes of y axis</span>
<a name="ln-1339"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span>  <span class="c">! initial and final nodes of z axis</span>
<a name="ln-1340"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>       <span class="c">! number of all nodes</span>
<a name="ln-1341"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! x coordinates</span>
<a name="ln-1342"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! y coordinates</span>
<a name="ln-1343"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! z coordinates</span>
<a name="ln-1344"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1345"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span> <span class="c">! buffer string</span>
<a name="ln-1346"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>       <span class="c">! counter</span>
<a name="ln-1347"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1350"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1351"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1352"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1353"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1354"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span>
<a name="ln-1355"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1356"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1357"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1358"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1359"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1360"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1361"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span>
<a name="ln-1362"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1363"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1364"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1365"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1366"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1367"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1368"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                                                        <span class="p">&amp;</span>
<a name="ln-1369"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1370"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                                                  <span class="p">&amp;</span>
<a name="ln-1371"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                                                      <span class="p">&amp;</span>
<a name="ln-1372"></a>                                    <span class="n">end_rec</span>
<a name="ln-1373"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-1374"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1375"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NN</span>
<a name="ln-1376"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1377"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1378"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1379"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1380"></a>  <span class="n">endselect</span>
<a name="ln-1381"></a>  <span class="k">return</span>
<a name="ln-1382"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1383"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_STRG_R4</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_RECT_R8</span><span class="p">(</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1386"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1387"></a>  <span class="c">!! Function for saving mesh; topology = RectilinearGrid (R8P).</span>
<a name="ln-1388"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1391"></a>  <span class="k">implicit none</span>
<a name="ln-1392"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span>    <span class="c">! initial and final nodes of x axis</span>
<a name="ln-1393"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span>    <span class="c">! initial and final nodes of y axis</span>
<a name="ln-1394"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span>    <span class="c">! initial and final nodes of z axis</span>
<a name="ln-1395"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="n">nx1</span><span class="p">:</span><span class="n">nx2</span><span class="p">)</span> <span class="c">! x coordinates</span>
<a name="ln-1396"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="n">ny1</span><span class="p">:</span><span class="n">ny2</span><span class="p">)</span> <span class="c">! y coordinates</span>
<a name="ln-1397"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="n">nz1</span><span class="p">:</span><span class="n">nz2</span><span class="p">)</span> <span class="c">! z coordinates</span>
<a name="ln-1398"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>       <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1399"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>   <span class="c">! buffer string</span>
<a name="ln-1400"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>         <span class="c">! counter</span>
<a name="ln-1401"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1404"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1405"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1406"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1407"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1408"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Coordinates&gt;&#39;</span>
<a name="ln-1409"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1410"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;X&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1411"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">)</span>
<a name="ln-1412"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1413"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;Y&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1414"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">)</span>
<a name="ln-1415"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1416"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;Z&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1417"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">)</span>
<a name="ln-1418"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1419"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1420"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Coordinates&gt;&#39;</span>
<a name="ln-1421"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1422"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1423"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1424"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1425"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Coordinates&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1426"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1427"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                             <span class="p">&amp;</span>
<a name="ln-1428"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;X&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1429"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                       <span class="p">&amp;</span>
<a name="ln-1430"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                           <span class="p">&amp;</span>
<a name="ln-1431"></a>                                    <span class="n">end_rec</span>
<a name="ln-1432"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="p">(</span><span class="n">nx2</span><span class="o">-</span><span class="n">nx1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-1433"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1434"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="n">nx2</span><span class="o">-</span><span class="n">nx1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1435"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">)</span>
<a name="ln-1436"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1437"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1438"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;Y&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1439"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                       <span class="p">&amp;</span>
<a name="ln-1440"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                           <span class="p">&amp;</span>
<a name="ln-1441"></a>                                    <span class="n">end_rec</span>
<a name="ln-1442"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="p">(</span><span class="n">ny2</span><span class="o">-</span><span class="n">ny1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-1443"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1444"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="n">ny2</span><span class="o">-</span><span class="n">ny1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1445"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">)</span>
<a name="ln-1446"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1447"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                             <span class="p">&amp;</span>
<a name="ln-1448"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;Z&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1449"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                       <span class="p">&amp;</span>
<a name="ln-1450"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                           <span class="p">&amp;</span>
<a name="ln-1451"></a>                                    <span class="n">end_rec</span>
<a name="ln-1452"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="p">(</span><span class="n">nz2</span><span class="o">-</span><span class="n">nz1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-1453"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1454"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="n">nz2</span><span class="o">-</span><span class="n">nz1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1455"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">)</span>
<a name="ln-1456"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1457"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1458"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Coordinates&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1459"></a>  <span class="n">endselect</span>
<a name="ln-1460"></a>  <span class="k">return</span>
<a name="ln-1461"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1462"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_RECT_R8</span>
<a name="ln-1463"></a>
<a name="ln-1464"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_RECT_R4</span><span class="p">(</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1465"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1466"></a>  <span class="c">!! Function for saving mesh; topology = RectilinearGrid (R4P).</span>
<a name="ln-1467"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1470"></a>  <span class="k">implicit none</span>
<a name="ln-1471"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span>    <span class="c">! initial and final nodes of x axis</span>
<a name="ln-1472"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span>    <span class="c">! initial and final nodes of y axis</span>
<a name="ln-1473"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span>    <span class="c">! initial and final nodes of z axis</span>
<a name="ln-1474"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="n">nx1</span><span class="p">:</span><span class="n">nx2</span><span class="p">)</span> <span class="c">! x coordinates</span>
<a name="ln-1475"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="n">ny1</span><span class="p">:</span><span class="n">ny2</span><span class="p">)</span> <span class="c">! y coordinates</span>
<a name="ln-1476"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="n">nz1</span><span class="p">:</span><span class="n">nz2</span><span class="p">)</span> <span class="c">! z coordinates</span>
<a name="ln-1477"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>       <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1478"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span>   <span class="c">! buffer string</span>
<a name="ln-1479"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>         <span class="c">! counter</span>
<a name="ln-1480"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1483"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1484"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1485"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1486"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1487"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Coordinates&gt;&#39;</span>
<a name="ln-1488"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1489"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;X&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1490"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">)</span>
<a name="ln-1491"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1492"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;Y&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1493"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">)</span>
<a name="ln-1494"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1495"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;Z&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1496"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">)</span>
<a name="ln-1497"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1498"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1499"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Coordinates&gt;&#39;</span>
<a name="ln-1500"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1501"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,6&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Piece Extent=&quot;&#39;</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">,</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">,</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1502"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1503"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1504"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Coordinates&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1505"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1506"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                             <span class="p">&amp;</span>
<a name="ln-1507"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;X&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1508"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                       <span class="p">&amp;</span>
<a name="ln-1509"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                           <span class="p">&amp;</span>
<a name="ln-1510"></a>                                    <span class="n">end_rec</span>
<a name="ln-1511"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="p">(</span><span class="n">nx2</span><span class="o">-</span><span class="n">nx1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-1512"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1513"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="n">nx2</span><span class="o">-</span><span class="n">nx1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1514"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nx1</span><span class="p">,</span><span class="n">nx2</span><span class="p">)</span>
<a name="ln-1515"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1516"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                             <span class="p">&amp;</span>
<a name="ln-1517"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;Y&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1518"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                       <span class="p">&amp;</span>
<a name="ln-1519"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                           <span class="p">&amp;</span>
<a name="ln-1520"></a>                                    <span class="n">end_rec</span>
<a name="ln-1521"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="p">(</span><span class="n">ny2</span><span class="o">-</span><span class="n">ny1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-1522"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1523"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="n">ny2</span><span class="o">-</span><span class="n">ny1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1524"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">ny1</span><span class="p">,</span><span class="n">ny2</span><span class="p">)</span>
<a name="ln-1525"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1526"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                             <span class="p">&amp;</span>
<a name="ln-1527"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;Z&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1528"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                       <span class="p">&amp;</span>
<a name="ln-1529"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                           <span class="p">&amp;</span>
<a name="ln-1530"></a>                                    <span class="n">end_rec</span>
<a name="ln-1531"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="p">(</span><span class="n">nz2</span><span class="o">-</span><span class="n">nz1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-1532"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1533"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="n">nz2</span><span class="o">-</span><span class="n">nz1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1534"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="n">nz1</span><span class="p">,</span><span class="n">nz2</span><span class="p">)</span>
<a name="ln-1535"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1536"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1537"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Coordinates&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1538"></a>  <span class="n">endselect</span>
<a name="ln-1539"></a>  <span class="k">return</span>
<a name="ln-1540"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1541"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_RECT_R4</span>
<a name="ln-1542"></a>
<a name="ln-1543"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_UNST_R8</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">NC</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1544"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1545"></a>  <span class="c">!! Function for saving mesh; topology = UnstructuredGrid (R8P).</span>
<a name="ln-1546"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1547"></a>
<a name="ln-1548"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1549"></a>  <span class="k">implicit none</span>
<a name="ln-1550"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>       <span class="c">! number of nodes</span>
<a name="ln-1551"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC</span>       <span class="c">! number of cells</span>
<a name="ln-1552"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! x coordinates</span>
<a name="ln-1553"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! y coordinates</span>
<a name="ln-1554"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! z coordinates</span>
<a name="ln-1555"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1556"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span> <span class="c">! buffer string</span>
<a name="ln-1557"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>       <span class="c">! counter</span>
<a name="ln-1558"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1559"></a>
<a name="ln-1560"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1561"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1562"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1563"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>       <span class="p">&amp;</span>
<a name="ln-1564"></a>                                                                        <span class="s1">&#39;&lt;Piece NumberOfPoints=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1565"></a>                                                                        <span class="n">NN</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1566"></a>                                                                        <span class="s1">&#39;&quot; NumberOfCells=&quot;&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1567"></a>                                                                        <span class="n">NC</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1568"></a>                                                                        <span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1569"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1570"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span>
<a name="ln-1571"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1572"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1573"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1574"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1575"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1576"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1577"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span>
<a name="ln-1578"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1579"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>       <span class="p">&amp;</span>
<a name="ln-1580"></a>                                                                   <span class="s1">&#39;&lt;Piece NumberOfPoints=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1581"></a>                                                                   <span class="n">NN</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1582"></a>                                                                   <span class="s1">&#39;&quot; NumberOfCells=&quot;&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1583"></a>                                                                   <span class="n">NC</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1584"></a>                                                                   <span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1585"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1586"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1587"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1588"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1589"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1590"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1591"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                                                  <span class="p">&amp;</span>
<a name="ln-1592"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                                                      <span class="p">&amp;</span>
<a name="ln-1593"></a>                                    <span class="n">end_rec</span>
<a name="ln-1594"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-1595"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1596"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NN</span>
<a name="ln-1597"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1598"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1599"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1600"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1601"></a>  <span class="n">endselect</span>
<a name="ln-1602"></a>  <span class="k">return</span>
<a name="ln-1603"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1604"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_UNST_R8</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_UNST_R4</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">NC</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1607"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1608"></a>  <span class="c">!! Function for saving mesh; topology = UnstructuredGrid (R4P).</span>
<a name="ln-1609"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1610"></a>
<a name="ln-1611"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1612"></a>  <span class="k">implicit none</span>
<a name="ln-1613"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NN</span>       <span class="c">! number of nodes</span>
<a name="ln-1614"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC</span>       <span class="c">! number of cells</span>
<a name="ln-1615"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! x coordinates</span>
<a name="ln-1616"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! y coordinates</span>
<a name="ln-1617"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NN</span><span class="p">)</span>  <span class="c">! z coordinates</span>
<a name="ln-1618"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1619"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span><span class="kd">::</span>    <span class="n">s_buffer</span> <span class="c">! buffer string</span>
<a name="ln-1620"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>       <span class="c">! counter</span>
<a name="ln-1621"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1622"></a>
<a name="ln-1623"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1624"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1625"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1626"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>       <span class="p">&amp;</span>
<a name="ln-1627"></a>                                                                        <span class="s1">&#39;&lt;Piece NumberOfPoints=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1628"></a>                                                                        <span class="n">NN</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1629"></a>                                                                        <span class="s1">&#39;&quot; NumberOfCells=&quot;&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1630"></a>                                                                        <span class="n">NC</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1631"></a>                                                                        <span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1632"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1633"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span>
<a name="ln-1634"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1635"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1636"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1637"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1638"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1639"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1640"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span>
<a name="ln-1641"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1642"></a>    <span class="k">write</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A,&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>       <span class="p">&amp;</span>
<a name="ln-1643"></a>                                                                   <span class="s1">&#39;&lt;Piece NumberOfPoints=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1644"></a>                                                                   <span class="n">NN</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1645"></a>                                                                   <span class="s1">&#39;&quot; NumberOfCells=&quot;&#39;</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1646"></a>                                                                   <span class="n">NC</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1647"></a>                                                                   <span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-1648"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1649"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">s_buffer</span><span class="p">)</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1650"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1651"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1652"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                                                        <span class="p">&amp;</span>
<a name="ln-1653"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; NumberOfComponents=&quot;3&quot; Name=&quot;Point&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1654"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                                                  <span class="p">&amp;</span>
<a name="ln-1655"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                                                      <span class="p">&amp;</span>
<a name="ln-1656"></a>                                    <span class="n">end_rec</span>
<a name="ln-1657"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-1658"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1659"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NN</span>
<a name="ln-1660"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">X</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
<a name="ln-1661"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1662"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1663"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Points&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1664"></a>  <span class="n">endselect</span>
<a name="ln-1665"></a>  <span class="k">return</span>
<a name="ln-1666"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1667"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_UNST_R4</span>
<a name="ln-1668"></a>
<a name="ln-1669"></a>  <span class="k">function </span><span class="n">VTK_GEO_XML_CLOSEP</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1670"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1671"></a>  <span class="c">!! Function for closing mesh block data.</span>
<a name="ln-1672"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1673"></a>
<a name="ln-1674"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1675"></a>  <span class="k">implicit none</span>
<a name="ln-1676"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span> <span class="n">E_IO</span> <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1677"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1680"></a>  <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1681"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1682"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1683"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Piece&gt;&#39;</span>
<a name="ln-1684"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1685"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Piece&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1686"></a>  <span class="n">endselect</span>
<a name="ln-1687"></a>  <span class="k">return</span>
<a name="ln-1688"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1689"></a>  <span class="n">endfunction</span> <span class="n">VTK_GEO_XML_CLOSEP</span>
<a name="ln-1690"></a>  <span class="c">!(doc/)skippedblock</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>  <span class="k">function </span><span class="n">VTK_CON_XML</span><span class="p">(</span><span class="n">NC</span><span class="p">,</span><span class="n">connect</span><span class="p">,</span><span class="n">offset</span><span class="p">,</span><span class="n">cell_type</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1693"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1694"></a>  <span class="c">!!This function \MaiuscolettoBS{must} be used when unstructured grid is used. It saves the connectivity of the unstructured mesh.</span>
<a name="ln-1695"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1696"></a>
<a name="ln-1697"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1698"></a>  <span class="k">implicit none</span>
<a name="ln-1699"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC</span>              <span class="c">! number of cells</span>
<a name="ln-1700"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">connect</span><span class="p">(:)</span>      <span class="c">! mesh connectivity</span>
<a name="ln-1701"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">offset</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC</span><span class="p">)</span>    <span class="c">! cell offset</span>
<a name="ln-1702"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">cell_type</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC</span><span class="p">)</span> <span class="c">! VTK cell type</span>
<a name="ln-1703"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>            <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1704"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>              <span class="c">! counter</span>
<a name="ln-1705"></a>  <span class="c">!!The VTK\_CON\_XML variables have the following meaning:</span>
<a name="ln-1706"></a>  <span class="c">!!</span>
<a name="ln-1707"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-1708"></a>  <span class="c">!! \item[{\color{RoyalBlue}NCelle}] indicates the number of all cells.</span>
<a name="ln-1709"></a>  <span class="c">!! \item[{\color{RoyalBlue}connect}] contains the connectivity of the mesh. It is a vector.</span>
<a name="ln-1710"></a>  <span class="c">!! \item[{\color{RoyalBlue}offset}] contains the offset\footnote{The summ of nodes of all previous cells included the</span>
<a name="ln-1711"></a>  <span class="c">!!                                  current cell.} of every cells. It is a vector of $[1:NCelle]$.</span>
<a name="ln-1712"></a>  <span class="c">!! \item[{\color{RoyalBlue}tipo}] contains the type of every cells. It is a vector of $[1:NCelle]$.</span>
<a name="ln-1713"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-1714"></a>  <span class="c">!!\end{description}</span>
<a name="ln-1715"></a>  <span class="c">!!</span>
<a name="ln-1716"></a>  <span class="c">!!The vector \MaiuscolettoBS{connect} must follow the VTK XML standard. It is passed as \MaiuscolettoBS{assumed-shape}</span>
<a name="ln-1717"></a>  <span class="c">!!array because its dimensions is related to the mesh dimensions in a complex way. Its dimensions can be calculated by</span>
<a name="ln-1718"></a>  <span class="c">!!the following equation:</span>
<a name="ln-1719"></a>  <span class="c">!!</span>
<a name="ln-1720"></a>  <span class="c">!!\begin{equation}</span>
<a name="ln-1721"></a>  <span class="c">!!dc = \sum\limits_{i = 1}^{NCelle} {nvertex_i }</span>
<a name="ln-1722"></a>  <span class="c">!!\label{eq:xml connectivity dimensions}</span>
<a name="ln-1723"></a>  <span class="c">!!\end{equation}</span>
<a name="ln-1724"></a>  <span class="c">!!</span>
<a name="ln-1725"></a>  <span class="c">!!\noindent where $dc$ is connectivity vector dimension and $nvertex_i$ is the number of vertices of $i^{th}$ cell.</span>
<a name="ln-1726"></a>  <span class="c">!!Note that this equation is different from the legacy one (eq. \ref{eq:connectivity dimensions}). The XML connectivity</span>
<a name="ln-1727"></a>  <span class="c">!!convention is quite different from the legacy standard. As an example considering the same mesh of section \ref{sec:VTKCON}:</span>
<a name="ln-1728"></a>  <span class="c">!!suppose we have a mesh composed by 2 cells, one hexahedron (8 vertices) and one pyramid with square basis (5 vertices);</span>
<a name="ln-1729"></a>  <span class="c">!!suppose that the basis of pyramid is constitute by a face of the hexahedron and so the two cells share 4 vertices. The</span>
<a name="ln-1730"></a>  <span class="c">!!equation \ref{eq:xml connectivity dimensions} gives $dc=8+5=13$; the connectivity vector for this mesh can be:</span>
<a name="ln-1731"></a>  <span class="c">!!</span>
<a name="ln-1732"></a>  <span class="c">!!\begin{boxred}{Connectivity vector example for VTK XML standard}</span>
<a name="ln-1733"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1734"></a>  <span class="c">!!! first cell</span>
<a name="ln-1735"></a>  <span class="c">!!connect(1)  = 0  =&gt; identification flag of 1° vertex of 1° cell</span>
<a name="ln-1736"></a>  <span class="c">!!connect(2)  = 1  =&gt; identification flag of 2° vertex of 1° cell</span>
<a name="ln-1737"></a>  <span class="c">!!connect(3)  = 2  =&gt; identification flag of 3° vertex of 1° cell</span>
<a name="ln-1738"></a>  <span class="c">!!connect(4)  = 3  =&gt; identification flag of 4° vertex of 1° cell</span>
<a name="ln-1739"></a>  <span class="c">!!connect(5)  = 4  =&gt; identification flag of 5° vertex of 1° cell</span>
<a name="ln-1740"></a>  <span class="c">!!connect(6)  = 5  =&gt; identification flag of 6° vertex of 1° cell</span>
<a name="ln-1741"></a>  <span class="c">!!connect(7)  = 6  =&gt; identification flag of 7° vertex of 1° cell</span>
<a name="ln-1742"></a>  <span class="c">!!connect(8)  = 7  =&gt; identification flag of 8° vertex of 1° cell</span>
<a name="ln-1743"></a>  <span class="c">!!! second cell</span>
<a name="ln-1744"></a>  <span class="c">!!connect(9)  = 0  =&gt; identification flag of 1° vertex of 2° cell</span>
<a name="ln-1745"></a>  <span class="c">!!connect(10) = 1  =&gt; identification flag of 2° vertex of 2° cell</span>
<a name="ln-1746"></a>  <span class="c">!!connect(11) = 2  =&gt; identification flag of 3° vertex of 2° cell</span>
<a name="ln-1747"></a>  <span class="c">!!connect(12) = 3  =&gt; identification flag of 4° vertex of 2° cell</span>
<a name="ln-1748"></a>  <span class="c">!!connect(13) = 8  =&gt; identification flag of 5° vertex of 2° cell</span>
<a name="ln-1749"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1750"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1751"></a>  <span class="c">!!</span>
<a name="ln-1752"></a>  <span class="c">!!Therefore this connectivity vector convention is more simple than the legacy convention, now we must create also the</span>
<a name="ln-1753"></a>  <span class="c">!!\MaiuscolettoBS{offset} vector that contains the data now missing in the \MaiuscolettoBS{connect} vector. The offset</span>
<a name="ln-1754"></a>  <span class="c">!!vector for this mesh can be:</span>
<a name="ln-1755"></a>  <span class="c">!!</span>
<a name="ln-1756"></a>  <span class="c">!!\begin{boxred}{Offset vector example for VTK XML standard}</span>
<a name="ln-1757"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1758"></a>  <span class="c">!!! first cell</span>
<a name="ln-1759"></a>  <span class="c">!!offset(1) = 8  =&gt; summ of nodes of 1° cell</span>
<a name="ln-1760"></a>  <span class="c">!!! second cell</span>
<a name="ln-1761"></a>  <span class="c">!!offset(2) = 13 =&gt; summ of nodes of 1° and 2° cells</span>
<a name="ln-1762"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1763"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1764"></a>  <span class="c">!!</span>
<a name="ln-1765"></a>  <span class="c">!!\noindent The value of every cell-offset can be calculated by the following equation:</span>
<a name="ln-1766"></a>  <span class="c">!!</span>
<a name="ln-1767"></a>  <span class="c">!!\begin{equation}</span>
<a name="ln-1768"></a>  <span class="c">!!offset_c = \sum\limits_{i = 1}^{c} {nvertex_i }</span>
<a name="ln-1769"></a>  <span class="c">!!\label{eq:xml offset vlue}</span>
<a name="ln-1770"></a>  <span class="c">!!\end{equation}</span>
<a name="ln-1771"></a>  <span class="c">!!</span>
<a name="ln-1772"></a>  <span class="c">!!\noindent where $offset_c$ is the value of $c^{th}$ cell and $nvertex_i$ is the number of vertices of $i^{th}$ cell.</span>
<a name="ln-1773"></a>  <span class="c">!!</span>
<a name="ln-1774"></a>  <span class="c">!!The function VTK\_CON\_XML does not calculate the connectivity and offset vectors: it writes the connectivity and offset</span>
<a name="ln-1775"></a>  <span class="c">!!vectors conforming the VTK XML standard, but does not calculate them. In the future release of \LIBVTKIO will be included</span>
<a name="ln-1776"></a>  <span class="c">!!a function to calculate the connectivity and offset vector.</span>
<a name="ln-1777"></a>  <span class="c">!!</span>
<a name="ln-1778"></a>  <span class="c">!!The vector variable \MaiuscolettoBS{tipo} must conform the VTK XML standard \footnote{See the file VTK-Standard at the</span>
<a name="ln-1779"></a>  <span class="c">!!Kitware homepage.} that is the same of the legacy standard presented previous (sec. \ref{sec:VTKCON}). It contains the</span>
<a name="ln-1780"></a>  <span class="c">!!\emph{type} of each cells. For the above example this vector is:</span>
<a name="ln-1781"></a>  <span class="c">!!</span>
<a name="ln-1782"></a>  <span class="c">!!\begin{boxred}{Cell-Type vector example for VTK legacy standard}</span>
<a name="ln-1783"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1784"></a>  <span class="c">!!tipo(1) = 12  =&gt; VTK hexahedron type of 1° cell</span>
<a name="ln-1785"></a>  <span class="c">!!tipo(2) = 14  =&gt; VTK pyramid type of 2° cell</span>
<a name="ln-1786"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1787"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1788"></a>  <span class="c">!!</span>
<a name="ln-1789"></a>  <span class="c">!!The following is an example of VTK\_CON\_XML calling:</span>
<a name="ln-1790"></a>  <span class="c">!!</span>
<a name="ln-1791"></a>  <span class="c">!!\begin{boxred}{VTK\_CON\_XML Calling}</span>
<a name="ln-1792"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1793"></a>  <span class="c">!!...</span>
<a name="ln-1794"></a>  <span class="c">!!integer(4), parameter:: NCelle=2</span>
<a name="ln-1795"></a>  <span class="c">!!integer(4), parameter:: Nvertex1=8</span>
<a name="ln-1796"></a>  <span class="c">!!integer(4), parameter:: Nvertex2=5</span>
<a name="ln-1797"></a>  <span class="c">!!integer(4), parameter:: dc=Nvertex1+Nvertex2</span>
<a name="ln-1798"></a>  <span class="c">!!integer(4)::            connect(1:dc)</span>
<a name="ln-1799"></a>  <span class="c">!!integer(4)::            offset(1:NCelle)</span>
<a name="ln-1800"></a>  <span class="c">!!integer(4)::            tipo(1:NCelle)</span>
<a name="ln-1801"></a>  <span class="c">!!...</span>
<a name="ln-1802"></a>  <span class="c">!!E_IO = VTK_CON_XML(NCelle,connect,offset,tipo)</span>
<a name="ln-1803"></a>  <span class="c">!!...</span>
<a name="ln-1804"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1805"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1806"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1809"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1810"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1811"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Cells&gt;&#39;</span>
<a name="ln-1812"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1813"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;connectivity&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1814"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">connect</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">connect</span><span class="p">))</span>
<a name="ln-1815"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1816"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;offsets&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1817"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI4P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">offset</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC</span><span class="p">)</span>
<a name="ln-1818"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1819"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;types&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1820"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI1P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">cell_type</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC</span><span class="p">)</span>
<a name="ln-1821"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1822"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1823"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Cells&gt;&#39;</span>
<a name="ln-1824"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1825"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Cells&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1826"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1827"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                                      <span class="p">&amp;</span>
<a name="ln-1828"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;connectivity&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1829"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                                <span class="p">&amp;</span>
<a name="ln-1830"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                                    <span class="p">&amp;</span>
<a name="ln-1831"></a>                                    <span class="n">end_rec</span>
<a name="ln-1832"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">connect</span><span class="p">)</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span>
<a name="ln-1833"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1834"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I4&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">connect</span><span class="p">)</span>
<a name="ln-1835"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">connect</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">connect</span><span class="p">))</span>
<a name="ln-1836"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1837"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-1838"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;offsets&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1839"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                           <span class="p">&amp;</span>
<a name="ln-1840"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                               <span class="p">&amp;</span>
<a name="ln-1841"></a>                                    <span class="n">end_rec</span>
<a name="ln-1842"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span>
<a name="ln-1843"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1844"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I4&#39;</span><span class="p">,</span><span class="n">NC</span>
<a name="ln-1845"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">offset</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC</span><span class="p">)</span>
<a name="ln-1846"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1847"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                              <span class="p">&amp;</span>
<a name="ln-1848"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;types&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1849"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                                        <span class="p">&amp;</span>
<a name="ln-1850"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                            <span class="p">&amp;</span>
<a name="ln-1851"></a>                                    <span class="n">end_rec</span>
<a name="ln-1852"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I1</span><span class="p">)</span>
<a name="ln-1853"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1854"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="n">NC</span>
<a name="ln-1855"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">cell_type</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC</span><span class="p">)</span>
<a name="ln-1856"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1857"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1858"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Cells&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1859"></a>  <span class="n">endselect</span>
<a name="ln-1860"></a>  <span class="k">return</span>
<a name="ln-1861"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1862"></a>  <span class="n">endfunction</span> <span class="n">VTK_CON_XML</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a>  <span class="k">function </span><span class="n">VTK_DAT_XML</span><span class="p">(</span><span class="n">var_location</span><span class="p">,</span><span class="n">var_block_action</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1865"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1866"></a>  <span class="c">!!This function \MaiuscolettoBS{must} be called before saving the data related to geometric mesh. This function initializes</span>
<a name="ln-1867"></a>  <span class="c">!!the saving of data variables indicating the \emph{type} of variables that will be saved.</span>
<a name="ln-1868"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1869"></a>
<a name="ln-1870"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1871"></a>  <span class="k">implicit none</span>
<a name="ln-1872"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var_location</span>     <span class="c">! location of saving variables: CELL for cell-centered, NODE for node-centered</span>
<a name="ln-1873"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var_block_action</span> <span class="c">! variables block action: OPEN or CLOSE block</span>
<a name="ln-1874"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>             <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1875"></a>  <span class="c">!!The VTK\_DAT\_XML variables have the following meaning:</span>
<a name="ln-1876"></a>  <span class="c">!!</span>
<a name="ln-1877"></a>  <span class="c">!!\begin{description}</span>
<a name="ln-1878"></a>  <span class="c">!!\item[{\color{RoyalBlue}var\_location}] contains the location-type of variables that will be saved after VTK\_DAT.</span>
<a name="ln-1879"></a>  <span class="c">!!It is a scalar and cab assume the following values:</span>
<a name="ln-1880"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-1881"></a>  <span class="c">!!  \item \emph{cell} (it is case insensitive) $\rightarrow$ variables will be cell-centered.</span>
<a name="ln-1882"></a>  <span class="c">!!  \item \emph{node} (it is case insensitive) $\rightarrow$ variables will be node-centered.</span>
<a name="ln-1883"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-1884"></a>  <span class="c">!! \item[{\color{RoyalBlue}var\_block\_action}] indicates if the block-data-variables is being opened or closed; it can</span>
<a name="ln-1885"></a>  <span class="c">!!                                              assume the following values:</span>
<a name="ln-1886"></a>  <span class="c">!! \begin{enumerateABlu}</span>
<a name="ln-1887"></a>  <span class="c">!!  \item \emph{open}  (it is case insensitive) $\rightarrow$ block-data is being opened.</span>
<a name="ln-1888"></a>  <span class="c">!!  \item \emph{close} (it is case insensitive) $\rightarrow$ block-data is being closed.</span>
<a name="ln-1889"></a>  <span class="c">!! \end{enumerateABlu}</span>
<a name="ln-1890"></a>  <span class="c">!! \item[{\color{RoyalBlue}E\_IO}] contains the inquiring integer flag for error handling.</span>
<a name="ln-1891"></a>  <span class="c">!!\end{description}</span>
<a name="ln-1892"></a>  <span class="c">!!</span>
<a name="ln-1893"></a>  <span class="c">!!Of course a single file can contain both cell and node centered variables. The \MaiuscolettoBS{VTK\_DAT\_XML} must be</span>
<a name="ln-1894"></a>  <span class="c">!!called two times, before saving a block-data-variables in order to open the block, and after the block-data-variables</span>
<a name="ln-1895"></a>  <span class="c">!!has been saved in order to close the block. XML file can contains as many blocks as you want.</span>
<a name="ln-1896"></a>  <span class="c">!!</span>
<a name="ln-1897"></a>  <span class="c">!!The following is an example of VTK\_DAT\_XML calling:</span>
<a name="ln-1898"></a>  <span class="c">!!</span>
<a name="ln-1899"></a>  <span class="c">!!\begin{boxred}{VTK\_DAT\_XML Calling}</span>
<a name="ln-1900"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-1901"></a>  <span class="c">!!...</span>
<a name="ln-1902"></a>  <span class="c">!!E_IO = VTK_DAT_XML(&#39;node&#39;,&#39;OPEN&#39;)</span>
<a name="ln-1903"></a>  <span class="c">!!...</span>
<a name="ln-1904"></a>  <span class="c">!!SAVE YOUR DATA WITH VTK_VAR_XML</span>
<a name="ln-1905"></a>  <span class="c">!!...</span>
<a name="ln-1906"></a>  <span class="c">!!E_IO = VTK_DAT_XML(&#39;node&#39;,&#39;CLOSE&#39;)</span>
<a name="ln-1907"></a>  <span class="c">!!...</span>
<a name="ln-1908"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-1909"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-1910"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1911"></a>
<a name="ln-1912"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1913"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1914"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1915"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_location</span><span class="p">)))</span>
<a name="ln-1916"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CELL&#39;</span><span class="p">)</span>
<a name="ln-1917"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_block_action</span><span class="p">)))</span>
<a name="ln-1918"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;OPEN&#39;</span><span class="p">)</span>
<a name="ln-1919"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;CellData&gt;&#39;</span>
<a name="ln-1920"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1921"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CLOSE&#39;</span><span class="p">)</span>
<a name="ln-1922"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1923"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/CellData&gt;&#39;</span>
<a name="ln-1924"></a>      <span class="n">endselect</span>
<a name="ln-1925"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;NODE&#39;</span><span class="p">)</span>
<a name="ln-1926"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_block_action</span><span class="p">)))</span>
<a name="ln-1927"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;OPEN&#39;</span><span class="p">)</span>
<a name="ln-1928"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;PointData&gt;&#39;</span>
<a name="ln-1929"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1930"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CLOSE&#39;</span><span class="p">)</span>
<a name="ln-1931"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1932"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/PointData&gt;&#39;</span>
<a name="ln-1933"></a>      <span class="n">endselect</span>
<a name="ln-1934"></a>    <span class="n">endselect</span>
<a name="ln-1935"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1936"></a>    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_location</span><span class="p">)))</span>
<a name="ln-1937"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CELL&#39;</span><span class="p">)</span>
<a name="ln-1938"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_block_action</span><span class="p">)))</span>
<a name="ln-1939"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;OPEN&#39;</span><span class="p">)</span>
<a name="ln-1940"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;CellData&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1941"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1942"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CLOSE&#39;</span><span class="p">)</span>
<a name="ln-1943"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1944"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/CellData&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1945"></a>      <span class="n">endselect</span>
<a name="ln-1946"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;NODE&#39;</span><span class="p">)</span>
<a name="ln-1947"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">var_block_action</span><span class="p">)))</span>
<a name="ln-1948"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;OPEN&#39;</span><span class="p">)</span>
<a name="ln-1949"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;PointData&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1950"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1951"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CLOSE&#39;</span><span class="p">)</span>
<a name="ln-1952"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-1953"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/PointData&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1954"></a>      <span class="n">endselect</span>
<a name="ln-1955"></a>    <span class="n">endselect</span>
<a name="ln-1956"></a>  <span class="n">endselect</span>
<a name="ln-1957"></a>  <span class="k">return</span>
<a name="ln-1958"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1959"></a>  <span class="n">endfunction</span> <span class="n">VTK_DAT_XML</span>
<a name="ln-1960"></a>
<a name="ln-1961"></a>  <span class="c">!(doc)INCLUDE{/home/szaghi/VTK_IO/LIB_VTK_IO/source/DOC_VTK_VAR_XML.doc}</span>
<a name="ln-1962"></a>  <span class="c">!(\doc)skippedblock</span>
<a name="ln-1963"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_SCAL_R8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-1964"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1965"></a>  <span class="c">!! Function for saving scalar variable (R8P).</span>
<a name="ln-1966"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1967"></a>
<a name="ln-1968"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1969"></a>  <span class="k">implicit none</span>
<a name="ln-1970"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes</span>
<a name="ln-1971"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-1972"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-1973"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-1974"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>           <span class="c">! counter</span>
<a name="ln-1975"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1978"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-1979"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-1980"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-1981"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1982"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-1983"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-1984"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR8P</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1985"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-1986"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-1987"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-1988"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;&#39;</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-1989"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-1990"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1991"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-1992"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-1993"></a>                                    <span class="n">end_rec</span>
<a name="ln-1994"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-1995"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-1996"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-1997"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-1998"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-1999"></a>  <span class="n">endselect</span>
<a name="ln-2000"></a>  <span class="k">return</span>
<a name="ln-2001"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2002"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_SCAL_R8</span>
<a name="ln-2003"></a>
<a name="ln-2004"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_SCAL_R4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2005"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2006"></a>  <span class="c">!! Function for saving scalar variable (R4P).</span>
<a name="ln-2007"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2010"></a>  <span class="k">implicit none</span>
<a name="ln-2011"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes</span>
<a name="ln-2012"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-2013"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-2014"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2015"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>           <span class="c">! counter</span>
<a name="ln-2016"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2017"></a>
<a name="ln-2018"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2019"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2020"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2021"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2022"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2023"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2024"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2025"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FR4P</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-2026"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2027"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2028"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2029"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;&#39;</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2030"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2031"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2032"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2033"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2034"></a>                                    <span class="n">end_rec</span>
<a name="ln-2035"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-2036"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2037"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2038"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2039"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2040"></a>  <span class="n">endselect</span>
<a name="ln-2041"></a>  <span class="k">return</span>
<a name="ln-2042"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2043"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_SCAL_R4</span>
<a name="ln-2044"></a>
<a name="ln-2045"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_SCAL_I8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2046"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2047"></a>  <span class="c">!! Function for saving scalar variable (I8P).</span>
<a name="ln-2048"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2049"></a>
<a name="ln-2050"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2051"></a>  <span class="k">implicit none</span>
<a name="ln-2052"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes</span>
<a name="ln-2053"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-2054"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-2055"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2056"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>           <span class="c">! counter</span>
<a name="ln-2057"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2058"></a>
<a name="ln-2059"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2060"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2061"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2062"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2063"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2064"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2065"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2066"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI8P</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-2067"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2068"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2069"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2070"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int64&quot; Name=&quot;&#39;</span><span class="o">//</span>                     <span class="p">&amp;</span>
<a name="ln-2071"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2072"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2073"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2074"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2075"></a>                                    <span class="n">end_rec</span>
<a name="ln-2076"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I8</span><span class="p">)</span>
<a name="ln-2077"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2078"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I8&#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2079"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2080"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2081"></a>  <span class="n">endselect</span>
<a name="ln-2082"></a>  <span class="k">return</span>
<a name="ln-2083"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2084"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_SCAL_I8</span>
<a name="ln-2085"></a>
<a name="ln-2086"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_SCAL_I4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2087"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2088"></a>  <span class="c">!! Function for saving scalar variable (I4P).</span>
<a name="ln-2089"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2092"></a>  <span class="k">implicit none</span>
<a name="ln-2093"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes</span>
<a name="ln-2094"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-2095"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-2096"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2097"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>           <span class="c">! counter</span>
<a name="ln-2098"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2099"></a>
<a name="ln-2100"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2101"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2102"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2103"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2104"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2105"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2106"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2107"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI4P</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-2108"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2109"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2110"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2111"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;&#39;</span><span class="o">//</span>                     <span class="p">&amp;</span>
<a name="ln-2112"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2113"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2114"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2115"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2116"></a>                                    <span class="n">end_rec</span>
<a name="ln-2117"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span>
<a name="ln-2118"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2119"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I4&#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2120"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2121"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2122"></a>  <span class="n">endselect</span>
<a name="ln-2123"></a>  <span class="k">return</span>
<a name="ln-2124"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2125"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_SCAL_I4</span>
<a name="ln-2126"></a>
<a name="ln-2127"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_SCAL_I2</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2128"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2129"></a>  <span class="c">!! Function for saving scalar variable (I2P).</span>
<a name="ln-2130"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2133"></a>  <span class="k">implicit none</span>
<a name="ln-2134"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes</span>
<a name="ln-2135"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-2136"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-2137"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2138"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>           <span class="c">! counter</span>
<a name="ln-2139"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2140"></a>
<a name="ln-2141"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2142"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2143"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2144"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2145"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int16&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2146"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2147"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2148"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI2P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-2149"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2150"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2151"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2152"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int16&quot; Name=&quot;&#39;</span><span class="o">//</span>                     <span class="p">&amp;</span>
<a name="ln-2153"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2154"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2155"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2156"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2157"></a>                                    <span class="n">end_rec</span>
<a name="ln-2158"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I2</span><span class="p">)</span>
<a name="ln-2159"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2160"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2161"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2162"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2163"></a>  <span class="n">endselect</span>
<a name="ln-2164"></a>  <span class="k">return</span>
<a name="ln-2165"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2166"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_SCAL_I2</span>
<a name="ln-2167"></a>
<a name="ln-2168"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_SCAL_I1</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2169"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2170"></a>  <span class="c">!! Function for saving scalar variable (I1P).</span>
<a name="ln-2171"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2172"></a>
<a name="ln-2173"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2174"></a>  <span class="k">implicit none</span>
<a name="ln-2175"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>        <span class="c">! number of cells or nodes</span>
<a name="ln-2176"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>      <span class="c">! variable name</span>
<a name="ln-2177"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! variable to be saved</span>
<a name="ln-2178"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2179"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>           <span class="c">! counter</span>
<a name="ln-2180"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2183"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2184"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2185"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-2186"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2187"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2188"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2189"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">FI1P</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">var</span>
<a name="ln-2190"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2191"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2192"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2193"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;&#39;</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2194"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2195"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;1&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2196"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2197"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2198"></a>                                    <span class="n">end_rec</span>
<a name="ln-2199"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I1</span><span class="p">)</span>
<a name="ln-2200"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2201"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2202"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2203"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2204"></a>  <span class="n">endselect</span>
<a name="ln-2205"></a>  <span class="k">return</span>
<a name="ln-2206"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2207"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_SCAL_I1</span>
<a name="ln-2208"></a>
<a name="ln-2209"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_VECT_R8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2210"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2211"></a>  <span class="c">!! Function for saving vectorial variable (R8P).</span>
<a name="ln-2212"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2213"></a>
<a name="ln-2214"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2215"></a>  <span class="k">implicit none</span>
<a name="ln-2216"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of cells or nodes</span>
<a name="ln-2217"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-2218"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component</span>
<a name="ln-2219"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component</span>
<a name="ln-2220"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component</span>
<a name="ln-2221"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2222"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-2223"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2226"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2227"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2228"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2229"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2230"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2231"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2232"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2233"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2234"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2235"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2236"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;&#39;</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2237"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2238"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2239"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2240"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2241"></a>                                    <span class="n">end_rec</span>
<a name="ln-2242"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-2243"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2244"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2245"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2246"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2247"></a>  <span class="n">endselect</span>
<a name="ln-2248"></a>  <span class="k">return</span>
<a name="ln-2249"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2250"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_VECT_R8</span>
<a name="ln-2251"></a>
<a name="ln-2252"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_VECT_R4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2253"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2254"></a>  <span class="c">!! Function for saving vectorial variable (R4P).</span>
<a name="ln-2255"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2256"></a>
<a name="ln-2257"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2258"></a>  <span class="k">implicit none</span>
<a name="ln-2259"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of cells or nodes</span>
<a name="ln-2260"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-2261"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component</span>
<a name="ln-2262"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component</span>
<a name="ln-2263"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component</span>
<a name="ln-2264"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2265"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-2266"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2267"></a>
<a name="ln-2268"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2269"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2270"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2271"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2272"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2273"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2274"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2275"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2276"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2277"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2278"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2279"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;&#39;</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2280"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2281"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2282"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2283"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2284"></a>                                    <span class="n">end_rec</span>
<a name="ln-2285"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-2286"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2287"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2288"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2289"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2290"></a>  <span class="n">endselect</span>
<a name="ln-2291"></a>  <span class="k">return</span>
<a name="ln-2292"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2293"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_VECT_R4</span>
<a name="ln-2294"></a>
<a name="ln-2295"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_VECT_I8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2296"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2297"></a>  <span class="c">!! Function for saving vectorial variable (I8P).</span>
<a name="ln-2298"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2299"></a>
<a name="ln-2300"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2301"></a>  <span class="k">implicit none</span>
<a name="ln-2302"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of cells or nodes</span>
<a name="ln-2303"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-2304"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component</span>
<a name="ln-2305"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component</span>
<a name="ln-2306"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component</span>
<a name="ln-2307"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2308"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-2309"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2310"></a>
<a name="ln-2311"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2312"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2313"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2314"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2315"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2316"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2317"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2318"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FI8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2319"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2320"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2321"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2322"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int64&quot; Name=&quot;&#39;</span><span class="o">//</span>                     <span class="p">&amp;</span>
<a name="ln-2323"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2324"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2325"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2326"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2327"></a>                                    <span class="n">end_rec</span>
<a name="ln-2328"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I8</span><span class="p">)</span>
<a name="ln-2329"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2330"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I8&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2331"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2332"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2333"></a>  <span class="n">endselect</span>
<a name="ln-2334"></a>  <span class="k">return</span>
<a name="ln-2335"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2336"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_VECT_I8</span>
<a name="ln-2337"></a>
<a name="ln-2338"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_VECT_I4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2339"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2340"></a>  <span class="c">!! Function for saving vectorial variable (I4P).</span>
<a name="ln-2341"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2342"></a>
<a name="ln-2343"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2344"></a>  <span class="k">implicit none</span>
<a name="ln-2345"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of cells or nodes</span>
<a name="ln-2346"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-2347"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component</span>
<a name="ln-2348"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component</span>
<a name="ln-2349"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component</span>
<a name="ln-2350"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2351"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-2352"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2355"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2356"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2357"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2358"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2359"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2360"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2361"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2362"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2363"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2364"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2365"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;&#39;</span><span class="o">//</span>                     <span class="p">&amp;</span>
<a name="ln-2366"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2367"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2368"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2369"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2370"></a>                                    <span class="n">end_rec</span>
<a name="ln-2371"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span>
<a name="ln-2372"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2373"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I4&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2374"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2375"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2376"></a>  <span class="n">endselect</span>
<a name="ln-2377"></a>  <span class="k">return</span>
<a name="ln-2378"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2379"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_VECT_I4</span>
<a name="ln-2380"></a>
<a name="ln-2381"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_VECT_I2</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2382"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2383"></a>  <span class="c">!! Function for saving vectorial variable (I2P).</span>
<a name="ln-2384"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2385"></a>
<a name="ln-2386"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2387"></a>  <span class="k">implicit none</span>
<a name="ln-2388"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of cells or nodes</span>
<a name="ln-2389"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-2390"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component</span>
<a name="ln-2391"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component</span>
<a name="ln-2392"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component</span>
<a name="ln-2393"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2394"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-2395"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2396"></a>
<a name="ln-2397"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2398"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2399"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2400"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2401"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int16&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2402"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2403"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2404"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FI2P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2405"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2406"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2407"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2408"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int16&quot; Name=&quot;&#39;</span><span class="o">//</span>                     <span class="p">&amp;</span>
<a name="ln-2409"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2410"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2411"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2412"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2413"></a>                                    <span class="n">end_rec</span>
<a name="ln-2414"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I2</span><span class="p">)</span>
<a name="ln-2415"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2416"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2417"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2418"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2419"></a>  <span class="n">endselect</span>
<a name="ln-2420"></a>  <span class="k">return</span>
<a name="ln-2421"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2422"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_VECT_I2</span>
<a name="ln-2423"></a>
<a name="ln-2424"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_VECT_I1</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">varX</span><span class="p">,</span><span class="n">varY</span><span class="p">,</span><span class="n">varZ</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2425"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2426"></a>  <span class="c">!! Function for saving vectorial variable (I1P).</span>
<a name="ln-2427"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2430"></a>  <span class="k">implicit none</span>
<a name="ln-2431"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>         <span class="c">! number of cells or nodes</span>
<a name="ln-2432"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>       <span class="c">! variable name</span>
<a name="ln-2433"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varX</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! x component</span>
<a name="ln-2434"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varY</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! y component</span>
<a name="ln-2435"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varZ</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">)</span> <span class="c">! z component</span>
<a name="ln-2436"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>          <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2437"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span>            <span class="c">! counter</span>
<a name="ln-2438"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2439"></a>
<a name="ln-2440"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2441"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2442"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2443"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-2444"></a>                                              <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2445"></a>                                              <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2446"></a>                                              <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2447"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(3&#39;</span><span class="o">//</span><span class="n">FI1P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2448"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2449"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2450"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                                   <span class="p">&amp;</span>
<a name="ln-2451"></a>                                    <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;&#39;</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2452"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                                        <span class="p">&amp;</span>
<a name="ln-2453"></a>                                    <span class="s1">&#39;&quot; NumberOfComponents=&quot;3&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2454"></a>                                    <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>                             <span class="p">&amp;</span>
<a name="ln-2455"></a>                                    <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>                                                 <span class="p">&amp;</span>
<a name="ln-2456"></a>                                    <span class="n">end_rec</span>
<a name="ln-2457"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I1</span><span class="p">)</span>
<a name="ln-2458"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2459"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2460"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">varX</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varY</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">varZ</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span><span class="p">)</span>
<a name="ln-2461"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2462"></a>  <span class="n">endselect</span>
<a name="ln-2463"></a>  <span class="k">return</span>
<a name="ln-2464"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2465"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_VECT_I1</span>
<a name="ln-2466"></a>
<a name="ln-2467"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_LIST_R8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">N_COL</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2468"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2469"></a>  <span class="c">!! Function for saving list variable (R8P).</span>
<a name="ln-2470"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2471"></a>
<a name="ln-2472"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2473"></a>  <span class="k">implicit none</span>
<a name="ln-2474"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                <span class="c">! number of cells or nodes</span>
<a name="ln-2475"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">N_COL</span>                <span class="c">! number of columns</span>
<a name="ln-2476"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>              <span class="c">! variable name</span>
<a name="ln-2477"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N_COL</span><span class="p">)</span> <span class="c">! components</span>
<a name="ln-2478"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2479"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                <span class="c">! counter</span>
<a name="ln-2480"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2481"></a>
<a name="ln-2482"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2483"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2484"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2485"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2486"></a>                                               <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2487"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2488"></a>                                               <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>           <span class="p">&amp;</span>
<a name="ln-2489"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>            <span class="p">&amp;</span>
<a name="ln-2490"></a>                                               <span class="s1">&#39;&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2491"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2492"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FR8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_COL</span><span class="p">)</span>
<a name="ln-2493"></a>    <span class="n">enddo</span>
<a name="ln-2494"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2495"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2496"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2497"></a>                                     <span class="s1">&#39;&lt;DataArray type=&quot;Float64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2498"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2499"></a>                                     <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>           <span class="p">&amp;</span>
<a name="ln-2500"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>            <span class="p">&amp;</span>
<a name="ln-2501"></a>                                     <span class="s1">&#39;&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-2502"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>     <span class="p">&amp;</span>
<a name="ln-2503"></a>                                     <span class="n">end_rec</span>
<a name="ln-2504"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R8</span><span class="p">)</span>
<a name="ln-2505"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2506"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2507"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2508"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,:)</span>
<a name="ln-2509"></a>    <span class="n">enddo</span>
<a name="ln-2510"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2511"></a>  <span class="n">endselect</span>
<a name="ln-2512"></a>  <span class="k">return</span>
<a name="ln-2513"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2514"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_LIST_R8</span>
<a name="ln-2515"></a>
<a name="ln-2516"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_LIST_R4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">N_COL</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2517"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2518"></a>  <span class="c">!! Function for saving list variable (R4P).</span>
<a name="ln-2519"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2520"></a>
<a name="ln-2521"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2522"></a>  <span class="k">implicit none</span>
<a name="ln-2523"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                <span class="c">! number of cells or nodes</span>
<a name="ln-2524"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">N_COL</span>                <span class="c">! number of columns</span>
<a name="ln-2525"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>              <span class="c">! variable name</span>
<a name="ln-2526"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N_COL</span><span class="p">)</span> <span class="c">! components</span>
<a name="ln-2527"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2528"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                <span class="c">! counter</span>
<a name="ln-2529"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2530"></a>
<a name="ln-2531"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2532"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2533"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2534"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2535"></a>                                               <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2536"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2537"></a>                                               <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>           <span class="p">&amp;</span>
<a name="ln-2538"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>            <span class="p">&amp;</span>
<a name="ln-2539"></a>                                               <span class="s1">&#39;&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2540"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2541"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FR4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_COL</span><span class="p">)</span>
<a name="ln-2542"></a>    <span class="n">enddo</span>
<a name="ln-2543"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2544"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2545"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-2546"></a>                                     <span class="s1">&#39;&lt;DataArray type=&quot;Float32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2547"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                      <span class="p">&amp;</span>
<a name="ln-2548"></a>                                     <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>           <span class="p">&amp;</span>
<a name="ln-2549"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>            <span class="p">&amp;</span>
<a name="ln-2550"></a>                                     <span class="s1">&#39;&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-2551"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span>     <span class="p">&amp;</span>
<a name="ln-2552"></a>                                     <span class="n">end_rec</span>
<a name="ln-2553"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_R4</span><span class="p">)</span>
<a name="ln-2554"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2555"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;R4&#39;</span><span class="p">,</span><span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2556"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2557"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,:)</span>
<a name="ln-2558"></a>    <span class="n">enddo</span>
<a name="ln-2559"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2560"></a>  <span class="n">endselect</span>
<a name="ln-2561"></a>  <span class="k">return</span>
<a name="ln-2562"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2563"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_LIST_R4</span>
<a name="ln-2564"></a>
<a name="ln-2565"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_LIST_I8</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">N_COL</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2566"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2567"></a>  <span class="c">!! Function for saving list variable (I8P).</span>
<a name="ln-2568"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2569"></a>
<a name="ln-2570"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2571"></a>  <span class="k">implicit none</span>
<a name="ln-2572"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                <span class="c">! number of cells or nodes</span>
<a name="ln-2573"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">N_COL</span>                <span class="c">! number of columns</span>
<a name="ln-2574"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>              <span class="c">! variable name</span>
<a name="ln-2575"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N_COL</span><span class="p">)</span> <span class="c">! components</span>
<a name="ln-2576"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2577"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                <span class="c">! counter</span>
<a name="ln-2578"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2581"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2582"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2583"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2584"></a>                                               <span class="s1">&#39;&lt;DataArray type=&quot;Int64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2585"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2586"></a>                                               <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2587"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2588"></a>                                               <span class="s1">&#39;&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2589"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2590"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FI8P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_COL</span><span class="p">)</span>
<a name="ln-2591"></a>    <span class="n">enddo</span>
<a name="ln-2592"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2593"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2594"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2595"></a>                                     <span class="s1">&#39;&lt;DataArray type=&quot;Int64&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2596"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2597"></a>                                     <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2598"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2599"></a>                                     <span class="s1">&#39;&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2600"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>         <span class="p">&amp;</span>
<a name="ln-2601"></a>                                     <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2602"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I8</span><span class="p">)</span>
<a name="ln-2603"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2604"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I8&#39;</span><span class="p">,</span><span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2605"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2606"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,:)</span>
<a name="ln-2607"></a>    <span class="n">enddo</span>
<a name="ln-2608"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2609"></a>  <span class="n">endselect</span>
<a name="ln-2610"></a>  <span class="k">return</span>
<a name="ln-2611"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2612"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_LIST_I8</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_LIST_I4</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">N_COL</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2615"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2616"></a>  <span class="c">!! Function for saving list variable (I4P).</span>
<a name="ln-2617"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2618"></a>
<a name="ln-2619"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2620"></a>  <span class="k">implicit none</span>
<a name="ln-2621"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                <span class="c">! number of cells or nodes</span>
<a name="ln-2622"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">N_COL</span>                <span class="c">! number of columns</span>
<a name="ln-2623"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>              <span class="c">! variable name</span>
<a name="ln-2624"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N_COL</span><span class="p">)</span> <span class="c">! components</span>
<a name="ln-2625"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2626"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                <span class="c">! counter</span>
<a name="ln-2627"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2630"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2631"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2632"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2633"></a>                                               <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2634"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2635"></a>                                               <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2636"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2637"></a>                                               <span class="s1">&#39;&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2638"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2639"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FI4P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_COL</span><span class="p">)</span>
<a name="ln-2640"></a>    <span class="n">enddo</span>
<a name="ln-2641"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2642"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2643"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2644"></a>                                     <span class="s1">&#39;&lt;DataArray type=&quot;Int32&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2645"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2646"></a>                                     <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2647"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2648"></a>                                     <span class="s1">&#39;&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2649"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>         <span class="p">&amp;</span>
<a name="ln-2650"></a>                                     <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2651"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span>
<a name="ln-2652"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2653"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I4&#39;</span><span class="p">,</span><span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2654"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2655"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,:)</span>
<a name="ln-2656"></a>    <span class="n">enddo</span>
<a name="ln-2657"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2658"></a>  <span class="n">endselect</span>
<a name="ln-2659"></a>  <span class="k">return</span>
<a name="ln-2660"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2661"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_LIST_I4</span>
<a name="ln-2662"></a>
<a name="ln-2663"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_LIST_I2</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">N_COL</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2664"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2665"></a>  <span class="c">!! Function for saving list variable (I2P).</span>
<a name="ln-2666"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2667"></a>  <span class="k">implicit none</span>
<a name="ln-2668"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2669"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">NC_NN</span>                <span class="c">! number of cells or nodes</span>
<a name="ln-2670"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">N_COL</span>                <span class="c">! number of columns</span>
<a name="ln-2671"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">varname</span>              <span class="c">! variable name</span>
<a name="ln-2672"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N_COL</span><span class="p">)</span> <span class="c">! components</span>
<a name="ln-2673"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2674"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                <span class="c">! counter</span>
<a name="ln-2675"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2676"></a>
<a name="ln-2677"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2678"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2679"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2680"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2681"></a>                                               <span class="s1">&#39;&lt;DataArray type=&quot;Int16&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2682"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2683"></a>                                               <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2684"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2685"></a>                                               <span class="s1">&#39;&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2686"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2687"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FI2P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_COL</span><span class="p">)</span>
<a name="ln-2688"></a>    <span class="n">enddo</span>
<a name="ln-2689"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2690"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2691"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>               <span class="p">&amp;</span>
<a name="ln-2692"></a>                                     <span class="s1">&#39;&lt;DataArray type=&quot;Int16&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2693"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                    <span class="p">&amp;</span>
<a name="ln-2694"></a>                                     <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2695"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2696"></a>                                     <span class="s1">&#39;&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2697"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>         <span class="p">&amp;</span>
<a name="ln-2698"></a>                                     <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2699"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I2</span><span class="p">)</span>
<a name="ln-2700"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2701"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span><span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2702"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2703"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,:)</span>
<a name="ln-2704"></a>    <span class="n">enddo</span>
<a name="ln-2705"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2706"></a>  <span class="n">endselect</span>
<a name="ln-2707"></a>  <span class="k">return</span>
<a name="ln-2708"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2709"></a>  <span class="n">endfunction</span>
<a name="ln-2710"></a>
<a name="ln-2711"></a>  <span class="k">function </span><span class="n">VTK_VAR_XML_LIST_I1</span><span class="p">(</span><span class="n">NC_NN</span><span class="p">,</span><span class="n">N_COL</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">var</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2712"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2713"></a>  <span class="c">!! Function for saving list variable (I1P).</span>
<a name="ln-2714"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2715"></a>
<a name="ln-2716"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2717"></a>  <span class="k">implicit none</span>
<a name="ln-2718"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>  <span class="n">NC_NN</span>                <span class="c">! number of cells or nodes</span>
<a name="ln-2719"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>  <span class="n">N_COL</span>                <span class="c">! number of columns</span>
<a name="ln-2720"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>  <span class="n">varname</span>              <span class="c">! variable name</span>
<a name="ln-2721"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NC_NN</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N_COL</span><span class="p">)</span> <span class="c">! components</span>
<a name="ln-2722"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>              <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2723"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>              <span class="n">n1</span><span class="p">,</span><span class="n">n2</span>                <span class="c">! counter</span>
<a name="ln-2724"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2725"></a>
<a name="ln-2726"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2727"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2728"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2729"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-2730"></a>                                               <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2731"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2732"></a>                                               <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>        <span class="p">&amp;</span>
<a name="ln-2733"></a>                                               <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2734"></a>                                               <span class="s1">&#39;&quot; format=&quot;ascii&quot;&gt;&#39;</span>
<a name="ln-2735"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2736"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FI1P</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_COL</span><span class="p">)</span>
<a name="ln-2737"></a>    <span class="n">enddo</span>
<a name="ln-2738"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span>
<a name="ln-2739"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2740"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-2741"></a>                                     <span class="s1">&#39;&lt;DataArray type=&quot;Int8&quot; Name=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2742"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span><span class="o">//</span>                   <span class="p">&amp;</span>
<a name="ln-2743"></a>                                     <span class="s1">&#39;&quot; NumberOfComponents=&quot;&#39;</span><span class="o">//</span>        <span class="p">&amp;</span>
<a name="ln-2744"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">N_COL</span><span class="p">))</span><span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-2745"></a>                                     <span class="s1">&#39;&quot; format=&quot;appended&quot; offset=&quot;&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2746"></a>                                     <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">ioffset</span><span class="p">)),</span>        <span class="p">&amp;</span>
<a name="ln-2747"></a>                                     <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2748"></a>    <span class="n">N_Byte</span>  <span class="o">=</span> <span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I1</span><span class="p">)</span>
<a name="ln-2749"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Tipo_I4</span><span class="p">)</span> <span class="o">+</span> <span class="n">N_Byte</span>
<a name="ln-2750"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="n">N_COL</span><span class="o">*</span><span class="n">NC_NN</span>
<a name="ln-2751"></a>    <span class="k">do </span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC_NN</span>
<a name="ln-2752"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="n">var</span><span class="p">(</span><span class="n">n1</span><span class="p">,:)</span>
<a name="ln-2753"></a>    <span class="n">enddo</span>
<a name="ln-2754"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/DataArray&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2755"></a>  <span class="n">endselect</span>
<a name="ln-2756"></a>  <span class="k">return</span>
<a name="ln-2757"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2758"></a>  <span class="n">endfunction</span> <span class="n">VTK_VAR_XML_LIST_I1</span>
<a name="ln-2759"></a><span class="c">!(doc/)skippedblock</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a>  <span class="k">function </span><span class="n">VTK_END_XML</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2762"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2763"></a>  <span class="c">!!This function is used to finalize the file opened. The \LIBVTKIO manages the file unit without the user&#39;s action.</span>
<a name="ln-2764"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2765"></a>
<a name="ln-2766"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2767"></a>  <span class="k">implicit none</span>
<a name="ln-2768"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>              <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2769"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="kd">::</span>              <span class="n">var_type</span>  <span class="c">! var\_type = R8,R4,I8,I4,I2,I1</span>
<a name="ln-2770"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>    <span class="k">allocatable</span><span class="kd">::</span> <span class="n">v_R8</span><span class="p">(:)</span>   <span class="c">! R8 vector for IO in AppendData</span>
<a name="ln-2771"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>    <span class="k">allocatable</span><span class="kd">::</span> <span class="n">v_R4</span><span class="p">(:)</span>   <span class="c">! R4 vector for IO in AppendData</span>
<a name="ln-2772"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">allocatable</span><span class="kd">::</span> <span class="n">v_I8</span><span class="p">(:)</span>   <span class="c">! I8 vector for IO in AppendData</span>
<a name="ln-2773"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">allocatable</span><span class="kd">::</span> <span class="n">v_I4</span><span class="p">(:)</span>   <span class="c">! I4 vector for IO in AppendData</span>
<a name="ln-2774"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span> <span class="k">allocatable</span><span class="kd">::</span> <span class="n">v_I2</span><span class="p">(:)</span>   <span class="c">! I2 vector for IO in AppendData</span>
<a name="ln-2775"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span> <span class="k">allocatable</span><span class="kd">::</span> <span class="n">v_I1</span><span class="p">(:)</span>   <span class="c">! I1 vector for IO in AppendData</span>
<a name="ln-2776"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>              <span class="n">N_v</span>       <span class="c">! vector dimension</span>
<a name="ln-2777"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>              <span class="n">n1</span>        <span class="c">! counter</span>
<a name="ln-2778"></a>  <span class="c">!!The following is an example of VTK\_END\_XML calling:</span>
<a name="ln-2779"></a>  <span class="c">!!</span>
<a name="ln-2780"></a>  <span class="c">!!\begin{boxred}{VTK\_END\_XML Calling}</span>
<a name="ln-2781"></a>  <span class="c">!!\begin{verbatim}</span>
<a name="ln-2782"></a>  <span class="c">!!...</span>
<a name="ln-2783"></a>  <span class="c">!!E_IO = VTK_END_XML()</span>
<a name="ln-2784"></a>  <span class="c">!!...</span>
<a name="ln-2785"></a>  <span class="c">!!\end{verbatim}</span>
<a name="ln-2786"></a>  <span class="c">!!\end{boxred}</span>
<a name="ln-2787"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2790"></a>  <span class="k">select case</span><span class="p">(</span><span class="n">f_out</span><span class="p">)</span>
<a name="ln-2791"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_ascii</span><span class="p">)</span>
<a name="ln-2792"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-2793"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&gt;&#39;</span>
<a name="ln-2794"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;/VTKFile&gt;&#39;</span>
<a name="ln-2795"></a>  <span class="k">case</span><span class="p">(</span><span class="n">f_out_binary</span><span class="p">)</span>
<a name="ln-2796"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-2797"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span>  <span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2798"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span>  <span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;AppendedData encoding=&quot;raw&quot;&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2799"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span>  <span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;_&#39;</span>
<a name="ln-2800"></a>    <span class="n">endfile</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2801"></a>    <span class="k">rewind</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2802"></a>    <span class="k">do</span>
<a name="ln-2803"></a><span class="k">      read</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">,</span><span class="k">end</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">N_v</span>
<a name="ln-2804"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span>
<a name="ln-2805"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;R8&#39;</span><span class="p">)</span>
<a name="ln-2806"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">v_R8</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N_v</span><span class="p">))</span>
<a name="ln-2807"></a>        <span class="k">read</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">v_R8</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2808"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,(</span><span class="n">v_R8</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2809"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">v_R8</span><span class="p">)</span>
<a name="ln-2810"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;R4&#39;</span><span class="p">)</span>
<a name="ln-2811"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">v_R4</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N_v</span><span class="p">))</span>
<a name="ln-2812"></a>        <span class="k">read</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">v_R4</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2813"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,(</span><span class="n">v_R4</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2814"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">v_R4</span><span class="p">)</span>
<a name="ln-2815"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;I8&#39;</span><span class="p">)</span>
<a name="ln-2816"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">v_I8</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N_v</span><span class="p">))</span>
<a name="ln-2817"></a>        <span class="k">read</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">v_I8</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2818"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,(</span><span class="n">v_I8</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2819"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">v_I8</span><span class="p">)</span>
<a name="ln-2820"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;I4&#39;</span><span class="p">)</span>
<a name="ln-2821"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">v_I4</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N_v</span><span class="p">))</span>
<a name="ln-2822"></a>        <span class="k">read</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">v_I4</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2823"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,(</span><span class="n">v_I4</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2824"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">v_I4</span><span class="p">)</span>
<a name="ln-2825"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;I2&#39;</span><span class="p">)</span>
<a name="ln-2826"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">v_I2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N_v</span><span class="p">))</span>
<a name="ln-2827"></a>        <span class="k">read</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">v_I2</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2828"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,(</span><span class="n">v_I2</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2829"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">v_I2</span><span class="p">)</span>
<a name="ln-2830"></a>      <span class="k">case</span><span class="p">(</span><span class="s1">&#39;I1&#39;</span><span class="p">)</span>
<a name="ln-2831"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">v_I1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N_v</span><span class="p">))</span>
<a name="ln-2832"></a>        <span class="k">read</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)(</span><span class="n">v_I1</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2833"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span>       <span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">N_Byte</span><span class="p">,(</span><span class="n">v_I1</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="n">n1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N_v</span><span class="p">)</span>
<a name="ln-2834"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">v_I1</span><span class="p">)</span>
<a name="ln-2835"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-2836"></a>        <span class="n">E_IO</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2837"></a>        <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(&#39; N_Byte =&#39;, I10, &#39; N_v =&#39;, I10)&quot;</span><span class="p">)</span> <span class="n">N_Byte</span><span class="p">,</span> <span class="n">N_v</span>
<a name="ln-2838"></a>        <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;(&#39; var1 =&#39;, I10, &#39; var2 =&#39;, I10)&quot;</span><span class="p">)</span> <span class="nb">ichar</span><span class="p">(</span><span class="n">var_type</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)),</span><span class="nb">ichar</span><span class="p">(</span><span class="n">var_type</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2839"></a>        <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;bad var_type&#39;</span>
<a name="ln-2840"></a>        <span class="k">return</span>
<a name="ln-2841"></a><span class="k">      </span><span class="n">endselect</span>
<a name="ln-2842"></a>    <span class="n">enddo</span>
<a name="ln-2843"></a>    <span class="mi">100</span> <span class="k">continue</span>
<a name="ln-2844"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="n">end_rec</span>
<a name="ln-2845"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/AppendedData&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2846"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;/VTKFile&gt;&#39;</span><span class="o">//</span><span class="n">end_rec</span>
<a name="ln-2847"></a>    <span class="c">! closing AppendData file</span>
<a name="ln-2848"></a>    <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK_Append</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2849"></a>  <span class="n">endselect</span>
<a name="ln-2850"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTK</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2851"></a>  <span class="k">return</span>
<a name="ln-2852"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2853"></a>  <span class="n">endfunction</span> <span class="n">VTK_END_XML</span>
<a name="ln-2854"></a>
<a name="ln-2855"></a>  <span class="c">! VTM wrapper</span>
<a name="ln-2856"></a>  <span class="k">function </span><span class="n">VTM_INI_XML</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2857"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2858"></a>  <span class="c">!!The VTK_VTM_XML function is used for initializing a VTM (VTK Multiblocks) XML file that is a wrapper to a set of VTK XML files.</span>
<a name="ln-2859"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2860"></a>
<a name="ln-2861"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2862"></a>  <span class="k">implicit none</span>
<a name="ln-2863"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">filename</span> <span class="c">! file name</span>
<a name="ln-2864"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>     <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2865"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2868"></a>  <span class="n">Unit_VTM</span><span class="o">=</span><span class="n">GetUnit</span><span class="p">()</span>
<a name="ln-2869"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span>   <span class="o">=</span> <span class="n">Unit_VTM</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-2870"></a>       <span class="k">file</span>   <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2871"></a>       <span class="n">form</span>   <span class="o">=</span> <span class="s1">&#39;FORMATTED&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2872"></a>       <span class="nb">access</span> <span class="o">=</span> <span class="s1">&#39;SEQUENTIAL&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2873"></a>       <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;WRITE&#39;</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-2874"></a>       <span class="n">iostat</span> <span class="o">=</span> <span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2875"></a>
<a name="ln-2876"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot;?&gt;&#39;</span>
<a name="ln-2877"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;VTKFile type=&quot;vtkMultiBlockDataSet&quot; version=&quot;1.0&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2878"></a>                                            <span class="s1">&#39; byte_order=&quot;BigEndian&quot; compressor=&quot;vtkZLibDataCompressor&quot;&gt;&#39;</span>
<a name="ln-2879"></a>  <span class="n">vtm_indent</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2880"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">vtm_indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;vtkMultiBlockDataSet&gt;&#39;</span>
<a name="ln-2881"></a>  <span class="n">vtm_indent</span> <span class="o">=</span> <span class="n">vtm_indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2882"></a>  <span class="n">blk</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2883"></a>  <span class="k">return</span>
<a name="ln-2884"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2885"></a>  <span class="n">endfunction</span> <span class="n">VTM_INI_XML</span>
<a name="ln-2886"></a>
<a name="ln-2887"></a>  <span class="k">function </span><span class="n">VTM_BLK_XML</span><span class="p">(</span><span class="n">block_action</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2888"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2889"></a>  <span class="c">!!The VTM_BLK_XML function is used for opening or closing a block level of a VTM file.</span>
<a name="ln-2890"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2891"></a>
<a name="ln-2892"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2893"></a>  <span class="k">implicit none</span>
<a name="ln-2894"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">block_action</span> <span class="c">! block action: OPEN or CLOSE block</span>
<a name="ln-2895"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>             <span class="n">E_IO</span>         <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2896"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2897"></a>
<a name="ln-2898"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2899"></a>  <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Upper_Case</span><span class="p">(</span><span class="n">block_action</span><span class="p">)))</span>
<a name="ln-2900"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;OPEN&#39;</span><span class="p">)</span>
<a name="ln-2901"></a>    <span class="n">blk</span> <span class="o">=</span> <span class="n">blk</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2902"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,I4.4,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">vtm_indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;Block index=&quot;&#39;</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="s1">&#39;&quot;&gt;&#39;</span>
<a name="ln-2903"></a>    <span class="n">vtm_indent</span> <span class="o">=</span> <span class="n">vtm_indent</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2904"></a>  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CLOSE&#39;</span><span class="p">)</span>
<a name="ln-2905"></a>    <span class="n">vtm_indent</span> <span class="o">=</span> <span class="n">vtm_indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-2906"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">vtm_indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/Block&gt;&#39;</span>
<a name="ln-2907"></a>  <span class="n">endselect</span>
<a name="ln-2908"></a>  <span class="k">return</span>
<a name="ln-2909"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2910"></a>  <span class="n">endfunction</span> <span class="n">VTM_BLK_XML</span>
<a name="ln-2911"></a>
<a name="ln-2912"></a>  <span class="k">function </span><span class="n">VTM_WRF_XML</span><span class="p">(</span><span class="n">wrf_dir</span><span class="p">,</span><span class="n">vtk_xml_file_list</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2913"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2914"></a>  <span class="c">!!The VTM_WRF_XML function is used for saving the list of VTK XML wrapped files by the actual block of the mutliblock VTM file.</span>
<a name="ln-2915"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2916"></a>
<a name="ln-2917"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2918"></a>  <span class="k">implicit none</span>
<a name="ln-2919"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span><span class="kd">::</span> <span class="n">wrf_dir</span>              <span class="c">! directory into which wrapped VTK XML are (optional)</span>
<a name="ln-2920"></a>  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>           <span class="n">vtk_xml_file_list</span><span class="p">(:)</span> <span class="c">! list of VTK XML wrapped files</span>
<a name="ln-2921"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>                       <span class="n">E_IO</span>                 <span class="c">! Input/Output inquiring flag: 0 if IO is done, &gt; 0 if IO is not done</span>
<a name="ln-2922"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span>                       <span class="n">f</span>                    <span class="c">! file counter</span>
<a name="ln-2923"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2924"></a>
<a name="ln-2925"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2926"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">wrf_dir</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2927"></a><span class="k">    do </span><span class="n">f</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">vtk_xml_file_list</span><span class="p">)</span>
<a name="ln-2928"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,I3.3,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">vtm_indent</span><span class="p">)</span><span class="o">//</span>                                      <span class="p">&amp;</span>
<a name="ln-2929"></a>                                                       <span class="s1">&#39;&lt;DataSet index=&quot;&#39;</span><span class="p">,</span><span class="n">f</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;&quot; file=&quot;&#39;</span><span class="o">//</span>                           <span class="p">&amp;</span>
<a name="ln-2930"></a>                                                       <span class="nb">adjustl</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">wrf_dir</span><span class="p">))</span><span class="o">//</span><span class="nb">adjustl</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">vtk_xml_file_list</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2931"></a>                                                       <span class="s1">&#39;&quot;&gt;&lt;/DataSet&gt;&#39;</span>
<a name="ln-2932"></a>    <span class="n">enddo</span>
<a name="ln-2933"></a>  <span class="k">else</span>
<a name="ln-2934"></a><span class="k">    do </span><span class="n">f</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">vtk_xml_file_list</span><span class="p">)</span>
<a name="ln-2935"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A,I3.3,A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">vtm_indent</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-2936"></a>                                                       <span class="s1">&#39;&lt;DataSet index=&quot;&#39;</span><span class="p">,</span><span class="n">f</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;&quot; file=&quot;&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2937"></a>                                                       <span class="nb">adjustl</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">vtk_xml_file_list</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2938"></a>                                                       <span class="s1">&#39;&quot;&gt;&lt;/DataSet&gt;&#39;</span>
<a name="ln-2939"></a>    <span class="n">enddo</span>
<a name="ln-2940"></a>  <span class="n">endif</span>
<a name="ln-2941"></a>  <span class="k">return</span>
<a name="ln-2942"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2943"></a>  <span class="n">endfunction</span> <span class="n">VTM_WRF_XML</span>
<a name="ln-2944"></a>
<a name="ln-2945"></a>  <span class="k">function </span><span class="n">VTM_END_XML</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">E_IO</span><span class="p">)</span>
<a name="ln-2946"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2947"></a>  <span class="c">!!This function is used to finalize the VTM file opened. The \LIBVTKIO manages the file unit without the user&#39;s action.</span>
<a name="ln-2948"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2949"></a>
<a name="ln-2950"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2951"></a>  <span class="k">implicit none</span>
<a name="ln-2952"></a><span class="k">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span><span class="kd">::</span> <span class="n">E_IO</span>      <span class="c">! Input/Output inquiring flag: $0$ if IO is done, $&gt; 0$ if IO is not done</span>
<a name="ln-2953"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2954"></a>
<a name="ln-2955"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2956"></a>  <span class="n">vtm_indent</span> <span class="o">=</span> <span class="n">vtm_indent</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-2957"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">vtm_indent</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&lt;/vtkMultiBlockDataSet&gt;&#39;</span>
<a name="ln-2958"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">E_IO</span><span class="p">)</span><span class="s1">&#39;&lt;/VTKFile&gt;&#39;</span>
<a name="ln-2959"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">Unit_VTM</span><span class="p">)</span>
<a name="ln-2960"></a>  <span class="k">return</span>
<a name="ln-2961"></a>  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2962"></a>  <span class="n">endfunction</span> <span class="n">VTM_END_XML</span>
<a name="ln-2963"></a>
<a name="ln-2964"></a><span class="n">endmodule</span> <span class="n">VTK</span>
<a name="ln-2965"></a><span class="c">!(doc)INCLUDE{/home/szaghi/VTK_IO/LIB_VTK_IO/source/DOC_Footer.doc}</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-04-03 16:35  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> MUSST was developed by Noël Brunetière - Arthur Francisco</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>