<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="MUSST – A modern Fortran MUltiScale Simulation Tribology solver">
    
    <meta name="author" content="Noël Brunetière - Arthur Francisco" >
    <link rel="icon" href="../favicon.png">

    <title>mod_test_musst.f90 &ndash; MUSST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    
    <link href="../css/user.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">MUSST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>mod_test_musst.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     <li><i class="fa fa-pencil"></i> Noël Brunetière<br/>&emsp;Arthur Francisco</li>
     
     
    <li><i class="fa fa-calendar-o"></i> April,17 2017</li>
     
     
     
    <li><i class="fa fa-barcode"></i> 1.0.0</li>
    
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.0% of total for source files.">480 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/mod_test_musst.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">mod_test_musst.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/test_musst.html">test_musst</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/mod_test_musst.f90.html#src">mod_test_musst.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: sourcefile~~mod_test_musst.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemod_test_musstf90EfferentGraph" width="641pt" height="351pt"
 viewBox="0.00 0.00 641.00 350.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph" class="graph" transform="scale(0.67759 0.67759) rotate(0) translate(4 513.631)">
<title>sourcefile~~mod_test_musst.f90~~EfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-513.631 942,-513.631 942,4 -4,4"/>
<!-- sourcefile~mod_test_musst.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node1" class="node"><title>sourcefile~mod_test_musst.f90</title>
<polygon fill="none" stroke="black" points="937.5,-388 828.5,-388 828.5,-364 937.5,-364 937.5,-388"/>
<text text-anchor="middle" x="883" y="-373.6" font-family="Helvetica,sans-Serif" font-size="10.50">mod_test_musst.f90</text>
</g>
<!-- sourcefile~mod_ms_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node2" class="node"><title>sourcefile~mod_ms_film.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/mod_ms_film.f90.html" xlink:title="mod_ms_film.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650,-304 556,-304 556,-280 650,-280 650,-304"/>
<text text-anchor="middle" x="603" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_ms_film.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_ms_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge1" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_ms_film.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M738,-307C713.261,-298.633 684.635,-294.71 660.209,-292.947"/>
<polygon fill="#ff0000" stroke="#ff0000" points="660.218,-289.441 650.021,-292.316 659.786,-296.427 660.218,-289.441"/>
</g>
<!-- sourcefile~mod_solver.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node3" class="node"><title>sourcefile~mod_solver.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/mod_solver.f90.html" xlink:title="mod_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="384,-339 298,-339 298,-315 384,-315 384,-339"/>
<text text-anchor="middle" x="341" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_solver.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge3" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M738,-307C691.38,-291.234 569.021,-341.65 520,-346 479.271,-349.614 468.647,-350.437 428,-346 416.944,-344.793 405.228,-342.738 394.12,-340.415"/>
<polygon fill="#ff0000" stroke="#ff0000" points="394.644,-336.947 384.126,-338.222 393.144,-343.784 394.644,-336.947"/>
</g>
<!-- sourcefile~mod_inout_files.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node4" class="node"><title>sourcefile~mod_inout_files.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/mod_inout_files.f90.html" xlink:title="mod_inout_files.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="792,-388 686,-388 686,-364 792,-364 792,-388"/>
<text text-anchor="middle" x="739" y="-373.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_inout_files.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_inout_files.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge2" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_inout_files.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M828.316,-376C819.848,-376 811.031,-376 802.386,-376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="802.349,-372.5 792.349,-376 802.349,-379.5 802.349,-372.5"/>
</g>
<!-- sourcefile~mod_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node5" class="node"><title>sourcefile~mod_film.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/mod_film.f90.html" xlink:title="mod_film.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="511,-224 437,-224 437,-200 511,-200 511,-224"/>
<text text-anchor="middle" x="474" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_film.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge4" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_film.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602,-212C577.155,-199.947 546.222,-199.688 521.105,-202.567"/>
<polygon fill="#ff0000" stroke="#ff0000" points="520.531,-199.113 511.086,-203.913 521.463,-206.05 520.531,-199.113"/>
</g>
<!-- sourcefile~mod_surfile.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node6" class="node"><title>sourcefile~mod_surfile.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/mod_surfile.f90.html" xlink:title="mod_surfile.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="384,-421 298,-421 298,-397 384,-397 384,-421"/>
<text text-anchor="middle" x="341" y="-406.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_surfile.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_surfile.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge5" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_surfile.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M866.562,-388.045C825.77,-418.536 710.903,-495.83 604,-488"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602,-488C543.12,-490.087 532.463,-463.009 475,-450"/>
</g>
<!-- sourcefile~mod_num_par.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node7" class="node"><title>sourcefile~mod_num_par.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/mod_num_par.f90.html" xlink:title="mod_num_par.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="391,-24 291,-24 291,-0 391,-0 391,-24"/>
<text text-anchor="middle" x="341" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_num_par.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_num_par.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge6" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_num_par.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M861.03,-363.834C833.906,-348.566 784.811,-322.506 740,-307"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M738,-307C687.766,-289.617 696.138,-252.4 650,-226 631.451,-215.387 623.227,-221.327 604,-212"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602,-212C562.739,-192.954 557.514,-180.291 520,-158 500.514,-146.421 495.032,-144.606 475,-134"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-134C422.146,-107.076 437.938,-67.6507 392,-33 390.168,-31.618 388.231,-30.3088 386.227,-29.0711"/>
<polygon fill="#ff0000" stroke="#ff0000" points="387.571,-25.8174 377.117,-24.0978 384.217,-31.9615 387.571,-25.8174"/>
</g>
<!-- sourcefile~mod_data.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node8" class="node"><title>sourcefile~mod_data.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/mod_data.f90.html" xlink:title="mod_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380.5,-146 301.5,-146 301.5,-122 380.5,-122 380.5,-146"/>
<text text-anchor="middle" x="341" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_data.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge7" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-134C448.069,-120.8 416.544,-120.392 390.668,-123.478"/>
<polygon fill="#ff0000" stroke="#ff0000" points="390.111,-120.021 380.69,-124.869 391.078,-126.954 390.111,-120.021"/>
</g>
<!-- sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node9" class="node"><title>sourcefile~mod_data_arch.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/mod_data_arch.f90.html" xlink:title="mod_data_arch.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-272 7.10543e-15,-272 7.10543e-15,-248 106,-248 106,-272"/>
<text text-anchor="middle" x="53" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_data_arch.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge8" class="edge"><title>sourcefile~mod_test_musst.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602,-488C545.591,-490 530.946,-480.516 475,-488"/>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_solver.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge9" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M565.178,-304.082C539.897,-312.258 505.525,-323.139 475,-332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-332C447.755,-339.328 418.623,-339.026 394.252,-336.487"/>
<polygon fill="#ff0000" stroke="#ff0000" points="394.468,-332.988 384.123,-335.278 393.638,-339.939 394.468,-332.988"/>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge11" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_film.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M580.162,-279.856C572.415,-275.372 563.709,-270.13 556,-265 539.349,-253.92 536.688,-249.022 520,-238 515.596,-235.091 510.854,-232.154 506.16,-229.353"/>
<polygon fill="#ff0000" stroke="#ff0000" points="507.693,-226.195 497.292,-224.179 504.165,-232.242 507.693,-226.195"/>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_surfile.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge12" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_surfile.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-332C431.753,-343.973 389.987,-371.859 365.044,-390.576"/>
<polygon fill="#ff0000" stroke="#ff0000" points="362.763,-387.914 356.951,-396.773 367.019,-393.472 362.763,-387.914"/>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_num_par.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge15" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_num_par.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M593.251,-279.782C575.969,-255.904 537.608,-204.225 520,-191 502.641,-177.962 490.459,-187.243 475,-172"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-172C456.86,-156.085 442.465,-165.451 428,-148 393.822,-106.766 428.044,-72.6124 392,-33 391.109,-32.0207 390.165,-31.0857 389.176,-30.1929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="391.013,-27.201 380.868,-24.1459 386.894,-32.8606 391.013,-27.201"/>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_data.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge16" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M558.552,-279.991C533.769,-272.726 502.3,-262.797 475,-252"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-252C452.812,-244.016 443.794,-247.894 428,-233 401.681,-208.181 417.305,-185.852 392,-160 388.835,-156.766 385.181,-153.852 381.319,-151.248"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.015,-148.184 372.64,-146.038 379.412,-154.186 383.015,-148.184"/>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge17" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-252C416.324,-229.585 259.937,-241.097 199,-240"/>
</g>
<!-- sourcefile~mod_mesh.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node13" class="node"><title>sourcefile~mod_mesh.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/mod_mesh.f90.html" xlink:title="mod_mesh.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383,-66 299,-66 299,-42 383,-42 383,-66"/>
<text text-anchor="middle" x="341" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_mesh.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_mesh.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge10" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-172C456.86,-156.085 444.003,-164.052 428,-148 403.857,-123.783 416.269,-104.091 392,-80 388.748,-76.7722 385.013,-73.8554 381.08,-71.2436"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.651,-68.106 372.266,-66.0113 379.078,-74.1255 382.651,-68.106"/>
</g>
<!-- sourcefile~mod_fluid.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node15" class="node"><title>sourcefile~mod_fluid.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/mod_fluid.f90.html" xlink:title="mod_fluid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="236.5,-186 159.5,-186 159.5,-162 236.5,-162 236.5,-186"/>
<text text-anchor="middle" x="198" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_fluid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_fluid.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge13" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_fluid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473,-252C452.812,-244.016 445.685,-245.592 428,-233 408.517,-219.127 411.732,-206.516 392,-193 372.387,-179.566 365.272,-178.854 342,-174"/>
</g>
<!-- sourcefile~mod_bspline.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node16" class="node"><title>sourcefile~mod_bspline.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/mod_bspline.f90.html" xlink:title="mod_bspline.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="519.5,-304 428.5,-304 428.5,-280 519.5,-280 519.5,-304"/>
<text text-anchor="middle" x="474" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_bspline.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_bspline.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge14" class="edge"><title>sourcefile~mod_ms_film.f90&#45;&gt;sourcefile~mod_bspline.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M555.791,-292C547.329,-292 538.423,-292 529.741,-292"/>
<polygon fill="#ff0000" stroke="#ff0000" points="529.69,-288.5 519.69,-292 529.69,-295.5 529.69,-288.5"/>
</g>
<!-- sourcefile~mod_solver.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge23" class="edge"><title>sourcefile~mod_solver.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M329.351,-314.707C307.536,-290.96 255.081,-241.01 199,-240"/>
</g>
<!-- sourcefile~mod_sort_arrays.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node10" class="node"><title>sourcefile~mod_sort_arrays.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/mod_sort_arrays.f90.html" xlink:title="mod_sort_arrays.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="254,-460 142,-460 142,-436 254,-436 254,-460"/>
<text text-anchor="middle" x="198" y="-445.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_sort_arrays.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_solver.f90&#45;&gt;sourcefile~mod_sort_arrays.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge18" class="edge"><title>sourcefile~mod_solver.f90&#45;&gt;sourcefile~mod_sort_arrays.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M330.185,-339.07C309.648,-364.226 263.273,-420.482 254,-427 251.764,-428.571 249.396,-430.043 246.947,-431.42"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="245.191,-428.385 237.818,-435.992 248.326,-434.643 245.191,-428.385"/>
</g>
<!-- sourcefile~mod_gen_par.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node11" class="node"><title>sourcefile~mod_gen_par.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/mod_gen_par.f90.html" xlink:title="mod_gen_par.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="246.5,-292 149.5,-292 149.5,-268 246.5,-268 246.5,-292"/>
<text text-anchor="middle" x="198" y="-277.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_gen_par.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_solver.f90&#45;&gt;sourcefile~mod_gen_par.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge19" class="edge"><title>sourcefile~mod_solver.f90&#45;&gt;sourcefile~mod_gen_par.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M303.689,-314.896C285.762,-308.921 263.944,-301.648 244.874,-295.291"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="245.782,-291.905 235.188,-292.063 243.568,-298.545 245.782,-291.905"/>
</g>
<!-- sourcefile~superlu.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node12" class="node"><title>sourcefile~superlu.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/superlu.f90.html" xlink:title="superlu.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="231,-376 165,-376 165,-352 231,-352 231,-376"/>
<text text-anchor="middle" x="198" y="-361.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">superlu.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_solver.f90&#45;&gt;sourcefile~superlu.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge20" class="edge"><title>sourcefile~mod_solver.f90&#45;&gt;sourcefile~superlu.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M297.695,-338.101C279.929,-342.763 259.303,-348.176 241.514,-352.844"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="240.196,-349.571 231.412,-355.495 241.973,-356.342 240.196,-349.571"/>
</g>
<!-- sourcefile~umfpack.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node14" class="node"><title>sourcefile~umfpack.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/umfpack.f90.html" xlink:title="umfpack.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="233.5,-334 162.5,-334 162.5,-310 233.5,-310 233.5,-334"/>
<text text-anchor="middle" x="198" y="-319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">umfpack.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_solver.f90&#45;&gt;sourcefile~umfpack.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge21" class="edge"><title>sourcefile~mod_solver.f90&#45;&gt;sourcefile~umfpack.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M297.695,-325.5C280.767,-324.9 261.242,-324.207 244.049,-323.597"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="243.808,-320.087 233.69,-323.23 243.56,-327.082 243.808,-320.087"/>
</g>
<!-- sourcefile~dmumps_struc.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node19" class="node"><title>sourcefile~dmumps_struc.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/dmumps_struc.f90.html" xlink:title="dmumps_struc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="248.5,-418 147.5,-418 147.5,-394 248.5,-394 248.5,-418"/>
<text text-anchor="middle" x="198" y="-403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dmumps_struc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_solver.f90&#45;&gt;sourcefile~dmumps_struc.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge22" class="edge"><title>sourcefile~mod_solver.f90&#45;&gt;sourcefile~dmumps_struc.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M324.511,-339.045C307.792,-351.656 280.05,-371.47 254,-385 250.675,-386.727 247.175,-388.39 243.617,-389.972"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="242.007,-386.852 234.149,-393.958 244.723,-393.304 242.007,-386.852"/>
</g>
<!-- sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_ms_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge28" class="edge"><title>sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_ms_film.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M718.801,-363.965C696.014,-349.681 657.836,-325.748 631.815,-309.436"/>
<polygon fill="#7fff00" stroke="#7fff00" points="633.495,-306.359 623.163,-304.013 629.777,-312.29 633.495,-306.359"/>
</g>
<!-- sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_film.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge26" class="edge"><title>sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_film.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M725.527,-363.766C714.671,-352.899 698.725,-336.396 686,-321 668.555,-299.893 672.029,-287.264 650,-271 611.687,-242.713 558.92,-227.389 521.37,-219.508"/>
<polygon fill="#7fff00" stroke="#7fff00" points="521.699,-216.005 511.207,-217.478 520.327,-222.869 521.699,-216.005"/>
</g>
<!-- sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_surfile.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge27" class="edge"><title>sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_surfile.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M720.757,-388.25C696.126,-405.094 648.869,-435.017 604,-450"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M602,-450C548.461,-467.877 530.051,-462.463 475,-450"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M473,-450C443.145,-443.241 410.269,-432.943 384.921,-424.359"/>
<polygon fill="#7fff00" stroke="#7fff00" points="385.843,-420.975 375.249,-421.043 383.573,-427.597 385.843,-420.975"/>
</g>
<!-- sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge25" class="edge"><title>sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M602,-450C546.116,-468.661 533.76,-483.696 475,-488"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M473,-488C351.548,-496.896 312.65,-531.744 199,-488"/>
</g>
<!-- sourcefile~mod_vtk.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node17" class="node"><title>sourcefile~mod_vtk.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/mod_vtk.f90.html" xlink:title="mod_vtk.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="638.5,-403 567.5,-403 567.5,-379 638.5,-379 638.5,-403"/>
<text text-anchor="middle" x="603" y="-388.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_vtk.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_vtk.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge24" class="edge"><title>sourcefile~mod_inout_files.f90&#45;&gt;sourcefile~mod_vtk.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M685.808,-381.842C673.645,-383.204 660.797,-384.642 648.977,-385.965"/>
<polygon fill="#7fff00" stroke="#7fff00" points="648.447,-382.503 638.898,-387.094 649.225,-389.459 648.447,-382.503"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_solver.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge29" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_solver.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M449.312,-224.048C442.193,-228.094 434.541,-232.889 428,-238 401.304,-258.857 374.87,-287.782 358.502,-306.926"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="355.697,-304.823 351.928,-314.724 361.049,-309.334 355.697,-304.823"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_surfile.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge31" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_surfile.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M444.885,-224.021C438.648,-227.753 432.548,-232.394 428,-238 395.591,-277.948 416.727,-302.893 392,-348 383.737,-363.073 371.555,-378.031 361.285,-389.363"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="358.493,-387.225 354.227,-396.923 363.61,-392.001 358.493,-387.225"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_num_par.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge33" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_num_par.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M444.074,-199.964C438.014,-196.27 432.197,-191.649 428,-186 386.339,-129.926 437.117,-86.3336 392,-33 391.27,-32.1374 390.499,-31.3096 389.692,-30.5151"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="391.649,-27.6028 381.605,-24.2288 387.352,-33.1295 391.649,-27.6028"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_data.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge35" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_data.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M450.758,-199.744C443.416,-195.542 435.27,-190.708 428,-186 411.434,-175.272 408.8,-170.358 392,-160 386.931,-156.875 381.447,-153.766 376.031,-150.843"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="377.546,-147.685 367.066,-146.128 374.287,-153.88 377.546,-147.685"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge36" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M445.902,-199.779C439.491,-196.009 433.057,-191.401 428,-186 403.275,-159.593 421.746,-133.587 392,-113 356.563,-88.4748 236.87,-73.4293 199,-94"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_mesh.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge30" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_mesh.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M444.929,-199.943C438.69,-196.212 432.579,-191.58 428,-186 396.44,-147.537 424.406,-117.753 392,-80 389.351,-76.9144 386.245,-74.1454 382.899,-71.6715"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="384.524,-68.556 374.213,-66.1177 380.753,-74.4535 384.524,-68.556"/>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_fluid.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge32" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_fluid.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M436.954,-199.923C410.849,-191.576 374.57,-180.793 342,-174"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M340,-174C309.402,-167.618 274.249,-167.603 246.697,-169.19"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="246.28,-165.71 236.535,-169.867 246.746,-172.695 246.28,-165.71"/>
</g>
<!-- sourcefile~mod_elements.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node18" class="node"><title>sourcefile~mod_elements.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/mod_elements.f90.html" xlink:title="mod_elements.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="391.5,-226 290.5,-226 290.5,-202 391.5,-202 391.5,-226"/>
<text text-anchor="middle" x="341" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_elements.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_elements.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge34" class="edge"><title>sourcefile~mod_film.f90&#45;&gt;sourcefile~mod_elements.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M436.857,-212.552C426.079,-212.716 413.964,-212.901 402.088,-213.083"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="401.699,-209.588 391.753,-213.24 401.805,-216.587 401.699,-209.588"/>
</g>
<!-- sourcefile~mod_surfile.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge37" class="edge"><title>sourcefile~mod_surfile.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M330.56,-421.178C308.539,-448.004 251.635,-508.259 199,-488"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M197,-488C172.864,-478.71 160.88,-486.675 142,-469 86.4635,-417.008 64.629,-324.428 57.2606,-282.155"/>
<polygon fill="#00ffff" stroke="#00ffff" points="60.6834,-281.398 55.618,-272.092 53.7748,-282.525 60.6834,-281.398"/>
</g>
<!-- sourcefile~mod_surfile.f90&#45;&gt;sourcefile~mod_sort_arrays.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge38" class="edge"><title>sourcefile~mod_surfile.f90&#45;&gt;sourcefile~mod_sort_arrays.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M297.695,-420.701C283.455,-424.64 267.378,-429.087 252.397,-433.231"/>
<polygon fill="#00ffff" stroke="#00ffff" points="251.446,-429.862 242.741,-435.901 253.312,-436.609 251.446,-429.862"/>
</g>
<!-- sourcefile~mod_num_par.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge39" class="edge"><title>sourcefile~mod_num_par.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M308.625,-24.0836C302.352,-26.803 295.885,-29.83 290,-33 247.133,-56.0902 241.786,-70.759 199,-94"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M197,-94C133.792,-128.334 85.9375,-202.522 65.243,-238.951"/>
<polygon fill="#003fff" stroke="#003fff" points="62.148,-237.315 60.3542,-247.757 68.2681,-240.713 62.148,-237.315"/>
</g>
<!-- sourcefile~mod_data.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge40" class="edge"><title>sourcefile~mod_data.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M313.955,-121.983C278.955,-106.619 218.844,-83.2209 199,-94"/>
</g>
<!-- sourcefile~mod_data.f90&#45;&gt;sourcefile~mod_fluid.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge41" class="edge"><title>sourcefile~mod_data.f90&#45;&gt;sourcefile~mod_fluid.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M301.471,-144.93C284.409,-149.77 264.178,-155.51 246.217,-160.605"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="245.173,-157.263 236.508,-163.36 247.083,-163.997 245.173,-157.263"/>
</g>
<!-- sourcefile~mod_sort_arrays.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge42" class="edge"><title>sourcefile~mod_sort_arrays.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M155.463,-435.964C150.608,-433.485 145.977,-430.526 142,-427 96.6617,-386.81 70.9128,-317.573 60.1047,-282.203"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.3977,-280.994 57.225,-272.383 56.6805,-282.963 63.3977,-280.994"/>
</g>
<!-- sourcefile~mod_gen_par.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge43" class="edge"><title>sourcefile~mod_gen_par.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M149.383,-273.34C138.808,-271.861 127.446,-270.272 116.38,-268.724"/>
<polygon fill="#ff9900" stroke="#ff9900" points="116.72,-265.238 106.331,-267.319 115.75,-272.171 116.72,-265.238"/>
</g>
<!-- sourcefile~mod_mesh.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge44" class="edge"><title>sourcefile~mod_mesh.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M298.978,-60.6589C269.818,-66.5535 230.415,-76.9356 199,-94"/>
</g>
<!-- sourcefile~mod_fluid.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge45" class="edge"><title>sourcefile~mod_fluid.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M176.815,-186.139C152.329,-200.865 110.873,-225.797 82.9783,-242.572"/>
<polygon fill="#00ffff" stroke="#00ffff" points="80.8482,-239.769 74.0824,-247.922 84.4559,-245.768 80.8482,-239.769"/>
</g>
<!-- sourcefile~mod_ir_vtk.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_node20" class="node"><title>sourcefile~mod_ir_vtk.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/mod_ir_vtk.f90.html" xlink:title="mod_ir_vtk.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="515.5,-422 432.5,-422 432.5,-398 515.5,-398 515.5,-422"/>
<text text-anchor="middle" x="474" y="-407.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mod_ir_vtk.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_vtk.f90&#45;&gt;sourcefile~mod_ir_vtk.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge46" class="edge"><title>sourcefile~mod_vtk.f90&#45;&gt;sourcefile~mod_ir_vtk.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M567.297,-396.192C554.413,-398.119 539.524,-400.347 525.515,-402.443"/>
<polygon fill="#3200ff" stroke="#3200ff" points="524.883,-398.998 515.511,-403.939 525.919,-405.921 524.883,-398.998"/>
</g>
<!-- sourcefile~mod_elements.f90&#45;&gt;sourcefile~mod_data_arch.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~EfferentGraph_edge47" class="edge"><title>sourcefile~mod_elements.f90&#45;&gt;sourcefile~mod_data_arch.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M299.026,-226.029C271.08,-233.125 233.096,-240.614 199,-240"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M197,-240C170.345,-239.52 141.158,-242.89 116.143,-246.995"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="115.322,-243.584 106.058,-248.725 116.506,-250.483 115.322,-243.584"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemod_test_musstf90EfferentGraph = svgPanZoom('#sourcefilemod_test_musstf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="189pt" height="32pt"
 viewBox="0.00 0.00 189.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 185,-28 185,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66.25,-24 -0.25,-24 -0.25,-0 66.25,-0 66.25,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="181.25,-24 84.75,-24 84.75,-0 181.25,-0 181.25,-24"/>
<text text-anchor="middle" x="133" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: sourcefile~~mod_test_musst.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemod_test_musstf90AfferentGraph" width="208pt" height="32pt"
 viewBox="0.00 0.00 208.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~mod_test_musst.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~mod_test_musst.f90~~AfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 204,-28 204,4 -4,4"/>
<!-- sourcefile~mod_test_musst.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~AfferentGraph_node1" class="node"><title>sourcefile~mod_test_musst.f90</title>
<polygon fill="none" stroke="black" points="109.5,-24 0.5,-24 0.5,-0 109.5,-0 109.5,-24"/>
<text text-anchor="middle" x="55" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">mod_test_musst.f90</text>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~AfferentGraph_node2" class="node"><title>sourcefile~main.f90</title>
<g id="a_sourcefile~~mod_test_musst.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="200,-24 146,-24 146,-0 200,-0 200,-24"/>
<text text-anchor="middle" x="173" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~mod_test_musst.f90 -->
<g id="sourcefile~~mod_test_musst.f90~~AfferentGraph_edge1" class="edge"><title>sourcefile~main.f90&#45;&gt;sourcefile~mod_test_musst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M145.967,-12C138.119,-12 129.134,-12 119.948,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.946,-8.5001 109.946,-12 119.946,-15.5001 119.946,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="189pt" height="32pt"
 viewBox="0.00 0.00 189.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 185,-28 185,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66.25,-24 -0.25,-24 -0.25,-0 66.25,-0 66.25,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="181.25,-24 84.75,-24 84.75,-0 181.25,-0 181.25,-24"/>
<text text-anchor="middle" x="133" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/test_musst.html">test_musst</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/mod_test_musst.f90.html#src">mod_test_musst.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!! author: Noël Brunetière&lt;br/&gt;&amp;emsp;Arthur Francisco</span>
<a name="ln-2"></a><span class="c">!! version: 1.0.0</span>
<a name="ln-3"></a><span class="c">!! date: April,17 2017</span>
<a name="ln-4"></a><span class="c">!! summary: run different tests</span>
<a name="ln-5"></a>
<a name="ln-6"></a><span class="c">!&lt; &lt;span style=&quot;color: #337ab7; font-family: cabin; font-size: 1.5em;&quot;&gt;</span>
<a name="ln-7"></a><span class="c">!&lt;       **Subroutines to read a batch file and run tests**</span>
<a name="ln-8"></a><span class="c">!&lt; &lt;/span&gt;</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">module </span><span class="n">test_musst</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">data_arch</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R4</span><span class="p">,</span> <span class="n">PI_R8</span><span class="p">,</span> <span class="n">get_unit</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">data_film_hd</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">ms_film</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">film</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">inout_files</span>
<a name="ln-16"></a><span class="k">use </span><span class="n">surfile</span>
<a name="ln-17"></a><span class="k">use </span><span class="n">num_param</span>
<a name="ln-18"></a><span class="k">use </span><span class="n">solver</span>
<a name="ln-19"></a><span class="k">implicit none</span>
<a name="ln-20"></a>
<a name="ln-21"></a><span class="k">private</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="k">type</span><span class="p">(</span><span class="n">FE_FILM</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">fe_f</span>      <span class="c">!! [[FE_FILM]] *deterministic finite element*</span>
<a name="ln-24"></a><span class="k">type</span><span class="p">(</span><span class="n">MS_FE_FILM</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ms_fe_f</span>   <span class="c">!! [[MS_FE_FILM]] *multiscale finite element*</span>
<a name="ln-25"></a><span class="k">type</span><span class="p">(</span><span class="n">DATA_FILM</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">data_f</span>    <span class="c">!! [[DATA_FILM]] *parameter*</span>
<a name="ln-26"></a><span class="k">type</span><span class="p">(</span><span class="n">NUM_PAR</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">num_pbs</span>   <span class="c">!! [[NUM_PAR]] *parameter for the bottom-scale*</span>
<a name="ln-27"></a><span class="k">type</span><span class="p">(</span><span class="n">NUM_PAR</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">num_pts</span>   <span class="c">!! [[NUM_PAR]] *parameter for the top-scale*</span>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="k">type</span><span class="p">(</span><span class="n">MAT_SOLV</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">mat</span>      <span class="c">!! [[MAT_SOLV]] *solver type matrices*</span>
<a name="ln-30"></a><span class="k">type</span><span class="p">(</span><span class="n">MS_MAT_SOLV</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ms_mat</span>   <span class="c">!! [[MS_MAT_SOLV]] *solver type matrices*</span>
<a name="ln-31"></a>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">nx</span>        <span class="c">!! *total number of nodes in \(x\) direction*</span>
<a name="ln-34"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">ny</span>        <span class="c">!! *total number of nodes in \(y\) direction*</span>
<a name="ln-35"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">n_mac</span>     <span class="c">!! *number of macro elements in a direction*</span>
<a name="ln-36"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">n_mic</span>     <span class="c">!! *number of nodes in \(x\) or \(y\) direction for the bottom scale*</span>
<a name="ln-37"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">lx</span>        <span class="c">!! *domain size along \(x\)*</span>
<a name="ln-38"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">ly</span>        <span class="c">!! *domain size along \(y\)*</span>
<a name="ln-39"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">sq</span>        <span class="c">!! *roughness height*</span>
<a name="ln-40"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tab_s</span>     <span class="c">!! *roughness table*</span>
<a name="ln-41"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tab_sol</span>   <span class="c">!! *rough surface pressure solution*</span>
<a name="ln-42"></a>
<a name="ln-43"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bc</span><span class="p">,</span> <span class="n">bf</span>                 <span class="c">!! *boundary conditions*</span>
<a name="ln-44"></a>
<a name="ln-45"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R4</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span>                           <span class="c">!! *cpu time*</span>
<a name="ln-46"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">cend</span><span class="p">,</span> <span class="n">cr</span><span class="p">,</span> <span class="n">cinit</span>                  <span class="c">!! *real time*</span>
<a name="ln-47"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">unit_num_res</span>                     <span class="c">!! *file number*</span>
<a name="ln-48"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">compare_solution_file</span>            <span class="c">!! *whether to compare the pressure MS solution to a reference*</span>
<a name="ln-49"></a>
<a name="ln-50"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="kd">::</span> <span class="n">ms_vtk</span>                           <span class="c">!! *output vtk file name*</span>
<a name="ln-51"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="kd">::</span> <span class="n">prof_ts</span><span class="p">,</span> <span class="n">prof_bs</span>                 <span class="c">!! *ts/bs mat profile name*</span>
<a name="ln-52"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="kd">::</span> <span class="n">res_file</span>                         <span class="c">!! *result file name*</span>
<a name="ln-53"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="kd">::</span> <span class="n">surface_file</span>                     <span class="c">!! *surface file name*</span>
<a name="ln-54"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="kd">::</span> <span class="n">pressure_solution_file</span>           <span class="c">!! *pressure solution file for a rough surface*</span>
<a name="ln-55"></a>
<a name="ln-56"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="kd">::</span> <span class="n">res_dir</span>                          <span class="c">!! *&quot;/out&quot; subdirectory for results*</span>
<a name="ln-57"></a>
<a name="ln-58"></a><span class="k">type</span><span class="p">(</span><span class="n">SCALE_SURF</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal_tmp</span>                          <span class="c">!! *object [[SCALE_SURF]]*</span>
<a name="ln-59"></a>
<a name="ln-60"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">test_num</span>                          <span class="c">!! *test number*</span>
<a name="ln-61"></a><span class="kt">logical</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">save_PeK</span>                          <span class="c">!! *save \(x\) Peclet field*</span>
<a name="ln-62"></a><span class="kt">logical</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">save_PeE</span>                          <span class="c">!! *save \(y\) Peclet field*</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">run_test</span><span class="p">,</span> <span class="n">read_data</span><span class="p">,</span> <span class="n">test_num</span>
<a name="ln-65"></a>
<a name="ln-66"></a><span class="k">contains</span>
<a name="ln-67"></a>
<a name="ln-68"></a>
<a name="ln-69"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-70"></a>   <span class="c">!&lt; @note Subroutine to run the specified test</span>
<a name="ln-71"></a>   <span class="c">!  @endnote</span>
<a name="ln-72"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-73"></a>   <span class="k">subroutine </span><span class="n">run_test</span>
<a name="ln-74"></a>   <span class="k">implicit none</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="k">      </span><span class="n">mat</span><span class="p">%</span><span class="n">slv_t</span> <span class="o">=</span> <span class="n">SOLVER_TS</span>
<a name="ln-77"></a>
<a name="ln-78"></a>      <span class="k">call </span><span class="n">get_unit</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">)</span> <span class="p">;</span> <span class="k">open</span><span class="p">(</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit_num_res</span><span class="p">,</span> <span class="k">file</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">res_file</span><span class="p">),</span> <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
<a name="ln-79"></a>
<a name="ln-80"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">test_num</span><span class="p">)</span>
<a name="ln-81"></a>         <span class="k">case</span><span class="p">(</span> <span class="mi">1</span><span class="p">);</span> <span class="k">call </span><span class="n">test_slider_fe</span>
<a name="ln-82"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="k">call </span><span class="n">test_slider_ms</span>
<a name="ln-83"></a>
<a name="ln-84"></a>         <span class="k">case</span><span class="p">(</span> <span class="mi">2</span><span class="p">);</span> <span class="k">call </span><span class="n">test_bearing_x_fe</span>
<a name="ln-85"></a>         <span class="k">case</span><span class="p">(</span> <span class="mi">3</span><span class="p">);</span> <span class="k">call </span><span class="n">test_bearing_y_fe</span>
<a name="ln-86"></a>
<a name="ln-87"></a>         <span class="k">case</span><span class="p">(</span> <span class="mi">4</span><span class="p">);</span> <span class="k">call </span><span class="n">test_rough_fe</span>
<a name="ln-88"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="k">call </span><span class="n">test_rough_ms</span>
<a name="ln-89"></a>
<a name="ln-90"></a>         <span class="k">case</span><span class="p">(</span> <span class="mi">5</span><span class="p">);</span> <span class="k">call </span><span class="n">test_pocket_fe</span>
<a name="ln-91"></a>         <span class="k">case </span><span class="n">default</span> <span class="p">;</span> <span class="k">stop</span> <span class="s1">&#39;Bad test number&#39;</span>
<a name="ln-92"></a>      <span class="n">endselect</span>
<a name="ln-93"></a>
<a name="ln-94"></a>      <span class="k">close</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">)</span>
<a name="ln-95"></a>
<a name="ln-96"></a>   <span class="k">return</span>
<a name="ln-97"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">run_test</span>
<a name="ln-98"></a>
<a name="ln-99"></a>
<a name="ln-100"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-101"></a>   <span class="c">!&lt; @note Subroutine to read the &#39;EXEC_MUSST&#39; section</span>
<a name="ln-102"></a>   <span class="c">!  @endnote</span>
<a name="ln-103"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-104"></a>   <span class="k">subroutine </span><span class="n">read_data</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span>
<a name="ln-105"></a>   <span class="k">implicit none</span>
<a name="ln-106"></a><span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iunit</span>
<a name="ln-107"></a>   <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dir</span>    <span class="c">!! *output directory*</span>
<a name="ln-108"></a>
<a name="ln-109"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">err_read</span>
<a name="ln-110"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">064</span><span class="p">)</span> <span class="kd">::</span> <span class="n">word</span>
<a name="ln-111"></a>
<a name="ln-112"></a>      <span class="n">res_dir</span> <span class="o">=</span> <span class="n">dir</span>
<a name="ln-113"></a>      <span class="n">compare_solution_file</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-114"></a>
<a name="ln-115"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span>
<a name="ln-116"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">h_g</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span>
<a name="ln-117"></a>
<a name="ln-118"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">V_x</span> <span class="o">=</span> <span class="mf">0._R8</span>
<a name="ln-119"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">V_y</span> <span class="o">=</span> <span class="mf">0._R8</span>
<a name="ln-120"></a>
<a name="ln-121"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">pb_type</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-122"></a>
<a name="ln-123"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">fluid_type</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-124"></a>
<a name="ln-125"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">1.e10_R8</span>
<a name="ln-126"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">rho_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.e10_R8</span>
<a name="ln-127"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">mu_0</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">1.e10_R8</span>
<a name="ln-128"></a>
<a name="ln-129"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">rg</span>     <span class="o">=</span> <span class="mi">28</span><span class="mf">7._R8</span>
<a name="ln-130"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">lambda</span> <span class="o">=</span> <span class="mf">1.e-5_R8</span>
<a name="ln-131"></a>      <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">T_0</span>    <span class="o">=</span> <span class="mi">27</span><span class="mf">3._R8</span>
<a name="ln-132"></a>
<a name="ln-133"></a>      <span class="n">surface_file</span> <span class="o">=</span> <span class="s2">&quot;no_file&quot;</span>
<a name="ln-134"></a>
<a name="ln-135"></a>      <span class="n">compare_solution_file</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-136"></a>      <span class="n">pressure_solution_file</span> <span class="o">=</span> <span class="s2">&quot;no_file&quot;</span>
<a name="ln-137"></a>
<a name="ln-138"></a>      <span class="n">lx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span>
<a name="ln-139"></a>      <span class="n">ly</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span>
<a name="ln-140"></a>
<a name="ln-141"></a>      <span class="n">nx</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-142"></a>      <span class="n">ny</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-143"></a>      <span class="n">n_mac</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-144"></a>
<a name="ln-145"></a>      <span class="n">bc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.e5_R8</span><span class="p">,</span> <span class="mf">1.e5_R8</span><span class="p">,</span> <span class="mf">1.e5_R8</span><span class="p">,</span> <span class="mf">1.e5_R8</span><span class="p">]</span>
<a name="ln-146"></a>
<a name="ln-147"></a>      <span class="n">num_pts</span> <span class="o">=</span> <span class="n">NUM_PAR</span><span class="p">(</span><span class="mf">0._R8</span><span class="p">,</span> <span class="mf">1.e10_R8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-148"></a>      <span class="n">num_pbs</span> <span class="o">=</span> <span class="n">NUM_PAR</span><span class="p">(</span><span class="mf">0._R8</span><span class="p">,</span> <span class="mf">1.e10_R8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-149"></a>
<a name="ln-150"></a>      <span class="n">sq</span> <span class="o">=</span> <span class="mf">0._R8</span>
<a name="ln-151"></a>
<a name="ln-152"></a>      <span class="n">s_vtk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-153"></a>
<a name="ln-154"></a>      <span class="n">ms_vtk</span>   <span class="o">=</span> <span class="s2">&quot;no_file&quot;</span>
<a name="ln-155"></a>      <span class="n">prof_ts</span>  <span class="o">=</span> <span class="s2">&quot;no_file&quot;</span>
<a name="ln-156"></a>      <span class="n">prof_bs</span>  <span class="o">=</span> <span class="s2">&quot;no_file&quot;</span>
<a name="ln-157"></a>      <span class="n">res_file</span> <span class="o">=</span> <span class="s2">&quot;no_file&quot;</span>
<a name="ln-158"></a>
<a name="ln-159"></a>      <span class="k">do</span>
<a name="ln-160"></a><span class="k">         </span><span class="n">word</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
<a name="ln-161"></a>         <span class="k">read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">err_read</span><span class="p">)</span> <span class="n">word</span>
<a name="ln-162"></a>
<a name="ln-163"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[END_MUSST]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                  <span class="p">)</span> <span class="k">exit</span>
<a name="ln-164"></a>
<a name="ln-165"></a><span class="k">         if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[PROBLEM_TYPE]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>               <span class="p">)</span> <span class="k">then</span>
<a name="ln-166"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">test_num</span>
<a name="ln-167"></a>            <span class="k">cycle</span>
<a name="ln-168"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-169"></a>
<a name="ln-170"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[GAP]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                        <span class="p">)</span> <span class="k">then</span>
<a name="ln-171"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span><span class="p">,</span> <span class="n">data_f</span><span class="p">%</span><span class="n">h_g</span>
<a name="ln-172"></a>            <span class="k">cycle</span>
<a name="ln-173"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-174"></a>
<a name="ln-175"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[SPEED]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                      <span class="p">)</span> <span class="k">then</span>
<a name="ln-176"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">V_x</span><span class="p">,</span> <span class="n">data_f</span><span class="p">%</span><span class="n">V_y</span>
<a name="ln-177"></a>            <span class="k">cycle</span>
<a name="ln-178"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-179"></a>
<a name="ln-180"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[ELASTICITY]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                 <span class="p">)</span> <span class="k">then</span>
<a name="ln-181"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">pb_type</span>
<a name="ln-182"></a>            <span class="k">cycle</span>
<a name="ln-183"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-184"></a>
<a name="ln-185"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[FLUID_TYPE]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                 <span class="p">)</span> <span class="k">then</span>
<a name="ln-186"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">fluid_type</span>
<a name="ln-187"></a>            <span class="k">cycle</span>
<a name="ln-188"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-189"></a>
<a name="ln-190"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[AMBIENT_PRESSURE]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>           <span class="p">)</span> <span class="k">then</span>
<a name="ln-191"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span>
<a name="ln-192"></a>            <span class="k">cycle</span>
<a name="ln-193"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-194"></a>
<a name="ln-195"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[DENSITY]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                    <span class="p">)</span> <span class="k">then</span>
<a name="ln-196"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">rho_0</span>
<a name="ln-197"></a>            <span class="k">cycle</span>
<a name="ln-198"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-199"></a>
<a name="ln-200"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[VISCOSITY]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                  <span class="p">)</span> <span class="k">then</span>
<a name="ln-201"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">mu_0</span>
<a name="ln-202"></a>            <span class="k">cycle</span>
<a name="ln-203"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-204"></a>
<a name="ln-205"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[GAZ_CONSTANT]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>               <span class="p">)</span> <span class="k">then</span>
<a name="ln-206"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">rg</span>
<a name="ln-207"></a>            <span class="k">cycle</span>
<a name="ln-208"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-209"></a>
<a name="ln-210"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[MIXTURE_TRANSITION]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>         <span class="p">)</span> <span class="k">then</span>
<a name="ln-211"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">lambda</span>
<a name="ln-212"></a>            <span class="k">cycle</span>
<a name="ln-213"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-214"></a>
<a name="ln-215"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[AMBIENT_TEMPERATURE]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>        <span class="p">)</span> <span class="k">then</span>
<a name="ln-216"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">T_0</span>
<a name="ln-217"></a>            <span class="k">cycle</span>
<a name="ln-218"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-219"></a>
<a name="ln-220"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[ROUGH_SURFACE]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>              <span class="p">)</span> <span class="k">then</span>
<a name="ln-221"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surface_file</span>
<a name="ln-222"></a>            <span class="k">cycle</span>
<a name="ln-223"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-224"></a>
<a name="ln-225"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[ROUGH_SURFACE_SOLUTION]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>     <span class="p">)</span> <span class="k">then</span>
<a name="ln-226"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">compare_solution_file</span>
<a name="ln-227"></a>            <span class="k">read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">pressure_solution_file</span>
<a name="ln-228"></a>            <span class="k">cycle</span>
<a name="ln-229"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-230"></a>
<a name="ln-231"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[LENGTH]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                     <span class="p">)</span> <span class="k">then</span>
<a name="ln-232"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span>
<a name="ln-233"></a>            <span class="k">cycle</span>
<a name="ln-234"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-235"></a>
<a name="ln-236"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[NUMBER_NODES]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>               <span class="p">)</span> <span class="k">then</span>
<a name="ln-237"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span>
<a name="ln-238"></a>            <span class="k">cycle</span>
<a name="ln-239"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-240"></a>
<a name="ln-241"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[NUMBER_MACRO_ELEMENTS]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>      <span class="p">)</span> <span class="k">then</span>
<a name="ln-242"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">n_mac</span>
<a name="ln-243"></a>            <span class="k">cycle</span>
<a name="ln-244"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-245"></a>
<a name="ln-246"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[BOUNDARY_PRESSURES]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>         <span class="p">)</span> <span class="k">then</span>
<a name="ln-247"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">bc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-248"></a>            <span class="k">cycle</span>
<a name="ln-249"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-250"></a>
<a name="ln-251"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[NUMERICAL_TS_PARAMETERS]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>    <span class="p">)</span> <span class="k">then</span>
<a name="ln-252"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">num_pts</span>
<a name="ln-253"></a>            <span class="k">cycle</span>
<a name="ln-254"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-255"></a>
<a name="ln-256"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[NUMERICAL_BS_PARAMETERS]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>    <span class="p">)</span> <span class="k">then</span>
<a name="ln-257"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">num_pbs</span>
<a name="ln-258"></a>            <span class="k">cycle</span>
<a name="ln-259"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-260"></a>
<a name="ln-261"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[HEIGHT_STD_DEV]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>             <span class="p">)</span> <span class="k">then</span>
<a name="ln-262"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">sq</span>
<a name="ln-263"></a>            <span class="k">cycle</span>
<a name="ln-264"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-265"></a>
<a name="ln-266"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;[VTK_OUTPUT]&#39;</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span>                 <span class="p">)</span> <span class="k">then</span>
<a name="ln-267"></a><span class="k">            read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">s_vtk</span><span class="p">,</span> <span class="n">ms_vtk</span>
<a name="ln-268"></a>            <span class="k">read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">prof_ts</span>
<a name="ln-269"></a>            <span class="k">read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">prof_bs</span>
<a name="ln-270"></a>            <span class="k">read</span><span class="p">(</span><span class="n">iunit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">res_file</span>
<a name="ln-271"></a>            <span class="k">cycle</span>
<a name="ln-272"></a><span class="k">         </span><span class="n">endif</span>
<a name="ln-273"></a>
<a name="ln-274"></a>      <span class="n">enddo</span>
<a name="ln-275"></a>
<a name="ln-276"></a>      <span class="n">ms_vtk</span>   <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ms_vtk</span>  <span class="p">)</span>
<a name="ln-277"></a>      <span class="n">prof_ts</span>  <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span> <span class="p">)</span>
<a name="ln-278"></a>      <span class="n">prof_bs</span>  <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">prof_bs</span> <span class="p">)</span>
<a name="ln-279"></a>      <span class="n">res_file</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">res_file</span><span class="p">)</span>
<a name="ln-280"></a>
<a name="ln-281"></a>   <span class="k">return</span>
<a name="ln-282"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">read_data</span>
<a name="ln-283"></a>
<a name="ln-284"></a>
<a name="ln-285"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-286"></a>   <span class="c">!&lt; @note Subroutine to define the slider geometry</span>
<a name="ln-287"></a>   <span class="c">!  @endnote</span>
<a name="ln-288"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-289"></a>   <span class="k">subroutine </span><span class="n">modify_h_slider</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-290"></a>   <span class="k">implicit none</span>
<a name="ln-291"></a><span class="k">   type</span><span class="p">(</span><span class="n">FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fe_f</span>
<a name="ln-292"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">lx</span>
<a name="ln-293"></a>
<a name="ln-294"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-295"></a>
<a name="ln-296"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">n</span>
<a name="ln-297"></a>         <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">+</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">lx</span> <span class="o">-</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">/</span> <span class="n">lx</span>
<a name="ln-298"></a>      <span class="n">enddo</span>
<a name="ln-299"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">-</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H1_N</span><span class="p">)</span>
<a name="ln-300"></a>
<a name="ln-301"></a>   <span class="k">return</span>
<a name="ln-302"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">modify_h_slider</span>
<a name="ln-303"></a>
<a name="ln-304"></a>
<a name="ln-305"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-306"></a>   <span class="c">!&lt; @note Subroutine to define the pocket geometry</span>
<a name="ln-307"></a>   <span class="c">!  @endnote</span>
<a name="ln-308"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-309"></a>   <span class="k">subroutine </span><span class="n">modify_h_pocket</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-310"></a>   <span class="k">implicit none</span>
<a name="ln-311"></a><span class="k">   type</span><span class="p">(</span><span class="n">FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fe_f</span>
<a name="ln-312"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">lx</span>
<a name="ln-313"></a>
<a name="ln-314"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">e</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-315"></a>      <span class="kt">logical</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">groove</span>
<a name="ln-316"></a>
<a name="ln-317"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span><span class="n">H2_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span>
<a name="ln-318"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span><span class="n">H1_N</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0._R8</span>
<a name="ln-319"></a>      <span class="k">do </span><span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ne</span>
<a name="ln-320"></a>         <span class="n">groove</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-321"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-322"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">x</span><span class="p">(</span><span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">con</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">lx</span> <span class="o">/</span> <span class="mf">2._R8</span><span class="p">))</span> <span class="n">groove</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-323"></a>         <span class="n">enddo</span>
<a name="ln-324"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">groove</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-325"></a><span class="k">            </span><span class="n">fe_f</span><span class="p">%</span><span class="n">vc</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">HG_C</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_g</span>
<a name="ln-326"></a>         <span class="n">endif</span>
<a name="ln-327"></a>      <span class="n">enddo</span>
<a name="ln-328"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">-</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H1_N</span><span class="p">)</span>
<a name="ln-329"></a>
<a name="ln-330"></a>   <span class="k">return</span>
<a name="ln-331"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">modify_h_pocket</span>
<a name="ln-332"></a>
<a name="ln-333"></a>
<a name="ln-334"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-335"></a>   <span class="c">!&lt; @note Subroutine to define the slider, in a multiscale problem</span>
<a name="ln-336"></a>   <span class="c">!  @endnote</span>
<a name="ln-337"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-338"></a>   <span class="k">subroutine </span><span class="n">modify_h_slider_MS</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-339"></a>   <span class="k">implicit none</span>
<a name="ln-340"></a><span class="k">   type</span><span class="p">(</span><span class="n">MS_FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ms_fe_f</span>
<a name="ln-341"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">lx</span>
<a name="ln-342"></a>
<a name="ln-343"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">e</span>
<a name="ln-344"></a>
<a name="ln-345"></a>      <span class="k">call </span><span class="n">modify_h_slider</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-346"></a>      <span class="k">do </span><span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ne</span>
<a name="ln-347"></a>         <span class="k">call </span><span class="n">modify_h_slider</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">%</span><span class="n">bs_fe_f</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-348"></a>      <span class="n">enddo</span>
<a name="ln-349"></a>
<a name="ln-350"></a>   <span class="k">return</span>
<a name="ln-351"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">modify_h_slider_MS</span>
<a name="ln-352"></a>
<a name="ln-353"></a>
<a name="ln-354"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-355"></a>   <span class="c">!&lt; @note Subroutine to define the bearing geometry</span>
<a name="ln-356"></a>   <span class="c">!  @endnote</span>
<a name="ln-357"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-358"></a>   <span class="k">subroutine </span><span class="n">modify_h_bearing</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-359"></a>   <span class="k">implicit none</span>
<a name="ln-360"></a><span class="k">   type</span><span class="p">(</span><span class="n">FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fe_f</span>
<a name="ln-361"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">lx</span>
<a name="ln-362"></a>
<a name="ln-363"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-364"></a>
<a name="ln-365"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">n</span>
<a name="ln-366"></a>         <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">+</span> <span class="mf">0.5_R8</span> <span class="o">*</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI_R8</span> <span class="o">*</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-367"></a>      <span class="n">enddo</span>
<a name="ln-368"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">-</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H1_N</span><span class="p">)</span>
<a name="ln-369"></a>
<a name="ln-370"></a>   <span class="k">return</span>
<a name="ln-371"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">modify_h_bearing</span>
<a name="ln-372"></a>
<a name="ln-373"></a>
<a name="ln-374"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-375"></a>   <span class="c">!&lt; @note Subroutine to define the bearing geometry</span>
<a name="ln-376"></a>   <span class="c">!  @endnote</span>
<a name="ln-377"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-378"></a>   <span class="k">subroutine </span><span class="n">modify_h_bearing_y</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">ly</span><span class="p">)</span>
<a name="ln-379"></a>   <span class="k">implicit none</span>
<a name="ln-380"></a><span class="k">   type</span><span class="p">(</span><span class="n">FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fe_f</span>
<a name="ln-381"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ly</span>
<a name="ln-382"></a>
<a name="ln-383"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-384"></a>
<a name="ln-385"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">n</span>
<a name="ln-386"></a>         <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">+</span> <span class="mf">0.5_R8</span> <span class="o">*</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI_R8</span> <span class="o">*</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">ly</span><span class="p">)</span>
<a name="ln-387"></a>      <span class="n">enddo</span>
<a name="ln-388"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">-</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H1_N</span><span class="p">)</span>
<a name="ln-389"></a>
<a name="ln-390"></a>   <span class="k">return</span>
<a name="ln-391"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">modify_h_bearing_y</span>
<a name="ln-392"></a>
<a name="ln-393"></a>
<a name="ln-394"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-395"></a>   <span class="c">!&lt; @note Subroutine to apply a roughness table to a surface</span>
<a name="ln-396"></a>   <span class="c">!  @endnote</span>
<a name="ln-397"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-398"></a>   <span class="k">subroutine </span><span class="n">apply_roughness</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">tab_s</span><span class="p">)</span>
<a name="ln-399"></a>   <span class="k">implicit none</span>
<a name="ln-400"></a><span class="k">   type</span><span class="p">(</span><span class="n">FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">fe_f</span>
<a name="ln-401"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">tab_s</span>
<a name="ln-402"></a>
<a name="ln-403"></a>      <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span>
<a name="ln-404"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-405"></a>
<a name="ln-406"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">n</span>
<a name="ln-407"></a>         <span class="n">xp</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-408"></a>         <span class="n">yp</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-409"></a>         <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">xp</span> <span class="o">/</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">lx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-410"></a>         <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">yp</span> <span class="o">/</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ly</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-411"></a>         <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">-</span> <span class="n">tab_s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-412"></a>      <span class="n">enddo</span>
<a name="ln-413"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">-</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H1_N</span><span class="p">)</span>
<a name="ln-414"></a>
<a name="ln-415"></a>   <span class="k">return</span>
<a name="ln-416"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">apply_roughness</span>
<a name="ln-417"></a>
<a name="ln-418"></a>
<a name="ln-419"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-420"></a>   <span class="c">!&lt; @note Subroutine to apply a roughness table to a surface for a multiscale problem</span>
<a name="ln-421"></a>   <span class="c">!  @endnote</span>
<a name="ln-422"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-423"></a>   <span class="k">subroutine </span><span class="n">apply_roughness_MS</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span> <span class="n">tab_s</span><span class="p">)</span>
<a name="ln-424"></a>   <span class="k">implicit none</span>
<a name="ln-425"></a><span class="k">   type</span><span class="p">(</span><span class="n">MS_FE_FILM</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">ms_fe_f</span>
<a name="ln-426"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">tab_s</span>
<a name="ln-427"></a>
<a name="ln-428"></a>      <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span>
<a name="ln-429"></a>      <span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">I4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e</span>
<a name="ln-430"></a>
<a name="ln-431"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">n</span>
<a name="ln-432"></a>         <span class="n">xp</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-433"></a>         <span class="n">yp</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-434"></a>         <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">xp</span> <span class="o">/</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">lx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-435"></a>         <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">yp</span> <span class="o">/</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ly</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-436"></a>         <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">data_f</span><span class="p">%</span><span class="n">h_0</span> <span class="o">-</span> <span class="n">tab_s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-437"></a>      <span class="n">enddo</span>
<a name="ln-438"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H_N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H2_N</span><span class="p">)</span> <span class="o">-</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">vn</span><span class="p">(:,</span> <span class="n">H1_N</span><span class="p">)</span>
<a name="ln-439"></a>
<a name="ln-440"></a>      <span class="k">do </span><span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ne</span>
<a name="ln-441"></a>         <span class="k">call </span><span class="n">apply_roughness</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">%</span><span class="n">bs_fe_f</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">tab_s</span><span class="p">)</span>
<a name="ln-442"></a>      <span class="n">enddo</span>
<a name="ln-443"></a>
<a name="ln-444"></a>   <span class="k">return</span>
<a name="ln-445"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">apply_roughness_ms</span>
<a name="ln-446"></a>
<a name="ln-447"></a>
<a name="ln-448"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-449"></a>   <span class="c">!&lt; @note Subroutine to run the slider test</span>
<a name="ln-450"></a>   <span class="c">!  @endnote</span>
<a name="ln-451"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-452"></a>   <span class="k">subroutine </span><span class="n">test_slider_fe</span>
<a name="ln-453"></a>   <span class="k">implicit none</span>
<a name="ln-454"></a><span class="k">      call </span><span class="n">init_fe_prob</span>
<a name="ln-455"></a>      <span class="k">call </span><span class="n">modify_h_slider</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-456"></a>      <span class="k">call </span><span class="n">solve_fe_prob</span>
<a name="ln-457"></a>   <span class="k">return</span>
<a name="ln-458"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_slider_fe</span>
<a name="ln-459"></a>
<a name="ln-460"></a>
<a name="ln-461"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-462"></a>   <span class="c">!&lt; @note Subroutine to run the bearing test</span>
<a name="ln-463"></a>   <span class="c">!  @endnote</span>
<a name="ln-464"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-465"></a>   <span class="k">subroutine </span><span class="n">test_bearing_x_fe</span>
<a name="ln-466"></a>   <span class="k">implicit none</span>
<a name="ln-467"></a><span class="k">      call </span><span class="n">init_fe_prob</span>
<a name="ln-468"></a>      <span class="k">call </span><span class="n">modify_h_bearing</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-469"></a>      <span class="k">call </span><span class="n">solve_fe_prob</span>
<a name="ln-470"></a>   <span class="k">return</span>
<a name="ln-471"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_bearing_x_fe</span>
<a name="ln-472"></a>
<a name="ln-473"></a>
<a name="ln-474"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-475"></a>   <span class="c">!&lt; @note Subroutine to run the bearing test</span>
<a name="ln-476"></a>   <span class="c">!  @endnote</span>
<a name="ln-477"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-478"></a>   <span class="k">subroutine </span><span class="n">test_bearing_y_fe</span>
<a name="ln-479"></a>   <span class="k">implicit none</span>
<a name="ln-480"></a><span class="k">      call </span><span class="n">init_fe_prob</span>
<a name="ln-481"></a>      <span class="k">call </span><span class="n">modify_h_bearing_y</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">ly</span><span class="p">)</span>
<a name="ln-482"></a>      <span class="k">call </span><span class="n">solve_fe_prob</span>
<a name="ln-483"></a>   <span class="k">return</span>
<a name="ln-484"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_bearing_y_fe</span>
<a name="ln-485"></a>
<a name="ln-486"></a>
<a name="ln-487"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-488"></a>   <span class="c">!&lt; @note Subroutine to run the deterministic rough surface test</span>
<a name="ln-489"></a>   <span class="c">!  @endnote</span>
<a name="ln-490"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-491"></a>   <span class="k">subroutine </span><span class="n">test_rough_fe</span>
<a name="ln-492"></a>   <span class="k">implicit none</span>
<a name="ln-493"></a><span class="k">      call </span><span class="n">init_rough_prob</span>
<a name="ln-494"></a>      <span class="k">call </span><span class="n">init_fe_prob</span>
<a name="ln-495"></a>      <span class="k">call </span><span class="n">apply_roughness</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">tab_s</span><span class="p">)</span>
<a name="ln-496"></a>      <span class="k">call </span><span class="n">solve_fe_prob</span>
<a name="ln-497"></a>   <span class="k">return</span>
<a name="ln-498"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_rough_fe</span>
<a name="ln-499"></a>
<a name="ln-500"></a>
<a name="ln-501"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-502"></a>   <span class="c">!&lt; @note Subroutine to run the pocket test</span>
<a name="ln-503"></a>   <span class="c">!  @endnote</span>
<a name="ln-504"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-505"></a>   <span class="k">subroutine </span><span class="n">test_pocket_fe</span>
<a name="ln-506"></a>   <span class="k">implicit none</span>
<a name="ln-507"></a><span class="k">      call </span><span class="n">init_fe_prob</span>
<a name="ln-508"></a>      <span class="k">call </span><span class="n">modify_h_pocket</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-509"></a>      <span class="k">call </span><span class="n">solve_fe_prob</span>
<a name="ln-510"></a>   <span class="k">return</span>
<a name="ln-511"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_pocket_fe</span>
<a name="ln-512"></a>
<a name="ln-513"></a>
<a name="ln-514"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-515"></a>   <span class="c">!&lt; @note Subroutine to run the multiscale slider test</span>
<a name="ln-516"></a>   <span class="c">!  @endnote</span>
<a name="ln-517"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-518"></a>   <span class="k">subroutine </span><span class="n">test_slider_ms</span>
<a name="ln-519"></a>   <span class="k">implicit none</span>
<a name="ln-520"></a><span class="k">      call </span><span class="n">init_ms_prob</span>
<a name="ln-521"></a>      <span class="k">call </span><span class="n">modify_h_slider_MS</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span> <span class="n">lx</span><span class="p">)</span>
<a name="ln-522"></a>      <span class="k">call </span><span class="n">solve_ms_prob</span>
<a name="ln-523"></a>   <span class="k">return</span>
<a name="ln-524"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_slider_ms</span>
<a name="ln-525"></a>
<a name="ln-526"></a>
<a name="ln-527"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-528"></a>   <span class="c">!&lt; @note Subroutine to run the rough surface multiscale problem</span>
<a name="ln-529"></a>   <span class="c">!  @endnote</span>
<a name="ln-530"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-531"></a>   <span class="k">subroutine </span><span class="n">test_rough_ms</span>
<a name="ln-532"></a>   <span class="k">implicit none</span>
<a name="ln-533"></a><span class="k">      call </span><span class="n">init_rough_prob</span>
<a name="ln-534"></a>      <span class="k">call </span><span class="n">init_ms_prob</span>
<a name="ln-535"></a>      <span class="k">call </span><span class="n">apply_roughness_MS</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span> <span class="n">tab_s</span><span class="p">)</span>
<a name="ln-536"></a>      <span class="k">call </span><span class="n">solve_ms_prob</span>
<a name="ln-537"></a>   <span class="k">return</span>
<a name="ln-538"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">test_rough_ms</span>
<a name="ln-539"></a>
<a name="ln-540"></a>
<a name="ln-541"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-542"></a>   <span class="c">!&lt; @note Subroutine to initialize a deterministic &#39;smooth&#39; problem</span>
<a name="ln-543"></a>   <span class="c">!  @endnote</span>
<a name="ln-544"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-545"></a>   <span class="k">subroutine </span><span class="n">init_fe_prob</span>
<a name="ln-546"></a>   <span class="k">implicit none</span>
<a name="ln-547"></a><span class="k">      if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-548"></a><span class="k">         write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;It is better to use an odd number of nodes in the x dir to have profile for comparison with analytical sol.&#39;</span>
<a name="ln-549"></a>      <span class="n">endif</span>
<a name="ln-550"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>
<a name="ln-551"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span>
<a name="ln-552"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">lx</span> <span class="o">=</span> <span class="n">lx</span>
<a name="ln-553"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ly</span> <span class="o">=</span> <span class="n">ly</span>
<a name="ln-554"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">zx</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-555"></a>      <span class="n">fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">zy</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-556"></a>      <span class="k">call </span><span class="n">create_rect_FE_film</span><span class="p">(</span> <span class="n">data_f</span> <span class="o">=</span> <span class="n">data_f</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-557"></a>                                 <span class="n">num_p</span> <span class="o">=</span> <span class="n">num_pts</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-558"></a>                                  <span class="n">fe_f</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">)</span>
<a name="ln-559"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;film created&#39;</span>
<a name="ln-560"></a>
<a name="ln-561"></a>   <span class="k">return</span>
<a name="ln-562"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">init_fe_prob</span>
<a name="ln-563"></a>
<a name="ln-564"></a>
<a name="ln-565"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-566"></a>   <span class="c">!&lt; @note Subroutine to initialize a deterministic &#39;rough&#39; problem</span>
<a name="ln-567"></a>   <span class="c">!  @endnote</span>
<a name="ln-568"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-569"></a>   <span class="k">subroutine </span><span class="n">init_rough_prob</span>
<a name="ln-570"></a>   <span class="k">implicit none</span>
<a name="ln-571"></a><span class="k">      allocate</span><span class="p">(</span><span class="n">tab_s</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
<a name="ln-572"></a>      <span class="n">tab_s</span> <span class="o">=</span> <span class="mf">0._R8</span>
<a name="ln-573"></a>      <span class="k">call </span><span class="n">read_surf</span><span class="p">(</span><span class="n">nom_fic</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface_file</span><span class="p">),</span> <span class="n">mu</span><span class="o">=</span><span class="mf">1._R8</span><span class="p">,</span> <span class="n">sq</span><span class="o">=</span><span class="n">sq</span><span class="p">,</span> <span class="n">tab_s</span><span class="o">=</span><span class="n">tab_s</span><span class="p">,</span> <span class="n">scal</span><span class="o">=</span><span class="n">scal_tmp</span><span class="p">)</span>
<a name="ln-574"></a>   <span class="k">return</span>
<a name="ln-575"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">init_rough_prob</span>
<a name="ln-576"></a>
<a name="ln-577"></a>
<a name="ln-578"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-579"></a>   <span class="c">!&lt; @note Subroutine to initialize a multiscale &#39;smooth&#39; problem</span>
<a name="ln-580"></a>   <span class="c">!  @endnote</span>
<a name="ln-581"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-582"></a>   <span class="k">subroutine </span><span class="n">init_ms_prob</span>
<a name="ln-583"></a>   <span class="k">implicit none</span>
<a name="ln-584"></a><span class="k">      </span><span class="n">n_mic</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_mac</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-585"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">nx</span> <span class="o">=</span> <span class="n">n_mac</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-586"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ny</span> <span class="o">=</span> <span class="n">n_mac</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-587"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">lx</span> <span class="o">=</span> <span class="n">lx</span>
<a name="ln-588"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">ly</span> <span class="o">=</span> <span class="n">ly</span>
<a name="ln-589"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">zx</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-590"></a>      <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">%</span><span class="n">m</span><span class="p">%</span><span class="n">zy</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-591"></a>
<a name="ln-592"></a>      <span class="k">call </span><span class="n">multi_scale_create_rect_fe_film</span><span class="p">(</span><span class="n">data_f</span> <span class="o">=</span> <span class="n">data_f</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-593"></a>                                            <span class="n">bs_nx</span> <span class="o">=</span> <span class="n">n_mic</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-594"></a>                                            <span class="n">bs_ny</span> <span class="o">=</span> <span class="n">n_mic</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-595"></a>                                          <span class="n">num_pts</span> <span class="o">=</span> <span class="n">num_pts</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-596"></a>                                          <span class="n">num_pbs</span> <span class="o">=</span> <span class="n">num_pbs</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-597"></a>                                          <span class="n">ms_fe_f</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">)</span>
<a name="ln-598"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;film created&#39;</span>
<a name="ln-599"></a>   <span class="k">return</span>
<a name="ln-600"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">init_ms_prob</span>
<a name="ln-601"></a>
<a name="ln-602"></a>
<a name="ln-603"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-604"></a>   <span class="c">!&lt; @note Subroutine to solve a deterministic &#39;smooth&#39; problem</span>
<a name="ln-605"></a>   <span class="c">!  @endnote</span>
<a name="ln-606"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-607"></a>   <span class="k">subroutine </span><span class="n">solve_fe_prob</span>
<a name="ln-608"></a>   <span class="k">implicit none</span>
<a name="ln-609"></a>
<a name="ln-610"></a><span class="k">      call </span><span class="nb">system_clock</span><span class="p">(</span><span class="nb">count</span><span class="o">=</span><span class="n">cinit</span><span class="p">)</span>
<a name="ln-611"></a>      <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<a name="ln-612"></a>         <span class="k">call </span><span class="n">solve_FE_film</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<a name="ln-613"></a>         <span class="k">call </span><span class="n">compute_corner_fluxes</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">bf</span><span class="p">)</span>
<a name="ln-614"></a>      <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<a name="ln-615"></a>      <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="nb">count</span><span class="o">=</span><span class="n">cend</span><span class="p">,</span><span class="n">count_rate</span><span class="o">=</span><span class="n">cr</span><span class="p">)</span>
<a name="ln-616"></a>
<a name="ln-617"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;FE cpu time (s):&#39;</span><span class="p">,</span>          <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>
<a name="ln-618"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;FE_cpu_time_(s):&#39;</span><span class="p">,</span>          <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>
<a name="ln-619"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;FE real comp time (s):&#39;</span><span class="p">,</span>    <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="kt">real</span><span class="p">(</span><span class="n">cend</span> <span class="o">-</span> <span class="n">cinit</span><span class="p">)</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>
<a name="ln-620"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;FE_real_comp_time_(s):&#39;</span><span class="p">,</span>    <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="kt">real</span><span class="p">(</span><span class="n">cend</span> <span class="o">-</span> <span class="n">cinit</span><span class="p">)</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>
<a name="ln-621"></a>
<a name="ln-622"></a>      <span class="n">save_PeK</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-623"></a>      <span class="n">save_PeE</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-624"></a>
<a name="ln-625"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">s_vtk</span> <span class="o">/=</span> <span class="n">NO_VTK</span><span class="p">)</span> <span class="k">call </span><span class="n">save_fe_f_vtk</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">ms_vtk</span><span class="p">))</span>
<a name="ln-626"></a>
<a name="ln-627"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">test_num</span><span class="p">)</span>
<a name="ln-628"></a>         <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-629"></a>            <span class="k">call </span><span class="n">save_profile_x_comp_slider</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">),</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-630"></a>            <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;python3 bin/pyt/filetoplot.py &quot;</span><span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">)</span> <span class="o">//</span><span class="s2">&quot; &#39;$x/L$&#39; &#39;$ph^2/6 \mu V L$&#39; &quot;</span><span class="p">)</span>
<a name="ln-631"></a>
<a name="ln-632"></a>         <span class="k">case</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-633"></a>            <span class="k">call </span><span class="n">save_profile_y_comp_air_pocket</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">),</span> <span class="n">ly</span><span class="p">,</span> <span class="n">lx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<a name="ln-634"></a>            <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;python3 bin/pyt/filetoplot.py &quot;</span><span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">)</span> <span class="o">//</span><span class="s2">&quot; &#39;$x/L$&#39; &#39;$ph^2/6 \mu V L$&#39; &quot;</span><span class="p">)</span>
<a name="ln-635"></a>
<a name="ln-636"></a>            <span class="k">call </span><span class="n">save_profile_x_comp_air_pocket</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<a name="ln-637"></a>            <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;python3 bin/pyt/filetoplot.py &quot;</span><span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;2&#39;</span> <span class="o">//</span><span class="s2">&quot; &#39;$x/L$&#39; &#39;$ph^2/6 \mu V L$&#39; &quot;</span><span class="p">)</span>
<a name="ln-638"></a>
<a name="ln-639"></a>         <span class="k">case </span><span class="n">default</span>
<a name="ln-640"></a>            <span class="k">call </span><span class="n">save_profile_x_fe</span><span class="p">(</span><span class="n">fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">),</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-641"></a>
<a name="ln-642"></a>      <span class="n">endselect</span>
<a name="ln-643"></a>
<a name="ln-644"></a>      <span class="k">call </span><span class="n">save_fe_field</span><span class="p">(</span><span class="n">fe_f</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">,</span>                                   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-645"></a>                    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="s2">&quot;pressure.sur&quot;</span><span class="p">,</span>   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-646"></a>                         <span class="n">code</span> <span class="o">=</span> <span class="n">P_N</span><span class="p">,</span>                                    <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-647"></a>                        <span class="n">nodal</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-648"></a>
<a name="ln-649"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">save_PeK</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-650"></a>      <span class="k">call </span><span class="n">save_fe_field</span><span class="p">(</span><span class="n">fe_f</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">,</span>                                   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-651"></a>                    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="s2">&quot;PeK.sur&quot;</span><span class="p">,</span>        <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-652"></a>                         <span class="n">code</span> <span class="o">=</span> <span class="n">PEK_C</span><span class="p">,</span>                                  <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-653"></a>                        <span class="n">nodal</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-654"></a>
<a name="ln-655"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">save_PeE</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-656"></a>      <span class="k">call </span><span class="n">save_fe_field</span><span class="p">(</span><span class="n">fe_f</span> <span class="o">=</span> <span class="n">fe_f</span><span class="p">,</span>                                   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-657"></a>                    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="s2">&quot;PeE.sur&quot;</span><span class="p">,</span>        <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-658"></a>                         <span class="n">code</span> <span class="o">=</span> <span class="n">PEE_C</span><span class="p">,</span>                                  <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-659"></a>                        <span class="n">nodal</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-660"></a>
<a name="ln-661"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;load FE (N):&#39;</span><span class="p">,</span>  <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">fz</span><span class="p">()</span>
<a name="ln-662"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;load_FE_(N):&#39;</span><span class="p">,</span>  <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">fz</span><span class="p">()</span>
<a name="ln-663"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;fric/x FE (N)&#39;</span><span class="p">,</span> <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">fx</span><span class="p">()</span>
<a name="ln-664"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fric/x_FE_(N)&#39;</span><span class="p">,</span> <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">fx</span><span class="p">()</span>
<a name="ln-665"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;fric/y FE (N)&#39;</span><span class="p">,</span> <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">fy</span><span class="p">()</span>
<a name="ln-666"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fric/y_FE_(N)&#39;</span><span class="p">,</span> <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">fe_f</span><span class="p">%</span><span class="n">fy</span><span class="p">()</span>
<a name="ln-667"></a>   <span class="k">return</span>
<a name="ln-668"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">solve_fe_prob</span>
<a name="ln-669"></a>
<a name="ln-670"></a>
<a name="ln-671"></a>   <span class="c">!=========================================================================================</span>
<a name="ln-672"></a>   <span class="c">!&lt; @note Subroutine to solve a &#39;smooth&#39; multiscale problem</span>
<a name="ln-673"></a>   <span class="c">!  @endnote</span>
<a name="ln-674"></a>   <span class="c">!-----------------------------------------------------------------------------------------</span>
<a name="ln-675"></a>   <span class="k">subroutine </span><span class="n">solve_ms_prob</span>
<a name="ln-676"></a>   <span class="k">implicit none</span>
<a name="ln-677"></a><span class="k">      </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">R8</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tab</span>
<a name="ln-678"></a>
<a name="ln-679"></a>      <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="nb">count</span><span class="o">=</span><span class="n">cinit</span><span class="p">)</span>
<a name="ln-680"></a>      <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<a name="ln-681"></a>         <span class="k">call </span><span class="n">multi_scale_solve_fe_film</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span> <span class="n">ms_mat</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<a name="ln-682"></a>      <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<a name="ln-683"></a>      <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="nb">count</span><span class="o">=</span><span class="n">cend</span><span class="p">,</span><span class="n">count_rate</span><span class="o">=</span><span class="n">cr</span><span class="p">)</span>
<a name="ln-684"></a>
<a name="ln-685"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;MS cpu time (s):&#39;</span><span class="p">,</span>          <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>
<a name="ln-686"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;MS_cpu_time_(s):&#39;</span><span class="p">,</span>          <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>
<a name="ln-687"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;MS real comp time (s):&#39;</span><span class="p">,</span>    <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="kt">real</span><span class="p">(</span><span class="n">cend</span> <span class="o">-</span> <span class="n">cinit</span><span class="p">)</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>
<a name="ln-688"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;MS_real_comp_time_(s):&#39;</span><span class="p">,</span>    <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="kt">real</span><span class="p">(</span><span class="n">cend</span> <span class="o">-</span> <span class="n">cinit</span><span class="p">)</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>
<a name="ln-689"></a>
<a name="ln-690"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;load MS_FE (N):&#39;</span><span class="p">,</span>           <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ms_fz</span><span class="p">()</span>
<a name="ln-691"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;load_MS_FE_(N):&#39;</span><span class="p">,</span>           <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ms_fz</span><span class="p">()</span>
<a name="ln-692"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;fric/x MS FE (N):&#39;</span><span class="p">,</span>         <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ms_fx</span><span class="p">()</span>
<a name="ln-693"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fric/x_MS_FE_(N):&#39;</span><span class="p">,</span>         <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ms_fx</span><span class="p">()</span>
<a name="ln-694"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OPU</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>          <span class="s1">&#39;fric/y MS FE (N):&#39;</span><span class="p">,</span>         <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ms_fy</span><span class="p">()</span>
<a name="ln-695"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit_num_res</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fric/y_MS_FE_(N):&#39;</span><span class="p">,</span>         <span class="nb">char</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ms_fy</span><span class="p">()</span>
<a name="ln-696"></a>
<a name="ln-697"></a>      <span class="k">call </span><span class="n">save_ms_fe_f_vtk</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">ms_vtk</span><span class="p">))</span>
<a name="ln-698"></a>
<a name="ln-699"></a>      <span class="k">call </span><span class="n">save_profile_x_fe</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">%</span><span class="n">ts_fe_f</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">prof_ts</span><span class="p">),</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-700"></a>      <span class="k">call </span><span class="n">save_profile_x_ms</span><span class="p">(</span><span class="n">ms_fe_f</span><span class="p">,</span>         <span class="nb">trim</span><span class="p">(</span><span class="n">prof_bs</span><span class="p">),</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-701"></a>
<a name="ln-702"></a>      <span class="k">call </span><span class="n">save_ms_field</span><span class="p">(</span><span class="n">ms_fe_f</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">,</span>                                   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-703"></a>                       <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="s2">&quot;ms_pressure.sur&quot;</span><span class="p">,</span>   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-704"></a>                            <span class="n">code</span> <span class="o">=</span> <span class="n">P_N</span><span class="p">,</span>                                       <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-705"></a>                           <span class="n">nodal</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>                                     <span class="p">)</span>
<a name="ln-706"></a>
<a name="ln-707"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">compare_solution_file</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-708"></a><span class="k">         if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">tab_sol</span><span class="p">)</span> <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">tab_sol</span><span class="p">)</span>
<a name="ln-709"></a>         <span class="k">call </span><span class="n">read_surf</span><span class="p">(</span><span class="n">nom_fic</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">pressure_solution_file</span><span class="p">),</span>   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-710"></a>                             <span class="n">mu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span><span class="p">,</span>                         <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-711"></a>                             <span class="n">sq</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span><span class="p">,</span>                         <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-712"></a>                          <span class="n">tab_s</span> <span class="o">=</span> <span class="n">tab_sol</span><span class="p">,</span>                        <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-713"></a>                           <span class="n">scal</span> <span class="o">=</span> <span class="n">scal_tmp</span><span class="p">)</span>
<a name="ln-714"></a>
<a name="ln-715"></a>         <span class="k">if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">tab_s</span><span class="p">)</span> <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">tab_s</span><span class="p">)</span>
<a name="ln-716"></a>         <span class="k">call </span><span class="n">ms_fe_f_2_mat</span><span class="p">(</span><span class="n">ms_fe_f</span> <span class="o">=</span> <span class="n">ms_fe_f</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-717"></a>                               <span class="n">code</span> <span class="o">=</span> <span class="n">P_N</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-718"></a>                              <span class="n">nodal</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span>   <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-719"></a>                                <span class="n">mat</span> <span class="o">=</span> <span class="n">tab_s</span><span class="p">)</span>
<a name="ln-720"></a>
<a name="ln-721"></a>         <span class="k">allocate</span><span class="p">(</span> <span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ny</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-722"></a>         <span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ny</span><span class="p">)</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tab_s</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ny</span><span class="p">)</span> <span class="o">-</span><span class="n">tab_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ny</span><span class="p">))</span>
<a name="ln-723"></a>
<a name="ln-724"></a>         <span class="n">scal_tmp</span><span class="p">%</span><span class="n">zlength_unit</span> <span class="o">=</span> <span class="s1">&#39;Pa&#39;</span>
<a name="ln-725"></a>         <span class="n">scal_tmp</span><span class="p">%</span><span class="n">dz_unit</span>      <span class="o">=</span> <span class="s1">&#39;Pa&#39;</span>
<a name="ln-726"></a>         <span class="k">call </span><span class="n">write_surf</span><span class="p">(</span><span class="n">nom_fic</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="s2">&quot;compare_pressure.sur&quot;</span><span class="p">,</span>    <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-727"></a>                           <span class="n">tab_s</span> <span class="o">=</span> <span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ny</span><span class="p">),</span>                                 <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-728"></a>                            <span class="n">scal</span> <span class="o">=</span> <span class="n">scal_tmp</span><span class="p">)</span>
<a name="ln-729"></a>
<a name="ln-730"></a>         <span class="k">where</span> <span class="p">(</span><span class="n">tab_s</span> <span class="o">&lt;</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">tab_sol</span> <span class="o">&gt;</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span><span class="p">)</span>
<a name="ln-731"></a>            <span class="n">tab</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R8</span>
<a name="ln-732"></a>         <span class="n">elsewhere</span> <span class="p">(</span><span class="n">tab_s</span> <span class="o">&gt;</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">tab_sol</span> <span class="o">&lt;</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span><span class="p">)</span>
<a name="ln-733"></a>            <span class="n">tab</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1._R8</span>
<a name="ln-734"></a>         <span class="n">elsewhere</span> <span class="p">(</span><span class="n">tab_s</span> <span class="o">&lt;</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">tab_sol</span> <span class="o">&lt;</span> <span class="n">data_f</span><span class="p">%</span><span class="n">fl</span><span class="p">%</span><span class="n">p_0</span><span class="p">)</span>
<a name="ln-735"></a>            <span class="n">tab</span> <span class="o">=</span>  <span class="mf">0._R8</span>
<a name="ln-736"></a>         <span class="n">elsewhere</span>
<a name="ln-737"></a>            <span class="n">tab</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2._R8</span>
<a name="ln-738"></a>         <span class="n">endwhere</span>
<a name="ln-739"></a>
<a name="ln-740"></a>         <span class="n">scal_tmp</span><span class="p">%</span><span class="n">zlength_unit</span> <span class="o">=</span> <span class="s1">&#39;  &#39;</span>
<a name="ln-741"></a>         <span class="n">scal_tmp</span><span class="p">%</span><span class="n">dz_unit</span>      <span class="o">=</span> <span class="s1">&#39;  &#39;</span>
<a name="ln-742"></a>         <span class="k">call </span><span class="n">write_surf</span><span class="p">(</span><span class="n">nom_fic</span> <span class="o">=</span> <span class="s2">&quot;out/&quot;</span><span class="o">//</span><span class="n">res_dir</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="s2">&quot;compare_cavitation.sur&quot;</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-743"></a>                           <span class="n">tab_s</span> <span class="o">=</span> <span class="n">tab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ny</span><span class="p">),</span>                                 <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-744"></a>                            <span class="n">scal</span> <span class="o">=</span> <span class="n">scal_tmp</span><span class="p">)</span>
<a name="ln-745"></a>
<a name="ln-746"></a>      <span class="n">endif</span>
<a name="ln-747"></a>
<a name="ln-748"></a>      <span class="k">if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">tab</span>    <span class="p">)</span> <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">tab</span>    <span class="p">)</span>
<a name="ln-749"></a>      <span class="k">if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">tab_s</span>  <span class="p">)</span> <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">tab_s</span>  <span class="p">)</span>
<a name="ln-750"></a>      <span class="k">if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">tab_sol</span><span class="p">)</span> <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">tab_sol</span><span class="p">)</span>
<a name="ln-751"></a>   <span class="k">return</span>
<a name="ln-752"></a><span class="k">   </span><span class="n">endsubroutine</span> <span class="n">solve_ms_prob</span>
<a name="ln-753"></a>
<a name="ln-754"></a><span class="n">endmodule</span> <span class="n">test_musst</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-04-16 16:00  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> MUSST was developed by Noël Brunetière - Arthur Francisco</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>